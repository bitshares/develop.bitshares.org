(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1959:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(4),l=n(5),c=n.n(l),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};var u=i.a.createRef();function d(e){var t=e.onChange,n=e.value,a=e.placeholder,r=e.maxLength,o=e.style,l=e.className,c=e.name,d=e.autoComplete,m=e.onClear,h=e.type,f=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["onChange","value","placeholder","maxLength","style","className","name","autoComplete","onClear","type"]);return void 0==m&&(m=function(){t({target:{value:""}}),u.current.focus()}),i.a.createElement(s.Input,p({ref:u,autoComplete:d,style:o,type:h,className:l+" search-input",placeholder:a,maxLength:r,name:c,value:n,onChange:t,addonAfter:i.a.createElement(s.Icon,{type:"search"}),suffix:m?i.a.createElement(s.Icon,{onClick:m,type:"close",className:n?"cursor-pointer":"hide"}):i.a.createElement("span",null)},f))}d.propTypes={onChange:o.a.func.isRequired,value:o.a.string,placeholder:o.a.string,style:o.a.object,className:o.a.string,type:o.a.string,name:o.a.string,autoComplete:o.a.string,maxLength:o.a.number,onClear:o.a.func},d.defaultProps={placeholder:c.a.translate("exchange.filter"),style:{width:"200px"},className:"",type:"text",name:"focus",autoComplete:"off",maxLength:16,onClear:void 0}},1966:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(5),o=n.n(r),s=n(4),l=(n(1980),function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}());var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pageSize:e.pageSize},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.a.Component),l(t,[{key:"render",value:function(){var e=this,t=this.state.pageSize,n=this.props,a=n.header,r=n.rows,l=n.extraRow,c=n.loading,p=[10,20,30,40,50,100].filter(function(e){return e<r.length});return p.push(r.length),i.a.createElement("div",{className:"paginated-list",style:this.props.style},i.a.createElement(s.Table,{loading:c,dataSource:r,uns:!0,columns:Array.isArray(a)?a:[],footer:function(){return l||i.a.createElement("span",null," ")},onChange:this.props.toggleSortOrder,pagination:{showSizeChanger:!0,hideOnSinglePage:!1,defaultPageSize:t,pageSizeOptions:p,showTotal:function(t,n){return o.a.translate(e.props.label,{count:t})}},rowClassName:null==this.props.rowClassName?void 0:function(t,n){return e.props.rowClassName(t,n)},rowSelection:this.props.rowSelection}),this.props.children)}}]),t}();c.defaultProps={rows:[],pageSize:20,label:"utility.total_x_items",className:"table",extraRow:null,style:{paddingBottom:"1rem"},loading:!1},t.a=c},1975:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return h});var a=n(0),i=n.n(a),r=n(42),o=n(574),s=n.n(o),l=n(45),c=n(29),p=n(23),u=n(39),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var m=function(e){return!!e&&!!e.get("id")},h=function(e){var t,n,a=(n=t=function(t){function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i.a.Component),d(n,[{key:"render",value:function(){return m(this.props.currentAccount)?i.a.createElement(e,this.props):i.a.createElement(u.a,null)}}]),n}(),t.propTypes={currentAccount:r.a.ChainAccount},t.defaultProps={autosubscribe:!0},n);return a=Object(l.a)(a),a=s()(a,100,{leading:!1}),Object(c.a)(a,{listenTo:function(){return[p.a]},getProps:function(){var e=p.a.getState().currentAccount||p.a.getState().passwordAccount||"please-login";return{currentAccount:new Map([["name",e]])}}})}},1980:function(e,t,n){},2111:function(e,t,n){},2252:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(575),o=n(188),s=(n(111),n(107)),l=n(458),c=n(92),p=n(5),u=n.n(p),d=n(1),m=n.n(d),h=n(174),f=n(120),b=n(4),y=n(6),g=n(1966),_=n(42),v=n(574),k=n.n(v),w=n(33),O=n(15),E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(2111);var P=["1.2.1634961"],A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onRowAction=function(e){return{onClick:n.onMarketAction.bind(n,e)}},n.state={ticker:{}},n.tickersLoaded={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),C(t,[{key:"onMarketAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yes";this.props.onMarketAction({market:e,action:t})}},{key:"getHeader",value:function(){var e=this;return[{title:"#",dataIndex:"asset_id",align:"left",defaultSortOrder:"ascend",sorter:function(e,t){return e.symbol>t.symbol?1:e.symbol<t.symbol?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement(h.a,{asset:e}))}},{title:u.a.translate("prediction.overview.issuer"),dataIndex:"issuer",align:"left",sorter:function(e,t){var n=y.ChainStore.getAccount(e.issuer),a=y.ChainStore.getAccount(t.issuer),i=null,r=null;return n&&a&&(i=n.get("name"),r=a.get("name")),i>r?1:i<r?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement(f.a,{account:e}))}},{title:u.a.translate("prediction.overview.prediction"),dataIndex:"condition",align:"left",sorter:function(e,t){return e.condition&&""!==e.condition?t.condition&&""!==t.condition?e.condition.localeCompare(t.condition):1:-1},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"normal"}},i.a.createElement("span",null,e))}},{title:u.a.translate("prediction.overview.market_confidence"),dataIndex:"marketConfidence",align:"left",sorter:function(e,t){return e.marketConfidence>t.marketConfidence?1:e.marketConfidence<t.marketConfidence?-1:0},render:function(t,n){var a=Object.assign({},e.state.ticker[n.asset_id]);return a?(a.quote_volume&&"0"!==a.quote_volume&&"1"!==a.quote_volume&&"NaN"!==a.quote_volume&&"-NaN"!==a.quote_volume?a.quote_volume=O.a.convert_typed_to_satoshi(parseFloat(a.quote_volume),y.ChainStore.getAsset(n.asset[1].bitasset_data.options.short_backing_asset)):a.quote_volume=0,a.percent_change&&"NaN"!==a.percent_change&&"-NaN"!==a.percent_change?"0"==a.percent_change?a.percent_change="0%":a.percent_change=(parseFloat(a.latest)>0?"+":"-")+a.percent_change+"%":a.percent_change="-",i.a.createElement("span",null,u.a.translate("exchange.vol_short")," ",i.a.createElement(w.a,{amount:a.quote_volume,asset:n.asset[1].bitasset_data.options.short_backing_asset})," ")):null}},{title:u.a.translate("prediction.overview.market_predicated_likelihood"),dataIndex:"marketLikelihood",align:"left",sorter:function(e,t){return e.marketLikelihood>t.marketLikelihood?1:e.marketLikelihood<t.marketLikelihood?-1:0},render:function(t,n){var a=Object.assign({},e.state.ticker[n.asset_id]);return a?(a.latest&&"0"!==a.latest&&"1"!==a.latest&&"NaN"!==a.latest&&"-NaN"!==a.latest?a.latest=(100*parseFloat(a.latest)).toPrecision(3)+"%":a.latest="-",a.highest_bid&&"0"!==a.highest_bid&&"1"!==a.highest_bid&&"NaN"!==a.highest_bid&&"-NaN"!==a.highest_bid?a.highest_bid=(100*parseFloat(a.highest_bid)).toPrecision(3)+"%":a.highest_bid="-",a.lowest_ask&&"0"!==a.lowest_ask&&"1"!==a.lowest_ask&&"NaN"!==a.lowest_ask&&"-NaN"!==a.lowest_ask?a.lowest_ask=(100*parseFloat(a.lowest_ask)).toPrecision(3)+"%":a.lowest_ask="-","-"!==a.latest?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,a.latest," "),i.a.createElement("span",{className:"supsub"},i.a.createElement("sup",{className:"superscript"},a.highest_bid),i.a.createElement("sub",{className:"subscript"},a.lowest_ask)),"   "):"-"):null}},{title:u.a.translate("prediction.overview.description"),dataIndex:"description",align:"left",sorter:function(e,t){return e.description&&""!==e.description?t.description&&""!==t.description?e.description.localeCompare(t.description):1:-1},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"normal"}},i.a.createElement("span",null,e))}},{title:u.a.translate("prediction.overview.expiry"),dataIndex:"expiry",align:"left",sorter:function(e,t){return e.expiry&&""!==e.expiry?t.expiry&&""!==t.expiry?e.expiry.localeCompare(t.expiry):1:-1},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"normal"}},i.a.createElement("span",null,e))}},{title:u.a.translate("prediction.overview.action"),align:"center",render:function(t){return i.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},function(t){return e.props.currentAccount.get("id")===t}(t.issuer)?i.a.createElement(b.Button,{style:{width:"170px"},className:"align-middle",onClick:function(){return e.onMarketAction(t,"resolve")}},u.a.translate("prediction.overview.resolve")):i.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},i.a.createElement(b.Button,{style:{marginRight:"5px"},className:"align-middle",onClick:function(){return e.onMarketAction(t,"yes")}},"Details")))}}]}},{key:"_decideRowClassName",value:function(e,t){return this.props.selectedPredictionMarket?"selected-row":""}},{key:"componentDidUpdate",value:function(e){var t=this;e.predictionMarkets.length!==this.props.predictionMarkets.length&&this.props.predictionMarkets.forEach(function(e){e.asset[1].id in Object.keys(t.tickersLoaded)||(t.tickersLoaded[e.asset[1].id]={},c.a.getTicker(e.asset[1].bitasset_data.options.short_backing_asset,e.asset[1].id).then(function(n){var a=Object.assign(t.tickersLoaded,t.state.ticker);a[e.asset[1].id]=n,t.tickersLoaded[e.asset[1].id]=n,t.setState({ticker:a})}))})}},{key:"render",value:function(){var e=this,t=this.getHeader(),n=[];if(this.props.selectedPredictionMarket)n=[this.props.selectedPredictionMarket];else if(this.props.predictionMarkets){n=this.props.predictionMarkets,this.props.hideUnknownHouses&&(n=n.filter(function(e){return P.includes(e.issuer)}));var a=0;n=(n=n.filter(function(t){return-1!==((y.ChainStore.getAccount(t.issuer)?y.ChainStore.getAccount(t.issuer).get("name"):null)+"\0"+t.condition+"\0"+t.description).toUpperCase().indexOf(e.props.searchTerm)})).map(function(e){return E({},e,{key:""+e.asset_id+a++})})}var r={type:this.props.selectedPredictionMarket?void 0:"radio",hideDefaultSelections:!0,onChange:function(t,n){n.length>0?e.onMarketAction(n[0],null):e.onMarketAction(null,null)},selectedRowKeys:this.props.selectedPredictionMarket?[this.props.selectedPredictionMarket.key]:[]};return i.a.createElement(g.a,{rowSelection:r,rows:n,header:t,pageSize:10,rowClassName:this._decideRowClassName.bind(this)})}}]),t}();A.propTypes={predictionMarkets:m.a.array.isRequired,onMarketAction:m.a.func.isRequired,currentAccount:_.a.ChainAccount.isRequired,searchTerm:m.a.string,selectedPredictionMarket:m.a.object,hideUnknownHouses:m.a.bool},A.defaultProps={predictionMarkets:[]};var M=A=k()(A,150,{leading:!1}),S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},x=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var N=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),x(t,[{key:"getHeader",value:function(){var e=this,t=(Math.pow(10,y.ChainStore.getAsset(this.props.predictionMarketData.predictionMarket.asset_id).get("precision")),this.props.currentAccount.get("id"));return[{title:"#",dataIndex:"order_id",align:"left",sorter_inactive:function(e,t){return e.order_id>t.order_id?1:e.order_id<t.order_id?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement("span",null,e))}},{title:u.a.translate("prediction.details.predictor"),dataIndex:"opinionator",align:"left",sorter_inactive:function(e,t){var n=y.ChainStore.getAccount(e.opinionator).get("name"),a=y.ChainStore.getAccount(t.opinionator).get("name");return n>a?1:n<a?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement(f.a,{account:e}))}},{title:u.a.translate("prediction.details.prediction"),dataIndex:"opinion",align:"left",sorter_inactive:function(e,t){return e.opinion>t.opinion?1:e.opinion<t.opinion?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement("span",null,u.a.translate("prediction.details."+("yes"==e?"proves_true":"incorrect"))))}},{title:u.a.translate("prediction.details.predicated_likelihood"),dataIndex:"likelihood",align:"left",sortOrder:"yes"==this.props.opinionFilter?"descend":"ascend",sorter:function(e,t){return e.likelihood>t.likelihood?1:e.likelihood<t.likelihood?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement("span",null,(100*e).toPrecision(3),"%"))}},{title:u.a.translate("prediction.details.premium"),dataIndex:"premium",align:"left",sorter_inactive:function(e,t){return e.amount>t.amount?1:e.amount<t.amount?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement(w.a,{amount:e.amount,asset:e.asset_id}))}},{title:u.a.translate("prediction.details.commission"),dataIndex:"commission",align:"left",sorter_inactive:function(e,t){return e.fee>t.fee?1:e.fee<t.fee?-1:0},render:function(e,t){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement(w.a,{amount:e.amount,asset:e.asset_id})," (",(t.commission.amount/t.premium.amount*100).toPrecision(3),"%)")}},{title:u.a.translate("prediction.details.potential_profit"),dataIndex:"potentialProfit",align:"left",sorter_inactive:function(e,t){return e.amount>t.amount?1:e.amount<t.amount?-1:0},render:function(e){return i.a.createElement("div",{style:{whiteSpace:"nowrap"}},i.a.createElement(w.a,{amount:e.amount,asset:e.asset_id}))}},{title:u.a.translate("prediction.overview.action"),align:"left",render:function(n){return i.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"right"}},t&&n.opinionator===t?i.a.createElement(b.Button,{onClick:function(){e.props.onCancel(n)}},u.a.translate("prediction.details.cancel")):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,i.a.createElement(b.Tooltip,{title:u.a.translate("yes"==n.opinion?"prediction.tooltips.oppose_proves_true":"prediction.tooltips.oppose_is_incorrect")},i.a.createElement(b.Icon,{style:{fontSize:"1.3rem",marginRight:"0.5rem"},type:"question-circle",theme:"filled"})),i.a.createElement(b.Button,{onClick:function(){e.props.onOppose(n)}},u.a.translate("prediction.details.oppose")))))}}]}},{key:"render",value:function(){var e=this,t=this.getHeader(),n=this.props.predictionMarketData.opinions.filter(function(t){var n=y.ChainStore.getAccount(t.opinionator)?y.ChainStore.getAccount(t.opinionator).get("name"):null;if(e.props.detailsSearchTerm&&-1!==!(n+"\0"+t.opinion).toUpperCase().indexOf(e.props.detailsSearchTerm))return!1;if(e.props.opinionFilter){if("all"==e.props.opinionFilter)return!0;if(e.props.opinionFilter!=t.opinion)return!1}return!0}),a=0;return n=n.map(function(e){return S({},e,{key:""+e.order_id+a++})}),i.a.createElement(g.a,{rows:n,header:t,pageSize:10})}}]),t}(),I=N;N.propTypes={predictionMarketData:m.a.any.isRequired,onOppose:m.a.func.isRequired,onCancel:m.a.func.isRequired,currentAccount:_.a.ChainAccount.isRequired,detailsSearchTerm:m.a.string,opinionFilter:m.a.string},N.defaultProps={predictionMarketData:{}};var R=n(1959),j=n(573),T=n(2),F=n.n(T),L=n(360),q=n(38),D=n(540),H=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var B=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={newOpinionParameters:{opinionator:null,opinion:n.props.preselectedOpinion,amount:n.props.preselectedAmount/Math.pow(10,n.props.baseAsset.get("precision"))||" ",probability:n.props.preselectedProbability||null,fee:null},showWarning:!1,inProgress:!1,selectedOpinion:n.props.preselectedOpinion,selectedAsset:null,wrongPropability:!1},n.handleOpinionChange=n.handleOpinionChange.bind(n),n.handleAmountChange=n.handleAmountChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.handleProbabilityChange=n.handleProbabilityChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b["Modal"]),H(t,[{key:"_createOrder",value:function(){var e=this;this.setState({inProgress:!0});var t="yes"===this.state.newOpinionParameters.opinion?"buy":"shortAndSell",n=this.props.baseAsset.get("id"),a=this.props.predictionMarket.options.description,i=JSON.parse(a),r=new Date;r.setFullYear(r.getFullYear()+1);var o=i.expiry?new Date(i.expiry):r,s={for_sale:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))*this.state.newOpinionParameters.probability}),to_receive:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))})};s.price=new q.i({base:s.for_sale,quote:s.to_receive});var l={for_sale:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))}),to_receive:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))*this.state.newOpinionParameters.probability})};l.price=new q.i({base:l.for_sale,quote:l.to_receive});var p="buy"===t?l:s;new q.h({for_sale:p.for_sale,expiration:o,to_receive:p.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:n,amount:0}});if("buy"===t){var d=new q.h({for_sale:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:O.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.baseAsset)}),expiration:null,to_receive:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:O.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.quoteAsset)/parseFloat(this.state.newOpinionParameters.probability)}),seller:this.props.currentAccount.get("id"),fee:{asset_id:n,amount:0}});return c.a.createLimitOrder2(d).then(function(t){e.setState({inProgress:!1}),t.error&&"wallet locked"!==t.error.message&&b.Notification.error({message:u.a.translate("notifications.exchange_unknown_error_place_order",{amount:p.to_receive.getAmount({real:!0}),symbol:p.to_receive.asset_id})})}).catch(function(e){console.error("order failed:",e)})}if("shortAndSell"===t){var m=new q.h({for_sale:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:O.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.quoteAsset)}),expiration:null,to_receive:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:O.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.baseAsset)*parseFloat(this.state.newOpinionParameters.probability)}),seller:this.props.currentAccount.get("id"),fee:{asset_id:n,amount:0}}),h=new q.a({amount:m.amount_for_sale.getAmount(),asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision")});c.a.createPredictionShort(m,h).then(function(t){e.setState({inProgress:!1}),t.error&&"wallet locked"!==t.error.message&&b.Notification.error({message:u.a.translate("notifications.exchange_unknown_error_place_order",{amount:buyAssetAmount,symbol:buyAsset.symbol})})})}}},{key:"handleOpinionChange",value:function(){var e=this.state.newOpinionParameters;e.opinion="no"===e.opinion?"yes":"no",e.opinionator=this.props.currentAccount.get("id"),this.setState({newOpinionParameters:e,selectedOpinion:e.opinion})}},{key:"handleAmountChange",value:function(e){var t=e.amount,n=e.asset,a=this.state.newOpinionParameters;a.amount=t,a.opinionator=this.props.currentAccount.get("id"),this.setState({newOpinionParameter:a}),"string"==typeof n&&this.setState({selectedAsset:n})}},{key:"handleProbabilityChange",value:function(e){var t=this.state.newOpinionParameters;t.probability=e.target.value,this.setState({newOpinionParameter:t,wrongProbability:!this._isProbabilityValid(t)})}},{key:"_isProbabilityValid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==e&&(e=this.state.newOpinionParameters),!(!e.probability||e.probability<=.01||e.probability>=.99)}},{key:"_isFormValid",value:function(){return this._isProbabilityValid()&&parseFloat(this.state.newOpinionParameters.amount)>0}},{key:"_getPotentialWinnings",value:function(){return this.state.newOpinionParameters.probability&&this.state.newOpinionParameters.amount?"yes"===this.state.newOpinionParameters.opinion?O.a.format_number(this.state.newOpinionParameters.amount/parseFloat(this.state.newOpinionParameters.probability),this.props.baseAsset.get("precision"),!1):O.a.format_number(this.state.newOpinionParameters.amount*(1+(this.state.newOpinionParameters.probability?parseFloat(this.state.newOpinionParameters.probability):0)),this.props.baseAsset.get("precision"),!1):0}},{key:"onSubmit",value:function(){this._isFormValid()?this._createOrder.call(this):this.setState({showWarning:!0})}},{key:"render",value:function(){var e=this.state,t=e.showWarning,n=e.newOpinionParameters,a=e.wrongProbability,r=[i.a.createElement(b.Button,{type:"primary",key:"submit",onClick:this.onSubmit,disabled:this.state.inProgress},u.a.translate("global.confirm")),i.a.createElement(b.Button,{key:"cancel",onClick:this.props.onClose,disabled:this.state.inProgress},u.a.translate("global.cancel"))];return console.log("asd"),i.a.createElement(b.Modal,{title:i.a.createElement(F.a,{content:"prediction.add_opinion_modal.title"}),visible:this.props.visible,onCancel:this.props.onClose,overlay:!0,closable:!this.state.inProgress,footer:r},i.a.createElement("div",{className:"prediction-markets--add-prediction-offer"},i.a.createElement(b.Form,{className:"full-width",layout:"vertical"},i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.add_opinion_modal.symbol"}),i.a.createElement(b.Input,{type:"text",disabled:!0,tabIndex:1,value:this.props.predictionMarket.symbol}))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.details.prediction"}),i.a.createElement(b.Input,{type:"text",disabled:!0,tabIndex:2,value:this.props.predictionMarket.condition}))),i.a.createElement(b.Form.Item,null,i.a.createElement("span",{className:!n.probability&&t||a?"has-error":""},i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.details.predicated_likelihood"}),i.a.createElement(D.a,{placeholder:"0.0",onChange:this.handleProbabilityChange,value:this.state.newOpinionParameters.probability})))),i.a.createElement(b.Form.Item,{style:{marginBottom:"1rem"}},i.a.createElement("span",null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.details.i_think_that"}))),i.a.createElement(b.Radio.Group,{value:this.state.selectedOpinion,onChange:this.handleOpinionChange},i.a.createElement(b.Radio,{value:"yes"},u.a.translate("prediction.details.proves_true")),i.a.createElement(b.Radio,{value:"no"},u.a.translate("prediction.details.incorrect")))),i.a.createElement(b.Form.Item,null,i.a.createElement("span",null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.details.premium"}),i.a.createElement(L.a,{onChange:this.handleAmountChange,placeholder:"0.0",tabIndex:6,amount:this.state.newOpinionParameters.amount,asset:this.props.baseAsset.get("id")})))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.details.commission"}),i.a.createElement(L.a,{disabled:!0,amount:Math.min(this.props.predictionMarket.max_market_fee,this.state.newOpinionParameters.amount*this.props.predictionMarket.market_fee/1e4),asset:this.props.baseAsset.get("id")}))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.details.potential_profit"}),i.a.createElement(L.a,{disabled:!0,amount:this._getPotentialWinnings(),asset:this.props.baseAsset.get("id")}))),this.state.inProgress?i.a.createElement(F.a,{content:"footer.loading"}):null)))}}]),t}(),U=B;B.propTypes={visible:m.a.bool,onClose:m.a.func,predictionMarket:m.a.any.isRequired,opinion:m.a.any,currentAccount:_.a.ChainAccount.isRequired,submitNewOpinion:m.a.func,preselectedOpinion:m.a.string,preselectedAmount:m.a.number,preselectedProbability:m.a.number,baseAsset:m.a.object,quoteAsset:m.a.object},B.defaultProps={visible:!1,predictionMarket:null,opinion:{}};var z=n(400),G=n(184),W=n.n(G),V=n(30),J=n.n(V),K=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var Y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={marketOptions:{precision:"5",max_supply:1e5,max_market_fee:0,market_fee_percent:0,description:{main:""},reward_percent:0,symbol:""},showWarning:!1,wrongSymbol:!1,wrongDate:!1,core_exchange_rate:{quote:{asset_id:null,amount:1},base:{asset_id:"1.3.0",amount:1}},bitasset_opts:{feed_lifetime_sec:86400,minimum_feeds:7,force_settlement_delay_sec:86400,force_settlement_offset_percent:1*W.a.GRAPHENE_1_PERCENT,maximum_force_settlement_volume:20*W.a.GRAPHENE_1_PERCENT,short_backing_asset:"1.3.0"},inProgress:!1},n.handleChange=n.handleChange.bind(n),n.handleAssetChange=n.handleAssetChange.bind(n),n.handleFeeChange=n.handleFeeChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b["Modal"]),K(t,[{key:"_getPermissions",value:function(){var e=s.a.getFlagBooleans(0,!0),t=s.a.getFlagBooleans("all",!0);return e.charge_market_fee=!0,{flagBooleans:e,permissionBooleans:t}}},{key:"_createAsset",value:function(e){var t=this;e&&e.preventDefault();var n=this._getPermissions(),a=n.flagBooleans,i=n.permissionBooleans,r=this.state,o=r.marketOptions,c=r.core_exchange_rate,p=r.bitasset_opts,u=y.ChainStore.getAccount(this.props.currentAccount).get("id"),d=s.a.getFlags(a,!0),m=s.a.getPermissions(i,!0),h=JSON.stringify(this.state.marketOptions.description);this.setState({inProgress:!0}),l.a.createAsset(u,o,d,m,c,!0,!0,p,h).then(function(e){t.setState({inProgress:!1}),console.log("... AssetActions.createAsset(account_id, update)",u,o,d,m),t.props.onMarketCreated(o.symbol)}).catch(function(e){console.error(e),t.setState({inProgress:!1})})}},{key:"handleChange",value:function(e){var t=this.state.marketOptions;switch(e instanceof J.a&&(e.set("milliseconds",0),e={target:{name:"expiry",value:e.toISOString()}}),e.target.name){case"symbol":t[e.target.name]=e.target.value.toUpperCase();break;case"main":case"condition":case"expiry":t.description[e.target.name]=e.target.value;break;default:t[e.target.name]=e.target.value}this.setState({marketOptions:t})}},{key:"handleAssetChange",value:function(e){if(e){var t=this.state.bitasset_opts,n=this.state.marketOptions,a=this.state.core_exchange_rate;t.short_backing_asset=e,n.precision=y.ChainStore.getAsset(e).get("precision"),a.base.asset_id=e,this.setState({bitasset_opts:t,core_exchange_rate:a,marketOptions:n})}}},{key:"_forcePositive",value:function(e){return parseFloat(e)<0?"0":e}},{key:"handleFeeChange",value:function(e){console.log(e);var t=this.state.marketOptions;t.market_fee_percent=this._forcePositive(e.target.value),this.setState({marketOptions:t})}},{key:"_isFormValid",value:function(){return this.props.symbols.includes(this.state.marketOptions.symbol)?(this.setState({wrongSymbol:!0}),!1):(this.setState({wrongSymbol:!1}),new Date>new Date(this.state.marketOptions.description.expiry)?(this.setState({wrongDate:!0}),!1):(this.setState({wrongDate:!1}),this.state.marketOptions.symbol&&this.state.marketOptions.description.main&&this.state.marketOptions.description.condition&&this.state.marketOptions.description.expiry))}},{key:"onSubmit",value:function(e){this._isFormValid()?this._createAsset.call(this,e):this.setState({showWarning:!0})}},{key:"render",value:function(){var e=this.state,t=e.showWarning,n=e.marketOptions,a=e.wrongSymbol,r=e.wrongDate,o=[i.a.createElement(b.Button,{type:"primary",key:"submit",onClick:this.onSubmit,disabled:this.state.inProgress},u.a.translate("global.confirm")),i.a.createElement(b.Button,{key:"cancel",onClick:this.props.onClose,disabled:this.state.inProgress},u.a.translate("global.cancel"))];return i.a.createElement(b.Modal,{title:i.a.createElement(F.a,{content:"prediction.create_market_modal.title"}),visible:this.props.visible,onCancel:this.props.onClose,overlay:!0,closable:!this.state.inProgress,footer:o},i.a.createElement("div",null,i.a.createElement(b.Form,{className:"full-width",layout:"vertical"},i.a.createElement(b.Form.Item,null,i.a.createElement("span",{className:!n.symbol&&t||a?"has-error":""},i.a.createElement("label",{className:"left-label"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.create_market_modal.tooltip_symbol"),placement:"topLeft"},i.a.createElement(F.a,{content:"prediction.create_market_modal.symbol"}),i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),i.a.createElement(b.Input,{name:"symbol",type:"text",onChange:this.handleChange,tabIndex:1,value:this.state.marketOptions.symbol})))),i.a.createElement(b.Form.Item,null,i.a.createElement("span",{className:!n.description.condition&&t?"has-error":""},i.a.createElement("label",{className:"left-label"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.create_market_modal.tooltip_condition"),placement:"topLeft"},i.a.createElement(F.a,{content:"prediction.create_market_modal.condition"}),i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),i.a.createElement(b.Input,{name:"condition",type:"text",onChange:this.handleChange,tabIndex:2})))),i.a.createElement(b.Form.Item,null,i.a.createElement("span",{className:!n.description.main&&t?"has-error":""},i.a.createElement("label",{className:"left-label"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.create_market_modal.tooltip_description"),placement:"topLeft"},i.a.createElement(F.a,{content:"prediction.create_market_modal.description"}),i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),i.a.createElement(b.Input.TextArea,{name:"main",onChange:this.handleChange,tabIndex:3})))),i.a.createElement(b.Form.Item,null,i.a.createElement("span",{className:!n.description.expiry&&t||r?"has-error":""},i.a.createElement("label",{className:"left-label"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.create_market_modal.tooltip_resolution_date"),placement:"topLeft"},i.a.createElement(F.a,{content:"prediction.create_market_modal.resolution_date"}),i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),i.a.createElement("div",null,i.a.createElement(b.DatePicker,{style:{width:"100%"},name:"expiry",showTime:!0,placeholder:u.a.translate("prediction.create_market_modal.select_date_and_time"),onChange:this.handleChange,onOk:this.handleChange,tabIndex:4}))))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.create_market_modal.tooltip_backing_asset"),placement:"topLeft"},i.a.createElement(F.a,{content:"prediction.create_market_modal.backing_asset"}),i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),i.a.createElement(z.a,{assets:["1.3.0","1.3.113","1.3.120","1.3.121"],value:this.state.bitasset_opts.short_backing_asset,onChange:this.handleAssetChange,tabIndex:5}))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.create_market_modal.tooltip_commission"),placement:"topLeft"},i.a.createElement(F.a,{content:"prediction.create_market_modal.commission"}),i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),i.a.createElement(b.Input,{tabIndex:6,type:"number",value:this.state.marketOptions.market_fee_percent,onChange:this.handleFeeChange}))),this.state.inProgress?i.a.createElement(F.a,{content:"footer.loading"}):null)))}}]),t}(),Q=Y;Y.propTypes={visible:m.a.bool,onClose:m.a.func,currentAccount:m.a.string,symbols:m.a.array,onMarketCreated:m.a.func},Y.defaultProps={visible:!1};var X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Z=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var $=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={resolveParameters:{asset_id:n.props.predictionMarket.asset_id,result:"yes"},result:"yes"},n.handleResultChange=n.handleResultChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b["Modal"]),Z(t,[{key:"handleResultChange",value:function(e){var t=e.target.value;this.setState({resolveParameters:X({},this.state.resolveParameters,{result:t}),result:t})}},{key:"render",value:function(){var e=this,t=[i.a.createElement(b.Button,{type:"primary",key:"submit",onClick:function(){return e.props.onResolveMarket(e.state.resolveParameters)},disabled:this.state.inProgress},u.a.translate("global.confirm")),i.a.createElement(b.Button,{key:"cancel",onClick:this.props.onClose,disabled:this.state.inProgress},u.a.translate("global.cancel"))];return i.a.createElement(b.Modal,{title:i.a.createElement(F.a,{content:"prediction.resolve_modal.title"}),visible:this.props.visible,onCancel:this.props.onClose,overlay:!0,closable:!this.state.inProgress,footer:t},i.a.createElement("div",{className:"prediction-markets--resolve-prediction-market-asset"},i.a.createElement(b.Form,{className:"full-width",layout:"vertical"},i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.resolve_modal.symbol"}),i.a.createElement(b.Input,{type:"text",disabled:!0,tabIndex:1,value:this.props.predictionMarket.symbol}))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.resolve_modal.prediction"}),i.a.createElement(b.Input,{type:"text",disabled:!0,tabIndex:2,value:this.props.predictionMarket.condition}))),i.a.createElement(b.Form.Item,null,i.a.createElement("label",{className:"left-label"},i.a.createElement(F.a,{content:"prediction.resolve_modal.the_prediction_has"})),i.a.createElement(b.Radio.Group,{value:this.state.result,onChange:this.handleResultChange},i.a.createElement(b.Radio,{value:"yes"},u.a.translate("prediction.resolve_modal.proven_true")),i.a.createElement(b.Radio,{value:"no"},u.a.translate("prediction.resolve_modal.was_incorrect")))))))}}]),t}(),ee=$;$.propTypes={predictionMarket:m.a.any.isRequired,onResolveMarket:m.a.func.isRequired,visible:m.a.bool,onClose:m.a.func},$.defaultProps={visible:!1,predictionMarket:null};var te=n(39),ne=n(1975),ae=n(29),ie=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function re(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var oe=["1.2.1634961"],se=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onOppose=function(e){n.setState({preselectedOpinion:"no"===e.opinion?"yes":"no",preselectedAmount:e.amount,preselectedProbability:e.probability}),n.onAddOpinionModalOpen()},n.onCancelOpinion=function(e){n._cancelLimitOrders([e.order_id])},n.onSubmitNewOpinion=function(e){n.state.opinions?n.setState({opinions:[].concat(re(n.state.opinions),[e]),isAddOpinionModalOpen:!1}):n.setState({opinions:[e],isAddOpinionModalOpen:!1})},n.onResolveMarket=function(e){var t=n.props.currentAccount.get("id"),a="yes"===e.result?1:0,i=y.ChainStore.getAsset(e.asset_id).toJS(),r=new q.a({real:a,asset_id:i.id,precision:i.precision}),o=y.ChainStore.getAsset(i.bitasset.options.short_backing_asset),s=new q.a({real:1,asset_id:i.bitasset.options.short_backing_asset,precision:o.get("precision")}),c=new q.i({quote:s,base:r});l.a.assetGlobalSettle(i,t,c).then(function(){new Promise(function(e){return setTimeout(e,1e3)}).then(function(e){n.updateAsset(i.symbol)})}),n.setState({isResolveModalOpen:!1})},n.state={lastAssetSymbol:null,predictionMarkets:[],isFetchingFinished:!1,searchTerm:"",detailsSearchTerm:"",selectedPredictionMarket:null,opinions:[],fetchedAssets:[],preselectedOpinion:"yes",preselectedAmount:0,preselectedProbability:0,isCreateMarketModalOpen:!1,isAddOpinionModalOpen:!1,isResolveModalOpen:!1,isHideUnknownHousesChecked:!0,isHideInvalidAssetsChecked:!0,opinionFilter:"yes",predictionMarketAssetFilter:"open"},n.onCreatePredictionMarketModalOpen=n.onCreatePredictionMarketModalOpen.bind(n),n.onCreatePredictionMarketModalClose=n.onCreatePredictionMarketModalClose.bind(n),n.onAddOpinionModalOpen=n.onAddOpinionModalOpen.bind(n),n.onAddOpinionModalClose=n.onAddOpinionModalClose.bind(n),n.onSearch=n.onSearch.bind(n),n.onSearchDetails=n.onSearchDetails.bind(n),n.onMarketAction=n.onMarketAction.bind(n),n.onResolveModalOpen=n.onResolveModalOpen.bind(n),n.onResolveModalClose=n.onResolveModalClose.bind(n),n.updateAsset=n.updateAsset.bind(n),n.handleUnknownHousesToggleChange=n.handleUnknownHousesToggleChange.bind(n),n.handleInvalidAssetsChecked=n.handleInvalidAssetsChecked.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),ie(t,[{key:"componentWillMount",value:function(){this._checkAssets(this.props.assets)}},{key:"componentWillReceiveProps",value:function(e){e.assets!==this.props.assets&&this._checkAssets(e.assets),e.marketLimitOrders!==this.props.marketLimitOrders&&this._updateOpinionsList(e.marketLimitOrders)}},{key:"_checkAssets",value:function(e){var t=this.state.lastAssetSymbol?this.state.lastAssetSymbol:"A";if(e){var n=e.sort(function(e,t){return e.symbol>t.symbol?1:e.symbol<t.symbol?-1:0}).last();t=n?n.symbol:"A",e.forEach(function(e){e.forPredictions||(e.forPredictions={description:s.a.parseDescription(e.options.description),flagBooleans:s.a.getFlagBooleans(e.options.flags,!0)})}),this._updatePredictionMarketsList(e)}this.state.lastAssetSymbol&&this.state.lastAssetSymbol===t?this.setState({isFetchingFinished:!0,fetchedAssets:e}):(l.a.getAssetList.defer(t,100),this.setState({lastAssetSymbol:t}))}},{key:"_isKnownIssuer",value:function(e){return oe.includes(e.issuer)}},{key:"_isValidPredictionMarketAsset",value:function(e){var t=new Date(e.forPredictions.description.expiry);return!(t instanceof Date&&isNaN(t.getTime()))&&(!!e.forPredictions.description.condition&&(!!e.forPredictions.description.main&&(!(e.forPredictions.description.condition.length<10)&&(!(e.forPredictions.description.main.length<20)&&!(e.options.market_fee_percent/100>=10)))))}},{key:"_updatePredictionMarketsList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==t&&(t=this.state.fetchedAssets);var n=this.state.predictionMarketAssetFilter,a=t.filter(function(t){if(t.bitasset_data&&t.bitasset_data.is_prediction_market){if(e.state.isHideUnknownHousesChecked&&!e._isKnownIssuer(t))return!1;if(e.state.isHideInvalidAssetsChecked&&!e._isValidPredictionMarketAsset(t))return!1;if(n&&"all"!==n){var a=new Date(t.forPredictions.description.expiry),i=t.bitasset_data.settlement_fund>0||a<new Date;return"open"===n?!i:"past_resolution_date"===n&&i}return!0}return!1}),i=[].concat(re(a)).map(function(e){var t=0,n=0;return e[1].forPredictions.flagBooleans.charge_market_fee&&(t=e[1].options.market_fee_percent,n=e[1].options.max_market_fee),{asset:e,asset_id:e[1].id,issuer:e[1].issuer,description:e[1].forPredictions.description.main,symbol:e[1].symbol,condition:e[1].forPredictions.description.condition,expiry:e[1].forPredictions.description.expiry,options:e[1].options,marketConfidence:0,marketLikelihood:0,market_fee:t,max_market_fee:n}});this.setState({predictionMarkets:i})}},{key:"_updateOpinionsList",value:function(e){var t=[],n=this.state.selectedPredictionMarket;e.forEach(function(e,a){var i=e.market_base===e.sell_price.base.asset_id?"no":"yes",r=e.market_base===e.sell_price.base.asset_id?e.sell_price.invert().toReal():e.sell_price.toReal(),o=e.market_base===e.sell_price.base.asset_id?e.amountForSale():e.amountToReceive(),l=e.market_base===e.sell_price.base.asset_id?e.amountToReceive():e.amountForSale(),c=0;s.a.getFlagBooleans(n.options.flags,!0).charge_market_fee&&(c=Math.min(n.options.max_market_fee,o.amount*n.options.market_fee_percent/1e4)),r<1&&t.push({order_id:a,opinionator:e.seller,opinion:i,amount:o,likelihood:r,potentialProfit:new q.a({amount:o.amount,asset_id:l.asset_id,precision:l.precision}),premium:l,commission:new q.a({amount:c*r,asset_id:l.asset_id,precision:l.precision})})}),this.setState({opinions:[].concat(t)})}},{key:"getMarketOpinions",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(i,r){try{var o=t[i](r),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})}}(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.subscribedMarket){e.next=3;break}return e.next=3,c.a.unSubscribeMarket(this.state.subscribedMarket.quote.get("id"),this.state.subscribedMarket.base.get("id"));case 3:return n=y.ChainStore.getAsset(t.options.core_exchange_rate.base.asset_id),a=y.ChainStore.getAsset(t.options.core_exchange_rate.quote.asset_id),e.next=7,c.a.subscribeMarket(n,a,this.props.bucketSize,this.props.currentGroupOrderLimit);case 7:this.setState({subscribedMarket:{base:n,quote:a}});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onMarketAction",value:function(e){var t=this,n=e.market,a=e.action;if("string"==typeof a)switch(this.state.selectedPredictionMarket||this.setState({selectedPredictionMarket:n}),a){case"resolve":this.setState({preselectedAmount:0,preselectedProbability:0}),this.onResolveModalOpen();break;case"yes":this.state.subscribedMarket&&(this.setState({preselectedAmount:0,preselectedProbability:0,preselectedOpinion:"yes"}),this.onAddOpinionModalOpen());break;case"no":this.state.subscribedMarket&&(this.setState({preselectedAmount:0,preselectedProbability:0,preselectedOpinion:"no"}),this.onAddOpinionModalOpen());break;default:this.setState({preselectedAmount:0,preselectedProbability:0})}else this.state.selectedPredictionMarket?this.setState({selectedPredictionMarket:null}):this.setState({selectedPredictionMarket:n},function(){return t.getMarketOpinions(n)})}},{key:"onSearch",value:function(e){this.setState({searchTerm:e.target.value||""})}},{key:"onSearchDetails",value:function(e){this.setState({detailsSearchTerm:e.target.value||""})}},{key:"onCreatePredictionMarketModalOpen",value:function(){this.setState({isCreateMarketModalOpen:!0})}},{key:"onCreatePredictionMarketModalClose",value:function(){this.setState({isCreateMarketModalOpen:!1})}},{key:"onAddOpinionModalOpen",value:function(){this.setState({isAddOpinionModalOpen:!0})}},{key:"onAddOpinionModalClose",value:function(){this.setState({isAddOpinionModalOpen:!1,preselectedOpinion:"no",preselectedAmount:0,preselectedProbability:0})}},{key:"onResolveModalOpen",value:function(){this.setState({isResolveModalOpen:!0})}},{key:"onResolveModalClose",value:function(){this.setState({isResolveModalOpen:!1})}},{key:"handleUnknownHousesToggleChange",value:function(){var e=this,t=!this.state.isHideUnknownHousesChecked;this.setState({isHideUnknownHousesChecked:t,selectedPredictionMarket:null},function(){return e._updatePredictionMarketsList()})}},{key:"handleInvalidAssetsChecked",value:function(){var e=this,t=!this.state.isHideInvalidAssetsChecked;this.setState({isHideInvalidAssetsChecked:t,selectedPredictionMarket:null},function(){return e._updatePredictionMarketsList()})}},{key:"_cancelLimitOrders",value:function(e){c.a.cancelLimitOrders(this.props.currentAccount.get("id"),e).catch(function(e){console.log("cancel orders error:",e)})}},{key:"updateAsset",value:function(e){l.a.getAssetList.defer(e,1)}},{key:"getOverviewSection",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"header-selector",style:{display:"inline-block",width:"100%"}},i.a.createElement("div",{className:"filter-block"},i.a.createElement(R.a,{onChange:this.onSearch,value:this.state.searchTerm}),i.a.createElement(b.Radio.Group,{style:{marginLeft:"20px"},value:this.state.predictionMarketAssetFilter,onChange:function(t){e.setState({predictionMarketAssetFilter:t.target.value},e._updatePredictionMarketsList)}},i.a.createElement(b.Radio,{value:"all"},u.a.translate("prediction.overview.all")),i.a.createElement(b.Radio,{value:"open"},u.a.translate("prediction.overview.open")),i.a.createElement(b.Radio,{value:"past_resolution_date"},u.a.translate("prediction.overview.past_resolution_date"))),i.a.createElement("span",null,i.a.createElement(b.Switch,{style:{marginLeft:"20px"},onChange:this.handleUnknownHousesToggleChange,checked:this.state.isHideUnknownHousesChecked}),i.a.createElement(F.a,{onClick:this.handleUnknownHousesToggleChange,content:"prediction.overview.hide_unknown_houses",style:{marginLeft:"10px",cursor:"pointer"}}),i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.tooltips.hide_unknown_houses")},i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},type:"question-circle",theme:"filled"})),i.a.createElement(b.Switch,{style:{marginLeft:"20px"},onChange:this.handleInvalidAssetsChecked,checked:this.state.isHideInvalidAssetsChecked}),i.a.createElement(F.a,{onClick:this.handleInvalidAssetsChecked,content:"prediction.overview.hide_invalid_asset",style:{marginLeft:"10px",cursor:"pointer"}}),i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.tooltips.hide_invalid_asset")},i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},type:"question-circle",theme:"filled"})))),i.a.createElement("span",{className:"action-buttons"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.tooltips.create_prediction_market_asset")},i.a.createElement(b.Icon,{style:{fontSize:"1.3rem",marginRight:"0.5rem"},type:"question-circle",theme:"filled"})),i.a.createElement(b.Button,{onClick:this.onCreatePredictionMarketModalOpen},u.a.translate("prediction.overview.create_market")))),i.a.createElement(M,{predictionMarkets:this.state.predictionMarkets,currentAccount:this.props.currentAccount,onMarketAction:this.onMarketAction,searchTerm:this.state.searchTerm.toUpperCase(),selectedPredictionMarket:this.state.selectedPredictionMarket,hideUnknownHouses:this.state.isHideUnknownHousesChecked}))}},{key:"getDetailsSection",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("h3",null,u.a.translate("prediction.details.list_of_current_prediction_offers"),i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.tooltips.what_is_a_prediction_offer")},i.a.createElement(b.Icon,{style:{marginLeft:"0.5rem"},type:"question-circle",theme:"filled"}))),i.a.createElement("div",{className:"header-selector",style:{display:"inline-block",width:"100%"}},i.a.createElement("div",{className:"filter-block"},i.a.createElement(R.a,{onChange:this.onSearchDetails,value:this.state.detailsSearchTerm,autoComplete:"off"}),i.a.createElement(b.Radio.Group,{style:{marginLeft:"20px"},value:this.state.opinionFilter,onChange:function(t){e.setState({opinionFilter:t.target.value})}},i.a.createElement(b.Radio,{value:"all"},u.a.translate("prediction.details.all")),i.a.createElement(b.Radio,{value:"yes"},u.a.translate("prediction.details.proves_true")),i.a.createElement(b.Radio,{value:"no"},u.a.translate("prediction.details.incorrect")))),i.a.createElement("span",{className:"action-buttons"},i.a.createElement(b.Tooltip,{title:u.a.translate("prediction.tooltips.add_prediction")},i.a.createElement(b.Icon,{style:{fontSize:"1.3rem",marginRight:"0.5rem"},type:"question-circle",theme:"filled"})),i.a.createElement(b.Button,{onClick:this.onAddOpinionModalOpen},u.a.translate("prediction.details.add_prediction")))),this.state.opinions?i.a.createElement(I,{predictionMarketData:{predictionMarket:this.state.selectedPredictionMarket,opinions:this.state.opinions},currentAccount:this.props.currentAccount,onOppose:this.onOppose,onCancel:this.onCancelOpinion,detailsSearchTerm:this.state.detailsSearchTerm.toUpperCase(),opinionFilter:this.state.opinionFilter}):null)}},{key:"render",value:function(){var e=[].concat(re(this.props.assets)).map(function(e){return e[1].symbol});return i.a.createElement("div",{className:"prediction-markets grid-block vertical",style:{overflow:"visible",margin:"15px"}},i.a.createElement("div",{className:"grid-block small-12 shrink",style:{overflow:"visible"}},i.a.createElement(j.a,{path:"components/PredictionMarkets"})),this.getOverviewSection(),this.state.selectedPredictionMarket?this.getDetailsSection():null,this.state.isCreateMarketModalOpen?i.a.createElement(Q,{visible:this.state.isCreateMarketModalOpen,onClose:this.onCreatePredictionMarketModalClose,currentAccount:this.props.currentAccount,symbols:e,onMarketCreated:this.updateAsset}):null,this.state.isAddOpinionModalOpen?i.a.createElement(U,{visible:this.state.isAddOpinionModalOpen,onClose:this.onAddOpinionModalClose,predictionMarket:this.state.selectedPredictionMarket,opinion:this.state.initialOpinion,currentAccount:this.props.currentAccount,submitNewOpinion:this.onSubmitNewOpinion,preselectedOpinion:this.state.preselectedOpinion,preselectedAmount:this.state.preselectedAmount,preselectedProbability:this.state.preselectedProbability,baseAsset:this.state.subscribedMarket.base,quoteAsset:this.state.subscribedMarket.quote}):null,this.state.isResolveModalOpen?i.a.createElement(ee,{visible:this.state.isResolveModalOpen,onClose:this.onResolveModalClose,predictionMarket:this.state.selectedPredictionMarket,onResolveMarket:this.onResolveMarket}):null,this.state.isFetchingFinished?null:i.a.createElement(te.a,{loadingText:u.a.translate("prediction.overview.loading")}))}}]),t}();se=Object(ae.a)(se,{listenTo:function(){return[r.a,o.a]},getProps:function(){return{assets:r.a.getState().assets,markets:o.a.getState().marketData,bucketSize:o.a.getState().bucketSize,currentGroupOrderLimit:o.a.getState().currentGroupLimit,marketLimitOrders:o.a.getState().marketLimitOrders}}});var le=se=Object(ne.a)(se),ce=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var pe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.a.Component),ce(t,[{key:"render",value:function(){return i.a.createElement(le,null)}}]),t}();t.default=pe}}]);
//# sourceMappingURL=pm.js.map