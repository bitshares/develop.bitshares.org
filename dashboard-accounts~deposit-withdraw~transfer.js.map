{"version":3,"file":"dashboard-accounts~deposit-withdraw~transfer.ce01c8026e483324d58b.js","sources":["webpack:///dashboard-accounts~deposit-withdraw~transfer.ce01c8026e483324d58b.js"],"sourcesContent":["(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1939:function(e,t,n){\"use strict\";var a=n(0),r=n.n(a),o=n(1966),i=n.n(o),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={animateEnter:!1},e.timer=null,e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),s(t,[{key:\"componentDidMount\",value:function(){this.enableAnimation()}},{key:\"resetAnimation\",value:function(){this.setState({animateEnter:!1}),this.enableAnimation()}},{key:\"enableAnimation\",value:function(){var e=this;this.timer=setTimeout(function(){e.timer&&e.setState({animateEnter:!0})},2e3)}},{key:\"componentWillUnmount\",value:function(){clearTimeout(this.timer),this.timer=null}},{key:\"render\",value:function(){return this.props.children?r.a.createElement(i.a,{id:this.props.id,className:this.props.className,component:this.props.component,transitionName:this.props.transitionName,transitionEnterTimeout:this.props.enterTimeout,transitionEnter:this.state.animateEnter,transitionLeave:!1},this.props.children):r.a.createElement(this.props.component)}}]),t}();c.defaultProps={component:\"span\",enterTimeout:2e3},t.a=c},1950:function(e,t,n){\"use strict\";var a=n(0),r=n.n(a),o=n(298),i=n(5),s=n.n(i),c=n(1939),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={page:1,pageSize:e.pageSize},n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),l(t,[{key:\"onChange\",value:function(e,t){this.setState({page:e,pageSize:t})}},{key:\"render\",value:function(){var e=this,t=this.state,n=t.page,a=t.pageSize,i=this.props,l=i.header,u=i.rows,h=i.extraRow,p=u.length,f=m(n,a);function m(e,t){for(var n=[],a=(e-1)*t;a<Math.min(p,e*t);a++)n.push(u[a]);return n}return!f.length&&p&&(f=m(1,a)),r.a.createElement(\"div\",{className:\"grid-content\",style:this.props.style},r.a.createElement(\"table\",{className:this.props.className},l?r.a.createElement(\"thead\",null,l):null,this.props.withTransition&&1===n?r.a.createElement(c.a,{component:\"tbody\",transitionName:\"newrow\"},f,h):r.a.createElement(\"tbody\",null,f,h)),p>a?r.a.createElement(o.a,{style:{paddingTop:\"1rem\",paddingBottom:\"1rem\",paddingLeft:this.props.leftPadding||null},total:p,showTotal:function(t){return s.a.translate(e.props.label,{count:t})},pageSize:a,current:n,onChange:this.onChange.bind(this)}):null,this.props.children)}}]),t}();u.defaultProps={rows:[],pageSize:15,label:\"utility.total_x_items\",className:\"table\",extraRow:null,style:{paddingBottom:\"1rem\"}},t.a=u},1952:function(e,t,n){\"use strict\";var a=n(0),r=n.n(a),o=n(2),i=n.n(o),s=n(587),c=n(39),l=n(45),u=n(12),h=n(6),p=n(1944),f=n.n(p),m=n(5),d=n.n(m),y=n(23),_=n(3),b=n.n(_),g=n(1),v=n.n(g),E=n(1950),w=n(44),k=n(4),x=n(368),C=n(1967),S=n.n(C),N=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var O=h.ChainTypes.operations,H=Object.keys(O),T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e)}return N(e,[{key:\"pad\",value:function(e,t){for(var n=\"\"+e;n.length<t;)n=\"0\"+n;return n}},{key:\"formatDate\",value:function(e){return(\"0\"+e.getDate()).slice(-2)+\".\"+(\"0\"+(e.getMonth()+1)).slice(-2)+\".\"+e.getFullYear()+\" \"+(\"0\"+e.getHours()).slice(-2)+\":\"+(\"0\"+e.getMinutes()).slice(-2)+\":\"+(\"0\"+e.getSeconds()).slice(-2)+\" GMT\"+(e.getTimezoneOffset()<0?\"+\":\"-\")+this.pad(parseInt(Math.floor(Math.abs(e.getTimezoneOffset()/60))),2)+this.pad(Math.abs(e.getTimezoneOffset()%60),2)}},{key:\"generateCSV\",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(r,o){try{var i=t[r](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){a(\"next\",e)},function(e){a(\"throw\",e)});e(s)}(\"next\")})}}(regeneratorRuntime.mark(function e(t,n,a){var r,o,i,s,c,l,u,p,f,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,o=150,i=t[0].get(\"id\"),e.next=4,Object(h.FetchChain)(\"getAccount\",i);case 4:s=e.sent.get(\"name\"),c={};case 6:return e.next=9,this._getAccountHistoryES(i,o,r,n);case 9:if((l=e.sent).length){e.next=12;break}return e.abrupt(\"break\",20);case 12:return e.next=14,S.a.resolveBlockTimes(l);case 14:return e.next=16,S.a.resolveAssets(l);case 16:l.map(function(e){var t=e.id,n=H[e.op.type],a=e.op.data;switch(n){case\"vesting_balance_withdraw\":case\"transfer\":a.amount=a.amount_}c[t]={timestamp:new Date(e.block_time),type:n,data:a}}),r+=l.length,e.next=6;break;case 20:if(Object.keys(c).length){e.next=22;break}return e.abrupt(\"return\");case 22:if(u=void 0,\"FULL\"===a)for(p in u=[],c)u.push([p,c[p]]);else c=S.a.groupEntries(c),u=S.a.parseData(c,i,s);f=this.dataToCSV(u,a),m=new Date,Object(x.saveAs)(f,\"bitshares-account-history-\"+s+\"-\"+m.getFullYear()+\"-\"+(\"0\"+(m.getMonth()+1)).slice(-2)+\"-\"+(\"0\"+m.getDate()).slice(-2)+\"-\"+(\"0\"+m.getHours()).slice(-2)+(\"0\"+m.getMinutes()).slice(-2)+\".csv\");case 27:case\"end\":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:\"_getAccountHistoryES\",value:function(e,t,n,a){return console.log(\"query\",a+\"/get_account_history?account_id=\"+e+\"&from_=\"+n+\"&size=\"+t+\"&sort_by=block_data.block_time&type=data&agg_field=operation_type\"),new Promise(function(r,o){fetch(a+\"/get_account_history?account_id=\"+e+\"&from_=\"+n+\"&size=\"+t+\"&sort_by=block_data.block_time&type=data&agg_field=operation_type\").then(function(e){return e.json()}).then(function(e){var t=e.map(function(e){return{id:e.account_history.operation_id,op:{type:e.operation_type,data:e.operation_history.op_object},result:JSON.parse(e.operation_history.operation_result),block_num:e.block_data.block_num,block_time:e.block_data.block_time+\"Z\"}});r(t)}).catch(function(e){o(e)})})}},{key:\"dataToCSV\",value:function(e,t){var n=\"\",a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;\"COINBASE\"===t?(c.length>=11&&c[10]instanceof Date&&(c[10]=this.formatDate(c[10])),n+=c.join(\",\")+\"\\n\"):n+=JSON.stringify(c)+\"\\n\"}}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return new Blob([n],{type:\"text/csv;charset=utf-8\"})}}]),e}(),P=n(48);n.d(t,\"a\",function(){return D}),n.d(t,\"b\",function(){return I});var j=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function A(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function M(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function L(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var R=h.ChainTypes.operations,F={textAlign:\"left\"};function z(e,t){return t.block_num===e.block_num?t.trx_in_block!==e.trx_in_block?t.trx_in_block-e.trx_in_block:t.op_in_trx!==e.op_in_trx?t.op_in_trx-e.op_in_trx:t.virtual_op-e.virtual_op:t.block_num-e.block_num}var D=function(e){function t(e){A(this,t);var n=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={limit:e.limit,fetchingAccountHistory:!1,headerHeight:85,filter:\"all\",accountHistoryError:!1,showModal:!1,esNodeCustom:!1,esNode:P.i.ES_WRAPPER_LIST[0].url},n.useCustom=d.a.translate(\"account.export_modal.use_custom\"),n.showExportModal=n.showExportModal.bind(n),n.hideExportModal=n.hideExportModal.bind(n),n.esNodeChange=n.esNodeChange.bind(n),n._generateCSV=n._generateCSV.bind(n),n}return L(t,r.a.Component),j(t,[{key:\"componentDidMount\",value:function(){if(!this.props.fullHeight){var e=this.refs.transactions;f.a.initialize(e),this._setHeaderHeight()}}},{key:\"esNodeChange\",value:function(e){var t=null;(t=e.target?e.target.value:e)==this.useCustom?this.setState({esNode:\"\",esNodeCustom:!0}):this.setState({esNode:t})}},{key:\"showExportModal\",value:function(){this.setState({showModal:!0})}},{key:\"hideExportModal\",value:function(){this.setState({showModal:!1})}},{key:\"_setHeaderHeight\",value:function(){var e=this.refs.header.offsetHeight;e!==this.state.headerHeight&&this.setState({headerHeight:e})}},{key:\"shouldComponentUpdate\",value:function(e,t){if(!u.a.are_equal_shallow(this.props.accountsList,e.accountsList))return!0;if(this.props.maxHeight!==e.maxHeight)return!0;if(this.state.headerHeight!==t.headerHeight)return!0;if(this.state.filter!==t.filter)return!0;if(this.props.customFilter&&(!u.a.are_equal_shallow(this.props.customFilter.fields,e.customFilter.fields)||!u.a.are_equal_shallow(this.props.customFilter.values,e.customFilter.values)))return!0;if(this.props.maxHeight!==e.maxHeight)return!0;if(t.limit!==this.state.limit||t.fetchingAccountHistory!==this.state.fetchingAccountHistory)return!0;for(var n=0;n<e.accountsList.length;++n){var a=e.accountsList[n],r=this.props.accountsList[n];if(a&&r&&a.get(\"history\")!==r.get(\"history\"))return!0}return this.state.showModal!==t.showModal||(this.state.esNode!==t.esNode||this.state.esNodeCustom!==t.esNodeCustom)}},{key:\"_onIncreaseLimit\",value:function(){this.setState({limit:this.state.limit+30})}},{key:\"_getHistory\",value:function(e,t,n){var a=[],r=new Set,o=!0,i=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;if(u){var h=u.get(\"history\");h&&(a=a.concat(h.toJS().filter(function(e){return!r.has(e.id)&&r.add(e.id)})))}}}catch(e){i=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw s}}return t&&(a=a.filter(function(e){return e.op[0]===R[t]})),n&&(a=a.filter(function(e){return n.fields.reduce(function(t,a){switch(a){case\"asset_id\":return t&&e.op[1].amount[a]===n.values[a];default:return t&&e.op[1][a]===n.values[a]}},!0)})),a}},{key:\"_generateCSV\",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(r,o){try{var i=t[r](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){a(\"next\",e)},function(e){a(\"throw\",e)});e(s)}(\"next\")})}}(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,n=new T,this.setState({fetchingAccountHistory:!0,showModal:!1}),e.next=6,n.generateCSV(this.props.accountsList,this.state.esNode,t);case 6:this.setState({fetchingAccountHistory:!1,accountHistoryError:null}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.setState({fetchingAccountHistory:!1,accountHistoryError:e.t0,esNodeCustom:!1,esNode:P.i.ES_WRAPPER_LIST[0].url});case 12:case\"end\":return e.stop()}},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:\"_onChangeFilter\",value:function(e){this.setState({filter:e.target.value})}},{key:\"render\",value:function(){var e=this,t=this.props,n=t.accountsList,a=t.compactView,o=t.filter,c=t.customFilter,l=t.style,u=t.maxHeight,h=this.state,p=h.limit,f=h.headerHeight,m=1===n.length&&n[0]?n[0].get(\"id\"):null,_=this._getHistory(n,this.props.showFilters&&\"all\"!==this.state.filter?this.state.filter:o,c).sort(z),g=_.length;l=l||{width:\"100%\",height:\"100%\"};var v=null;v=[\"all\",\"transfer\",\"limit_order_create\",\"limit_order_cancel\",\"fill_order\",\"account_create\",\"account_update\",\"asset_create\",\"witness_withdraw_pay\",\"vesting_balance_withdraw\"].map(function(e){return r.a.createElement(\"option\",{value:e,key:e},d.a.translate(\"transaction.trxTypes.\"+e))});var x=_.length?_.slice(0,p).map(function(e){return r.a.createElement(s.a,{includeOperationId:!0,operationId:e.id,style:F,key:e.id,op:e.op,result:e.result,txIndex:e.trx_in_block,block:e.block_num,current:m,hideFee:!1,inverted:!1,hideOpLabel:a,fullDate:!0})}):[r.a.createElement(\"tr\",{key:\"no_recent\"},r.a.createElement(\"td\",{colSpan:a?\"2\":\"3\"},r.a.createElement(i.a,{content:\"operation.no_recent\"})))],C=r.a.createElement(\"tr\",{className:\"total-value\",key:\"total_value\"},r.a.createElement(\"td\",{style:{textAlign:\"center\"}},\"Â \"),r.a.createElement(\"td\",null),r.a.createElement(\"td\",null),r.a.createElement(\"td\",null),r.a.createElement(\"td\",null)),S=r.a.createElement(\"div\",null,r.a.createElement(k.Button,{onClick:function(){return e._generateCSV(\"FULL\")},type:\"primary\"},r.a.createElement(i.a,{content:\"account.export_modal.full_report\"})),r.a.createElement(k.Button,{onClick:function(){return e._generateCSV(\"COINBASE\")},type:\"primary\"},r.a.createElement(i.a,{content:\"account.export_modal.coinbase_report\"})));return r.a.createElement(\"div\",{className:\"recent-transactions no-overflow\",style:l},r.a.createElement(k.Modal,{wrapClassName:\"modal--transaction-confirm\",title:r.a.createElement(i.a,{content:\"account.export_modal.title\"}),visible:this.state.showModal,id:\"transaction_confirm_modal\",ref:\"modal\",footer:S,overlay:!0,onCancel:this.hideExportModal,noCloseBtn:!0},r.a.createElement(\"p\",null,r.a.createElement(i.a,{content:\"account.export_modal.description\"})),this.state.esNodeCustom?r.a.createElement(k.Input,{type:\"text\",value:this.state.esNode,onChange:this.esNodeChange}):r.a.createElement(k.Select,{showSearch:!0,value:this.state.esNode,onChange:this.esNodeChange,style:{width:\"100%\"}},P.i.ES_WRAPPER_LIST.concat([{url:this.useCustom}]).map(function(e){return r.a.createElement(k.Select.Option,{key:e.url},e.url)}))),r.a.createElement(\"div\",{className:\"generic-bordered-box\"},this.props.dashboard?null:r.a.createElement(\"div\",{ref:\"header\"},r.a.createElement(\"div\",{className:\"block-content-header\"},r.a.createElement(\"span\",null,this.props.title?this.props.title:r.a.createElement(i.a,{content:\"account.recent\"})))),r.a.createElement(\"div\",{className:\"header-selector\"},r.a.createElement(\"div\",{className:\"selector\"},r.a.createElement(\"div\",{className:b()(\"inline-block\")},this.props.showFilters?r.a.createElement(k.Tooltip,{placement:\"bottom\",title:d.a.translate(\"tooltip.filter_ops\")},r.a.createElement(\"select\",{style:{paddingTop:5,width:\"auto\"},className:\"bts-select no-margin\",value:this.state.filter,onChange:this._onChangeFilter.bind(this)},v)):null),g>0?r.a.createElement(k.Tooltip,{placement:\"bottom\",title:d.a.translate(\"transaction.csv_tip\")},r.a.createElement(\"a\",{className:\"inline-block iconLinkAndLabel\",onClick:this.showExportModal,style:{marginLeft:\"1rem\"}},r.a.createElement(y.a,{name:\"excel\",size:\"1x\"}),r.a.createElement(i.a,{content:\"account.download_history\"}))):null),this.state.accountHistoryError&&r.a.createElement(\"div\",{className:\"has-error\",style:{paddingLeft:\"0.75rem\"}},r.a.createElement(i.a,{content:\"account.history_error\"}))),r.a.createElement(\"div\",{className:\"box-content grid-block no-margin\",style:this.props.fullHeight?null:{maxHeight:u-f},ref:\"transactions\"},r.a.createElement(E.a,{withTransition:!0,className:\"table table-striped \"+(a?\"compact\":\"\")+(this.props.dashboard?\" dashboard-table table-hover\":\"\"),header:r.a.createElement(\"tr\",null,r.a.createElement(\"th\",{className:\"column-hide-tiny\",style:F},r.a.createElement(i.a,{content:\"account.transactions.id\"})),r.a.createElement(\"th\",{className:\"column-hide-tiny\",style:F},r.a.createElement(i.a,{content:\"account.transactions.type\"})),r.a.createElement(\"th\",{style:F},r.a.createElement(i.a,{content:\"account.transactions.info\"})),r.a.createElement(\"th\",{style:F},r.a.createElement(i.a,{content:\"account.transactions.fee\"})),r.a.createElement(\"th\",null,r.a.createElement(i.a,{content:\"account.transactions.time\"}))),rows:x,label:\"utility.total_x_operations\",extraRow:C})),this.state.fetchingAccountHistory&&r.a.createElement(w.a,null)))}}]),t}();D.propTypes={accountsList:c.a.ChainAccountsList.isRequired,compactView:v.a.bool,limit:v.a.number,maxHeight:v.a.number,fullHeight:v.a.bool,showFilters:v.a.bool},D.defaultProps={limit:25,maxHeight:500,fullHeight:!1,showFilters:!1},D=Object(l.a)(D);var I=function(e){function t(){return A(this,t),M(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return L(t,r.a.Component),j(t,[{key:\"render\",value:function(){return r.a.createElement(\"span\",{className:\"wrapper\"},this.props.children(this.props))}}]),t}();I.propTypes={asset:c.a.ChainAsset.isRequired,to:c.a.ChainAccount.isRequired,fromAccount:c.a.ChainAccount.isRequired},I.defaultProps={asset:\"1.3.0\"},I=Object(l.a)(I)}}]);"],"mappings":"AAAA","sourceRoot":""}