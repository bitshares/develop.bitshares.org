(this.webpackChunkBitShares2_light=this.webpackChunkBitShares2_light||[]).push([[552],{69673:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Ls});var a=s(96540),r=s(58586),i=s(55840),o=s(74248),n=s(53615),l=s(92646),c=s(14644),d=s(57127),h=s(64741),p=s(62716),m=s(72090),u=s(46128),g=s(32485),b=s.n(g),y=s(10658),_=s.n(y),f=s(22176),C=s.n(f),S=s(95093),A=s.n(S),v=s(68477),E=s.n(v),k=s(5556),w=s.n(k),T=s(84259),P=s(36247),x=s(64143),N=s(88587),O=s(24609),I=s(15483),L=s(87040),B=s(80849),F=s.n(B),R=s(16e3),M=s(12569),D=s(72342);class q extends a.Component{render(){let{price:e,preFormattedPrice:t,quote:s,base:r}=this.props;if(!e&&!t)return null;let i=t||L.A.price_to_text(e,s,r);return i.full>=1?a.createElement("span",null,a.createElement("span",{className:"price-integer"},i.int,"."),i.dec?a.createElement("span",{className:"price-integer"},i.dec):null,i.trailing?a.createElement("span",{className:"price-decimal"},i.trailing):null):i.full>=.1?a.createElement("span",null,a.createElement("span",{className:"price-decimal"},i.int,"."),i.dec?a.createElement("span",{className:"price-integer"},i.dec):null,i.trailing?a.createElement("span",{className:"price-decimal"},i.trailing):null):a.createElement("span",null,a.createElement("span",{className:"price-decimal"},i.int,"."),i.dec?a.createElement("span",{className:"price-decimal"},i.dec):null,i.trailing?a.createElement("span",{className:"price-integer"},i.trailing):null)}}const V=q;var W=s(91001),U=s(63806),z=s(10344),H=s(36234),j=s(85551),$=s(39744);class G extends a.Component{static propTypes={balance:M.A.ChainObject,type:w().string,amountChange:w().func.isRequired,priceChange:w().func.isRequired,onSubmit:w().func.isRequired,onExpirationTypeChange:w().func.isRequired,onExpirationCustomChange:w().func.isRequired};static defaultProps={type:"bid"};constructor(){super(),this.state={forceReRender:!1,isSettleModalVisible:!1},this.showSettleModal=this.showSettleModal.bind(this),this.hideSettleModal=this.hideSettleModal.bind(this)}_forceRender(e){this.state.forceReRender&&this.setState({forceReRender:!1}),this.props.parentWidth!==e.parentWidth&&this.setState({forceReRender:!0})}shouldComponentUpdate(e,t){return this._forceRender(e,t),t.isSettleModalVisible!==this.state.isSettleModalVisible||e.amount!==this.props.amount||e.onBorrow!==this.props.onBorrow||e.total!==this.props.total||e.currentPrice!==this.props.currentPrice||e.price!==this.props.price||e.balance!==this.props.balance||e.account!==this.props.account||e.className!==this.props.className||!(!e.fee||!this.props.fee)&&e.fee.ne(this.props.fee)||e.isPredictionMarket!==this.props.isPredictionMarket||e.feeAsset!==this.props.feeAsset||e.isOpen!==this.props.isOpen||e.hasFeeBalance!==this.props.hasFeeBalance||e.expirationType!==this.props.expirationType||e.expirationCustomTime!==this.props.expirationCustomTime||e.parentWidth!==this.props.parentWidth||t.forceReRender!==this.state.forceReRender||e.singleColumnOrderForm!==this.props.singleColumnOrderForm||e.hideFunctionButtons!==this.props.hideFunctionButtons||t.isQuickDepositVisible!==this.state.isQuickDepositVisible}getDatePickerRef=e=>{this.datePricker=e};showSettleModal(){this.setState({isSettleModalVisible:!0})}hideSettleModal(){this.setState({isSettleModalVisible:!1})}_addBalance(e){"bid"===this.props.type?this.props.totalChange({target:{value:e.getAmount({real:!0}).toString()}}):this.props.amountChange({target:{value:e.getAmount({real:!0}).toString()}})}_setPrice(e){this.props.priceChange({target:{value:e.toString()}})}handleQuickDepositVisibleChange=e=>{this.setState({isQuickDepositVisible:e}),e&&setTimeout((()=>{$.A.rebuild()}),20)};onDeposit(){this.setState({isQuickDepositVisible:!1}),this.props.onDeposit()}onBuy(){this.setState({isQuickDepositVisible:!1}),this.props.onBuy()}onExpirationSelectChange=e=>{"SPECIFIC"===e.target.value?this.datePricker.picker.handleOpenChange(!0):this.datePricker.picker.handleOpenChange(!1),this.props.onExpirationTypeChange(e)};onExpirationSelectClick=e=>{"SPECIFIC"===e.target.value&&(this.firstClick&&(this.secondClick=!0),this.firstClick=!0,this.secondClick&&(this.datePricker.picker.handleOpenChange(!0),this.firstClick=!1,this.secondClick=!1))};onExpirationSelectBlur=()=>{this.firstClick=!1,this.secondClick=!1};render(){let{type:e,quote:t,base:s,amountChange:r,fee:o,isPredictionMarket:l,priceChange:c,onSubmit:d,balance:h,totalChange:p,balancePrecision:m,currentPrice:g,currentPriceObject:y,feeAsset:f,feeAssets:C,hasFeeBalance:S,hideHeader:v,verticalOrderForm:E}=this.props;const{expirationCustomTime:k}=this.props;let w,T,P,N=!!((this.refs.order_form?this.refs.order_form.clientWidth:0)<450||this.props.singleColumnOrderForm);this.props.amount&&(w=this.props.amount),this.props.price&&(T=this.props.price),this.props.total&&(P=this.props.total);let I=new O.Vd({amount:h?h.get("balance"):0,precision:m,asset_id:this.props.balanceId});const B=new O.Vd({amount:s.getIn(["options","max_market_fee"]),asset_id:s.get("asset_id"),precision:s.get("precision")}),M=new O.Vd({amount:t.getIn(["options","max_market_fee"]),asset_id:t.get("asset_id"),precision:t.get("precision")}),D=s.getIn(["options","market_fee_percent"])/100+"%",q=t.getIn(["options","market_fee_percent"])/100+"%",$=w?Math.min(M.getAmount({real:!0}),w*t.getIn(["options","market_fee_percent"])/1e4).toFixed(M.precision):0,G=w?Math.min(B.getAmount({real:!0}),P*s.getIn(["options","market_fee_percent"])/1e4).toFixed(B.precision):0,K=x.A.getFlagBooleans(s.getIn(["options","flags"]),s.has("bitasset_data_id")),Q=x.A.getFlagBooleans(t.getIn(["options","flags"]),t.has("bitasset_data_id")),{name:J,prefix:Y}=L.A.replaceName(this.props.base);var Z=K.charge_market_fee?E?a.createElement(u.Tooltip,{title:_().translate("tooltip.market_fee",{percent:D,asset:(Y||"")+J})},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-12 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"}),", ",D),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{placeholder:"0.0",id:"baseMarketFee",defaultValue:G,value:G,addonAfter:a.createElement("span",null,a.createElement(W.A,{noTip:!0,name:s.get("symbol")}))})))):N?a.createElement(u.Tooltip,{title:_().translate("tooltip.market_fee",{percent:D,asset:(Y||"")+J})},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-3 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"}),", ",D),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{placeholder:"0.0",id:"baseMarketFee",defaultValue:G,value:G,addonAfter:a.createElement("span",null,a.createElement(W.A,{noTip:!0,name:s.get("symbol")}))})))):a.createElement(u.Tooltip,{title:_().translate("tooltip.market_fee",{percent:D,asset:(Y||"")+J})},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-12 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"}),", ",D),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{placeholder:"0.0",id:"baseMarketFee",defaultValue:G,value:G,addonAfter:a.createElement("span",null,a.createElement(W.A,{noTip:!0,name:s.get("symbol")}))})))):null;const{name:X,prefix:ee}=L.A.replaceName(this.props.quote);var te=Q.charge_market_fee?E?a.createElement(u.Tooltip,{title:_().translate("tooltip.market_fee",{percent:q,asset:(ee||"")+X})},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-12 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"}),", ",q),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{placeholder:"0.0",id:"quoteMarketFee",defaultValue:$,value:$,addonAfter:a.createElement("span",null,a.createElement(W.A,{style:{width:100},noTip:!0,name:t.get("symbol")}))})))):N?a.createElement(u.Tooltip,{title:_().translate("tooltip.market_fee",{percent:q,asset:(ee||"")+X})},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-3 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"}),", ",q),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{placeholder:"0.0",id:"quoteMarketFee",defaultValue:$,value:$,addonAfter:a.createElement("span",null,a.createElement(W.A,{style:{width:100},noTip:!0,name:t.get("symbol")}))})))):a.createElement(u.Tooltip,{title:_().translate("tooltip.market_fee",{percent:q,asset:(ee||"")+X})},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-12 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"}),", ",q),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{placeholder:"0.0",id:"quoteMarketFee",defaultValue:$,value:$,addonAfter:a.createElement("span",null,a.createElement(W.A,{style:{width:100},noTip:!0,name:t.get("symbol")}))})))):null,se=E?null:a.createElement("div",{style:{visibility:"hidden"},className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-3 buy-sell-label"},a.createElement(F(),{content:"explorer.asset.summary.market_fee"})),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{placeholder:"0.0",id:"emptyPlaceholder",defaultValue:"0",addonAfter:a.createElement("span",null,a.createElement(W.A,{style:{width:100},noTip:!0,name:t.get("symbol")}))})));const ae="bid"===e;let re=ae&&te?te:!ae&&Z?Z:te||Z?se:null,ie=ae?I.getAmount({real:!0})>=parseFloat(P):I.getAmount({real:!0})>=parseFloat(w),oe=ae?_().translate("exchange.buy"):_().translate("exchange.sell"),ne=!(l||I.getAmount()>0&&ie),le=!(T>0),ce=!(w>0),de=ne||le||ce,he=b()(e,{disabled:de}),pe=ae?s.get("symbol"):t.get("symbol"),me=le?_().translate("exchange.invalid_price"):ce?_().translate("exchange.invalid_amount"):ne?_().translate("exchange.no_balance"):null;C[1]&&"1.3.0"===C[1].getIn(["options","core_exchange_rate","quote","asset_id"])&&"1.3.0"===C[1].getIn(["options","core_exchange_rate","base","asset_id"])&&(f=C[0],C.splice(1,1));let ue,ge,be=0,ye=C.map((e=>{let{name:t,prefix:s}=L.A.replaceName(e);return a.createElement(u.Select.Option,{key:e.get("id"),value:be++},s,t)}));ue=f.get("symbol")===pe?I.clone(I.getAmount()-o.getAmount()):I,ae?_().translate("walkthrough.buy_form"):_().translate("walkthrough.sell_form"),"SPECIFIC"!==this.props.expirationType&&(ge=this.props.expirations[this.props.expirationType].get());const _e=Object.keys(this.props.expirations).map((e=>a.createElement("option",{value:e,key:e},"SPECIFIC"===e&&"Specific"!==k?A()(k).format("Do MMM YYYY hh:mm A"):this.props.expirations[e].title))),fe="small-12";let Ce;Ce=E?a.createElement("div",{className:fe},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-12 buy-sell-label",content:"exchange.price"}),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{id:`${e}Price`,value:T,onChange:c,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")})," / ",a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")}))}))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-12 buy-sell-label",content:"transfer.amount"}),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{id:`${e}Amount`,value:w,onChange:r,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")}))}))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-12 buy-sell-label",content:"exchange.total"}),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{id:`${e}Total`,value:P,onChange:p,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")}))}))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-12 buy-sell-label",content:"transfer.fee"}),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{id:`${e}Fee`,placeholder:"0.0",defaultValue:S?o.getAmount({real:!0}):_().translate("transfer.errors.insufficient"),disabled:!0,addonAfter:a.createElement(u.Select,{style:{width:100},disabled:1===C.length,defaultValue:C.indexOf(this.props.feeAsset),onChange:this.props.onChangeFeeAsset},ye)}))),re):N?a.createElement("div",{className:fe},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"exchange.price"}),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{id:`${e}Price`,value:T,onChange:c,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")})," / ",a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")}))}))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"transfer.amount"}),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{id:`${e}Amount`,value:w,onChange:r,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")}))}))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"exchange.total"}),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{id:`${e}Total`,value:P,onChange:p,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")}))}))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"transfer.fee"}),a.createElement("div",{className:"inputAddon small-9"},a.createElement(U.A,{id:`${e}Fee`,placeholder:"0.0",value:S?o.getAmount({real:!0}):_().translate("transfer.errors.insufficient"),disabled:!0,addonAfter:a.createElement(u.Select,{style:{width:100},disabled:1===C.length,defaultValue:C.indexOf(this.props.feeAsset),onChange:this.props.onChangeFeeAsset},ye)}))),re):a.createElement("div",{className:fe},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("div",{className:"small-11 grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"exchange.price"}),a.createElement("div",{className:"small-9 buy-sell-label",style:{textAlign:"right"}},a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.props.setPrice.bind(this,e,y.sellPrice())},a.createElement(V,{price:g,quote:t,base:s})," "))),a.createElement("div",{className:"inputAddon small-11"},a.createElement(U.A,{id:`${e}Price`,value:T,onChange:c,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")})," / ",a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")}))}))),a.createElement("div",{className:"small-6"},a.createElement("div",{className:"small-12 grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"exchange.total"}),a.createElement("div",{className:"small-9 buy-sell-label",style:{textAlign:"right"}},a.createElement(F(),{className:"small-3 buy-sell-label",content:"exchange.balance"})," ",a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._addBalance.bind(this,ue)},L.A.format_number(I.getAmount({real:!0}),m)," "))),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{id:`${e}Total`,value:P,onChange:p,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")}))})))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"transfer.amount"}),a.createElement("div",{className:"inputAddon small-11"},a.createElement(U.A,{id:`${e}Amount`,value:w,onChange:r,autoComplete:"off",placeholder:"0.0",addonAfter:a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")}))}))),a.createElement("div",{className:"small-6"},a.createElement(F(),{className:"small-3 buy-sell-label",content:"transfer.fee"}),a.createElement("div",{className:"inputAddon small-12"},a.createElement(U.A,{id:`${e}Fee`,placeholder:"0.0",defaultValue:S?o.getAmount({real:!0}):_().translate("transfer.errors.insufficient"),disabled:!0,addonAfter:a.createElement(u.Select,{style:{width:100},disabled:1===C.length,defaultValue:C.indexOf(this.props.feeAsset),onChange:this.props.onChangeFeeAsset},ye)})))));const Se=ae?s:t,Ae=!!Se.get("bitasset")&&Se.get("bitasset").get("settlement_fund")>0;return i.A.getState().currentAccount,a.createElement("div",{className:b()(this.props.className),style:this.props.styles},a.createElement("div",{className:"buy-sell-container",style:{paddingRight:5}},v?null:a.createElement("div",{className:"exchange-content-header exchange-content-header--buy-sell-form "+e},a.createElement("span",null,a.createElement(R.A,{string:"exchange.buysell_formatter",noLink:!0,noTip:!0,keys:[{type:"asset",value:t.get("symbol"),arg:"asset"},{type:"translate",value:l?"exchange.short":ae?"exchange.buy":"exchange.sell",arg:"direction"}]})),this.props.onFlip&&!this.props.hideFunctionButtons?a.createElement("span",{onClick:this.props.onFlip,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇆"):null,this.props.onTogglePosition&&!this.props.hideFunctionButtons?a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):null,this.props.moveOrderForm&&!this.props.hideFunctionButtons?a.createElement(H.A,{onClick:this.props.moveOrderForm,name:"thumb-tack",className:"icon-14px icon-fill order-book-button-v",style:{marginLeft:5}}):null),a.createElement("form",{ref:"order_form",className:(this.props.isOpen?"":"hide-container ")+"order-form",style:{fontSize:"14px"},noValidate:!0},a.createElement("div",{className:"grid-block no-overflow wrap shrink"},this.props.moveOrderForm&&E?a.createElement("div",{style:{width:"100%",textAlign:"right"},onClick:this.props.moveOrderForm},a.createElement(H.A,{name:"thumb-tack",className:"icon-18px icon-fill order-book-button-v"})):null,Ce),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:N?"small-12 grid-block":"small-6"},a.createElement(F(),{className:"small-4 buy-sell-label",content:"transaction.expiration"}),a.createElement("div",{className:"small-8 expiration-datetime-picker"},a.createElement(z.A,{ref:this.getDatePickerRef,className:"expiration-datetime-picker--hidden",showTime:!0,showToday:!1,disabledDate:e=>e<A()().add(59,"minutes"),value:"Specific"!==k?k:A()().add(1,"hour"),onChange:this.props.onExpirationCustomChange}),a.createElement("select",{className:"cursor-pointer",onChange:this.onExpirationSelectChange,onClick:this.onExpirationSelectClick,onBlur:this.onExpirationSelectBlur,"data-tip":ge&&A()(ge).format("Do MMM YYYY hh:mm A"),value:this.props.expirationType},_e))),N?null:a.createElement("div",{className:"small-6"},re),a.createElement("div",{className:"small-12 medium-12 xlarge-12"},N?a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-4 buy-sell-label",content:ae?"exchange.lowest_ask":"exchange.highest_bid"}),a.createElement("div",{className:"small-8 buy-sell-label"},a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.props.setPrice.bind(this,e,y.sellPrice())},a.createElement(V,{price:g,quote:t,base:s})," ",a.createElement(W.A,{name:s.get("symbol"),noTip:!0}),"/",a.createElement(W.A,{name:t.get("symbol"),noTip:!0})))):null,N?a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement(F(),{className:"small-4 buy-sell-label",content:"exchange.balance"}),a.createElement("div",{className:"small-8 buy-sell-label"},a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._addBalance.bind(this,ue)},L.A.format_number(I.getAmount({real:!0}),m)," ",a.createElement(W.A,{name:pe,noTip:!0})))):null,a.createElement("div",{style:{marginTop:10}},a.createElement("div",null,a.createElement(u.Tooltip,{placement:"top",title:me||""},a.createElement(u.Button,{className:de?null:he,disabled:de,onClick:d.bind(this,!0),type:"primary",style:{margin:5}},ae?"Buy":"Sell")),this.props.currentBridges&&!this.props.backedCoin?a.createElement(u.Tooltip,{title:n.A.isDown("TRADE")?_().translate("external_service_provider.is_down"):_().translate("exchange.quick_deposit_bridge",{target:ae?J:X})},a.createElement(u.Button,{style:{margin:5},onClick:this.props.onBuy.bind(this),disabled:n.A.isDown("TRADE")||!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id")},a.createElement(F(),{content:"exchange.quick_deposit",asset:ae?J:X}))):null,this.props.backedCoin&&!this.props.currentBridges?a.createElement(u.Tooltip,{title:n.A.isDown("OPEN")?_().translate("external_service_provider.is_down"):_().translate("tooltip.gateway")},a.createElement(u.Button,{style:{margin:5},onClick:this.props.onDeposit.bind(this),disabled:n.A.isDown("OPEN")||!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id")},a.createElement(F(),{content:"exchange.quick_deposit",asset:ae?J:X}))):null,this.props.currentBridges&&this.props.backedCoin?a.createElement(u.Popover,{title:a.createElement(F(),{content:"exchange.quick_deposit",asset:ae?J:X}),trigger:"click",visible:this.state.isQuickDepositVisible,onVisibleChange:this.handleQuickDepositVisibleChange,content:a.createElement("div",null,a.createElement(u.Tooltip,{title:n.A.isDown("OPEN")?_().translate("external_service_provider.is_down"):_().translate("exchange.quick_deposit_gateway",{asset:ae?J:X})},a.createElement(u.Button,{style:{marginRight:5},onClick:this.onDeposit.bind(this),disabled:n.A.isDown("OPEN")},a.createElement(F(),{content:"exchange.quick_deposit_gateway_button"}))),a.createElement(u.Tooltip,{title:n.A.isDown("TRADE")?_().translate("external_service_provider.is_down"):_().translate("exchange.quick_deposit_bridge",{target:ae?J:X})},a.createElement(u.Button,{onClick:this.onBuy.bind(this),disabled:n.A.isDown("TRADE")},a.createElement(F(),{content:"exchange.quick_deposit_bridge_button"}))))},a.createElement(u.Tooltip,{title:_().translate("exchange.quick_deposit_tooltip",{asset:ae?J:X})},a.createElement(u.Button,{style:{margin:5},disabled:!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id")},a.createElement(F(),{content:"exchange.quick_deposit",asset:ae?J:X})))):null,this.props.onBorrow&&!Ae?a.createElement(u.Button,{style:{margin:5},disabled:!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id"),onClick:this.props.onBorrow},a.createElement(F(),{content:"exchange.borrow"})):null,Ae?a.createElement(u.Button,{style:{margin:5},disabled:!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id"),onClick:this.showSettleModal,"data-tip":_().translate("exchange.settle_globally_settled_tooltip")},a.createElement(F(),{content:"exchange.settle_globally_settled"})):null)))),a.createElement("div",null,a.createElement("div",{className:"grid-content clear-fix no-padding"},me&&l?a.createElement(u.Tooltip,{title:me,placement:"right"},a.createElement("div",{style:{paddingRight:10},className:"float-right"},a.createElement("input",{style:{margin:0},className:he,type:"submit",onClick:d.bind(this,!1),value:oe}))):l?a.createElement(u.Tooltip,{title:"",placement:"right"},a.createElement("div",{style:{paddingRight:10},className:"float-right"},a.createElement("input",{style:{margin:0},className:he,type:"submit",onClick:d.bind(this,!1),value:oe}))):null)))),Ae&&!!this.props.currentAccount&&a.createElement(j.A,{visible:this.state.isSettleModalVisible,hideModal:this.hideSettleModal,showModal:this.showSettleModal,asset:Se.get("id"),account:this.props.currentAccount}))}}const K=(0,D.A)(G);var Q=s(24923),J=s(58336);const Y={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Z={integer:e=>Z.number(e)&&parseInt(e,10)===Number(e),float:e=>Z.number(e)&&!Z.integer(e),array:e=>Array.isArray(e),regexp(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(e){return!1}},date:e=>"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear,number:e=>!isNaN(e)&&!isNaN(Number(e))&&"number"==typeof Number(e),object:e=>"object"==typeof e&&!Z.array(e),method:e=>"function"==typeof e,email:e=>"string"==typeof e&&!!e.match(Y.email)&&e.length<255,url:e=>"string"==typeof e&&!!e.match(Y.url),hex:e=>"string"==typeof e&&!!e.match(Y.hex),string:e=>"string"==typeof e,boolean:e=>"boolean"==typeof e,enum:(e,t)=>Array.isArray(t)&&t.indexOf(e)>=-1},X=Z,ee=(e="")=>e?_().translate("validation.messages.requiredNamed",{name:e}):_().translate("validation.messages.required"),te=(e="",t="")=>t?_().translate(`validation.messages.types.${e}Named`,{name:t,type:e}):_().translate(`validation.messages.types.${e}`,{type:e}),se=(e,t,s)=>s?_().translate("validation.messages.rangeNamed",{name:s,min:e,max:t}):_().translate("validation.messages.range",{min:e,max:t}),ae=(e,t)=>t?_().translate("validation.messages.minNamed",{name:t,min:e}):_().translate("validation.messages.min",{min:e}),re=(e,t)=>t?_().translate("validation.messages.maxNamed",{name:t,max:e}):_().translate("validation.messages.max",{max:e}),ie=e=>e?_().translate("validation.messages.numberNamed",{name:e}):_().translate("validation.messages.number"),oe=e=>e?_().translate("validation.messages.integerNamed",{name:e}):_().translate("validation.messages.integer"),ne=e=>e?_().translate("validation.messages.floatNamed",{name:e}):_().translate("validation.messages.float"),le=e=>e?_().translate("validation.messages.emailNamed",{name:e}):_().translate("validation.messages.email"),ce=e=>e?_().translate("validation.messages.urlNamed",{name:e}):_().translate("validation.messages.url"),de=(e,t)=>e?_().translate("validation.messages.oneOfNamed",{name:e,list:t}):_().translate("validation.messages.oneOf",{list:t}),he={required:function(e={}){let t="";return t="string"==typeof e?e:e&&e.name,{required:!0,message:ee(t)}},type:function(e){let t="",s="";if("string"==typeof e&&(t=e),e&&e.type&&(t=e.type),e&&e.name&&(s=e.name),""===t)throw new Error("[Validation] Rules.Type the property type is missed");if(!X[t])throw new Error(`[Validation] Rules.Type the property type '${e&&e.type}' is not listed in supported types`);return{validator:(e,s,a)=>X[t](s)?a():a(!1),message:te(t,s)}},range:function(e={}){let t=Number(e.max),s=Number(e.min);if(void 0===t||isNaN(t))throw new Error(`[Validation] Rules.Range the property max '${e&&e.max}' is incorrect. Should be a number`);if(void 0===s||isNaN(s))throw new Error(`[Validation] Rules.Range the property min '${e&&e.min}' is incorrect. Should be a number`);if(t<s)throw new Error(`[Validation] Rules.Range the property min '${e&&e.min}' cannot be higher than max '${e&&e.max}'`);return{validator:(e,a,r)=>(a=Number(a),isNaN(a)||a<s||a>t?r(!1):r()),message:se(s,t,e.name||"")}},min:function(e){let t;if(t=Number("object"==typeof e?e&&e.min:e),void 0===t||isNaN(t))throw new Error(`[Validation] Rules.Min the property min '${e&&e.min}' is incorrect. Should be a number`);return{validator:(s,a,r)=>{if(a=Number(a),e&&e.higherThan){if(isNaN(a)||a<=t)return r(!1)}else if(isNaN(a)||a<t)return r(!1);return r()},message:ae(t,e.name||"")}},max:function(e){let t;if(t=Number("object"==typeof e?e&&e.max:e),void 0===t||isNaN(t))throw new Error(`[Validation] Rules.Min the property max '${e&&e.max}' is incorrect. Should be a number`);return{validator:(e,s,a)=>(s=Number(s),isNaN(s)||s>t?a(!1):a()),message:re(t,e.name||"")}},number:function(e){return{validator:(e,t,s)=>X.number(t)?s():s(!1),message:ie(e||"")}},integer:function(e){return{validator:(e,t,s)=>X.integer(t)?s():s(!1),message:oe(e||"")}},float:function(e){return{validator:(e,t,s)=>X.float(t)?s():s(!1),message:ne(e||"")}},email:function(e){return{validator:(e,t,s)=>X.email(t)?s():s(!1),message:le(e||"")}},url:function(e){return{validator:(e,t,s)=>X.url(t)?s():s(!1),message:ce(e||"")}},oneOf:function(e={}){let t;if(!Array.isArray(e&&e.list))throw new Error("[Validation] Rules.oneOf the property list is missed or incorrect");return t=e.list,{validator:(e,s,a)=>-1===t.indexOf(s)?a(!1):a(),message:de(e&&e.name||"",t.toString().replace(/,([a-z])/g,", $1"))}},balance:function(e={}){return{validator:he.range({min:0,max:e.balance}).validator,message:(t=e.balance,s=e.symbol,_().translate("validation.messages.balance",{balance:t,symbol:s}))};var t,s}},pe={Rules:he},me=e=>(t,s,a=6)=>+e(t,s).toFixed(a),ue=(e,t)=>e+t,ge=(e,t)=>e-t,be=(e,t)=>e*t,ye=(e,t)=>e/t,_e=(e,t,s)=>me(ue)(e,t,s),fe=(e,t,s)=>me(ge)(e,t,s),Ce=(e,t,s)=>me(be)(e,t,s),Se=(e,t,s)=>me(ye)(e,t,s);function Ae(){return Ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ae.apply(this,arguments)}class ve extends a.Component{constructor(e){super(e),this.state={orderCount:1,feeAssets:[]},this.handleClickBalance=this.handleClickBalance.bind(this),this.handleCurrentPriceClick=this.handleCurrentPriceClick.bind(this)}componentDidMount(){this._checkFeeAssets()}componentDidUpdate(){const e=Number(this._getFormValues().orderCount||1),t=Number(this.state.orderCount);isNaN(t)||isNaN(e)||Number(this.state.orderCount)===e||this.setState({orderCount:e},(()=>{this._checkFeeAssets()}))}isFormValid(){const e=this._getFormValues();return!(!e||!e.priceLower||isNaN(Number(e.priceLower))||Number(e.priceLower)<=0||!e.amount||isNaN(Number(e.amount))||Number(e.amount)<=0||!e.priceUpper||isNaN(Number(e.priceUpper))||Number(e.priceUpper)<=0||Number(e.priceUpper)<=Number(e.priceLower)||!e.orderCount||isNaN(Number(e.orderCount))||Number(e.orderCount)<=1)}_getBaseAssetFlags(){return x.A.getFlagBooleans(this.props.baseAsset.getIn(["options","flags"]),this.props.baseAsset.has("bitasset_data_id"))}_getQuoteAssetFlags(){return x.A.getFlagBooleans(this.props.quoteAsset.getIn(["options","flags"]),this.props.quoteAsset.has("bitasset_data_id"))}_isMarketFeeVisible(){const e=this._getBaseAssetFlags(),t=this._getQuoteAssetFlags();return!(this._getFormValues().action!==Q.x6.SELL||!e.charge_market_fee)||!(this._getFormValues().action!==Q.x6.BUY||!t.charge_market_fee)}_getFormValues(){return this.props.form.getFieldsValue()}_filterFeeStatuses(e){return e.filter((e=>e&&e.hasPoolBalance&&e.hasBalance)).map((e=>({fee:e,amount:e.fee.getAmount()/Math.pow(10,e.fee.precision),asset:J.A.getAsset(e.fee.asset_id)})))}_checkFeeAssets(){this._getAccountAssetsFeeStatus().then((e=>{let t=this._filterFeeStatuses(e);this.setState({feeAssets:t})}))}_getAccountAssetsFeeStatus(){const{currentAccount:e}=this.props,{orderCount:t}=this._getFormValues();return!!(e&&e.get&&e.get("balances"))&&new Promise((s=>{let a=[];e.get("balances").forEach((s=>{let r=J.A.getObject(s),i=(0,I.hQ)({accountID:e.get("id"),feeID:r.get("asset_type"),type:"limit_order_create",operationsCount:t});a.push(i)})),Promise.all(a).then((e=>{s(e)}))}))}_getFee(){const e=this._getFormValues();let t=0;return e&&e.feeCurrency&&this.state.feeAssets.forEach((s=>{s&&s.asset&&s.asset.get("symbol")===e.feeCurrency&&(t=s.amount)})),t}_getMarketFee(){const e=this._getFormValues(),t=this.props.baseAsset,s=this.props.quoteAsset,a=Number(this._getTotal()),r=e.action;if(isNaN(a))return null;let i=null;if(r===Q.x6.SELL&&(i=t),r===Q.x6.BUY&&(i=s),!i||!i.get||!i.getIn)return null;const o=new O.Vd({amount:i.getIn(["options","max_market_fee"]),asset_id:i.get("asset_id"),precision:i.get("precision")}),n=this._getMarketFeePercentage();return a?Math.min(o.getAmount({real:!0}),a/100*n).toFixed(o.precision):0}_getMarketFeePercentage(){const{action:e}=this._getFormValues(),t=this.props.baseAsset,s=this.props.quoteAsset;let a=null;return e===Q.x6.SELL&&(a=t),e===Q.x6.BUY&&(a=s),Number(a.getIn(["options","market_fee_percent"])/100)}_getTotal(){const e=this._getFormValues(),t=Number(e.amount),s=Number(e.priceLower),a=Number(e.priceUpper),r=Number(e.orderCount),i=e=>!isNaN(e);if(!i(s)||!i(a)||!i(t)||!i(r)||r<=1||r<=0||s>=a)return 0;const o=Se(fe(a,s),fe(r,1)),n=Se(t,r);let l=0;for(let e=0;e<r;e+=1)l=_e(l,Ce(n,_e(s,Ce(o,e))));return l}_getQuantityFromTotal(e){const t=this._getFormValues(),s=Number(t.priceLower),a=Number(t.priceUpper),r=Number(t.orderCount),i=e=>!isNaN(e);if(!i(s)||!i(a)||!i(e)||!i(r)||r<=0||s>=a)return 0;const o=Se(fe(a,s),fe(r,1));let n=0;for(let e=0;e<r;e+=1)n=_e(n,Number(Se(_e(s,Ce(o,e)),r)));return Se(e,n)}_getPreviewDataSource(){const e=this._getFormValues(),t=[],s=e.action,a=Number(e.amount),r=Number(e.priceLower),i=Number(e.priceUpper),o=Number(e.orderCount),n=e=>!isNaN(e);if(!n(r)||!n(i)||!n(a)||!n(o)||o<=0||r>=i)return[];const l=((i-r)/(o-1)).toFixed(6),c=a/o;for(let e=0;e<o;e+=1)t.push({quote:c.toFixed(6),base:(c*(r+l*e)).toFixed(6),price:(r+l*e).toFixed(6)});return s===Q.x6.BUY?t.reverse():t}getDatePickerRef=e=>{this.datePricker=e};handleClickBalance(){"bid"===this.props.type?this.props.form.setFieldsValue({amount:this._getQuantityFromTotal(this.props.baseAssetBalance)}):this.props.form.setFieldsValue({amount:this.props.quoteAssetBalance})}handleCurrentPriceClick(){this.props.form.setFieldsValue({priceLower:this.props.currentPrice})}onExpirationSelectChange=e=>{"SPECIFIC"===e.target.value?this.datePricker.picker.handleOpenChange(!0):this.datePricker.picker.handleOpenChange(!1),this.props.onExpirationTypeChange(e)};onExpirationSelectClick=e=>{"SPECIFIC"===e.target.value&&(this.firstClick&&(this.secondClick=!0),this.firstClick=!0,this.secondClick&&(this.datePricker.picker.handleOpenChange(!0),this.firstClick=!1,this.secondClick=!1))};onExpirationSelectBlur=()=>{this.firstClick=!1,this.secondClick=!1};render(){const{type:e,quoteAsset:t,baseAsset:s,expirationCustomTime:r}=this.props,i="bid"===e,o=t,n=s,{getFieldDecorator:l}=this.props.form,c=i?a.createElement(W.A,{name:this.props.quoteAsset.get("symbol")}):a.createElement(W.A,{name:this.props.baseAsset.get("symbol")}),d=a.createElement(W.A,{name:this.props.quoteAsset.get("symbol")}),h=a.createElement(W.A,{name:this.props.baseAsset.get("symbol")}),p=a.createElement("span",null,a.createElement(W.A,{dataPlace:"right",name:s.get("symbol")})," / ",a.createElement(W.A,{dataPlace:"right",name:t.get("symbol")})),m={labelCol:{span:6},wrapperCol:{span:16,offset:2}},g=(l("action",{initialValue:i?Q.x6.BUY:Q.x6.SELL})(a.createElement(u.Radio.Group,null,a.createElement(u.Radio,{value:Q.x6.BUY},_().translate("scaled_orders.action.buy")),a.createElement(u.Radio,{value:Q.x6.SELL},_().translate("scaled_orders.action.sell")))),l("priceLower",{validateFirst:!0,validateTrigger:"onBlur",rules:[pe.Rules.required(),pe.Rules.number(),pe.Rules.min({min:0,name:"Price",higherThan:!0})]})(a.createElement(u.Input,{placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:p}))),b=this._getFormValues(),y=Number(b&&b.priceLower||0),f=l("priceUpper",{validateFirst:!0,validateTrigger:"onBlur",rules:[pe.Rules.required(),pe.Rules.number(),pe.Rules.min({min:y,name:"Price",higherThan:!0})]})(a.createElement(u.Input,{placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:p})),C=l("feeCurrency",{initialValue:J.A.getAsset("1.3.0")&&J.A.getAsset("1.3.0").get&&J.A.getAsset("1.3.0").get("symbol")})(a.createElement(u.Select,{showSearch:!0,dropdownMatchSelectWidth:!1,style:{minWidth:"80px",maxWidth:"120px"}},this.state.feeAssets&&this.state.feeAssets.map&&this.state.feeAssets.map((e=>a.createElement(u.Select.Option,{key:e.asset.get("symbol"),value:`${e.asset.get("symbol")}`},a.createElement(W.A,{name:e.asset.get("symbol"),noTip:!0})))))),S=a.createElement(u.Input,{disabled:!0,placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:C,value:this._getFee()}),v=a.createElement(u.Input,{disabled:!0,style:{width:"100%"},autoComplete:"off",addonAfter:c,value:this._getMarketFee()}),E=a.createElement(u.Input,{disabled:!0,style:{width:"100%"},autoComplete:"off",addonAfter:h,value:this._getTotal()}),k=pe.Rules.balance({balance:this.props.baseAssetBalance,symbol:this.props.baseAsset.get("symbol")}),w=k.validator(null,this._getTotal(),(e=>void 0===e)),T=i&&!w?k.message:null,P=i&&!w?"error":"",x=[pe.Rules.required(),pe.Rules.number(),pe.Rules.min({min:0,higherThan:!0,name:"Quantity"})];i||x.push(pe.Rules.balance({balance:this.props.quoteAssetBalance,symbol:this.props.quoteAsset.get("symbol")}));const N=l("amount",{validateFirst:!0,validateTrigger:"onBlur",rules:x})(a.createElement(u.Input,{placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:d})),O=l("orderCount",{validateFirst:!0,rules:[pe.Rules.required(),pe.Rules.number(),pe.Rules.min({min:1,name:"Orders Count",higherThan:!0})]})(a.createElement(u.Input,{style:{width:"100%"},placeholder:"0",autoComplete:"off",addonAfter:_().translate("scaled_orders.order_s")})),I=_().translate(i?"exchange.lowest_ask":"exchange.highest_bid");let L;"SPECIFIC"!==this.props.expirationType&&(L=this.props.expirations[this.props.expirationType].get());const B=Object.keys(this.props.expirations).map((e=>a.createElement("option",{value:e,key:e},"SPECIFIC"===e&&"Specific"!==r?A()(r).format("Do MMM YYYY hh:mm A"):this.props.expirations[e].title)));return a.createElement("div",{className:"buy-sell-container",style:{padding:"5px"}},a.createElement(u.Form,{className:"order-form",layout:"horizontal",hideRequiredMark:!0,style:{padding:"8px 15px"}},a.createElement(u.Form.Item,Ae({},m,{label:_().translate("scaled_orders.price_lower")}),g),a.createElement(u.Form.Item,Ae({},m,{label:_().translate("scaled_orders.price_upper")}),f),a.createElement(u.Form.Item,Ae({},m,{label:_().translate("scaled_orders.quantity")}),N),a.createElement(u.Form.Item,Ae({},m,{label:_().translate("scaled_orders.order_count")}),O),a.createElement(u.Form.Item,Ae({},m,{help:T,validateStatus:P,label:_().translate("scaled_orders.total")}),E),a.createElement(u.Form.Item,Ae({},m,{label:_().translate("scaled_orders.fee")}),S),this._isMarketFeeVisible()?a.createElement(u.Form.Item,Ae({},m,{label:`${_().translate("scaled_orders.market_fee")} ${this._getMarketFeePercentage()}%`}),v):null,a.createElement(u.Form.Item,Ae({label:_().translate("transaction.expiration")},m),a.createElement("div",{className:"expiration-datetime-picker scaled-orders",style:{marginTop:"5px"}},a.createElement(z.A,{ref:this.getDatePickerRef,className:"expiration-datetime-picker--hidden",showTime:!0,showToday:!1,disabledDate:e=>e<A()().add(59,"minutes"),value:"Specific"!==r?r:A()().add(1,"hour"),onChange:this.props.onExpirationCustomChange}),a.createElement("select",{className:"cursor-pointer",style:{marginTop:"5px"},onChange:this.onExpirationSelectChange,onClick:this.onExpirationSelectClick,onBlur:this.onExpirationSelectBlur,"data-tip":L&&A()(L).format("Do MMM YYYY hh:mm A"),value:this.props.expirationType},B))),a.createElement(u.Form.Item,Ae({label:I},m),a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.handleCurrentPriceClick},a.createElement(V,{price:this.props.currentPrice,quote:o,base:n})," ",a.createElement(W.A,{name:n.get("symbol"),noTip:!0}),"/",a.createElement(W.A,{name:o.get("symbol"),noTip:!0}))),a.createElement(u.Form.Item,Ae({label:_().translate("exchange.balance")},m),a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.handleClickBalance},i?this.props.baseAssetBalance:this.props.quoteAssetBalance," ",a.createElement(W.A,{name:i?n.get("symbol"):o.get("symbol"),noTip:!0}))),a.createElement(u.Button,{onClick:this.props.handleSubmit,type:"primary",disabled:!this.isFormValid()},_().translate(i?"scaled_orders.action.buy":"scaled_orders.action.sell"))))}}ve=u.Form.create({})(ve);class Ee extends a.Component{constructor(e){super(e),this.saveFormRef=this.saveFormRef.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}componentDidUpdate(e){this.props.baseAsset&&e.baseAsset&&this.props.baseAsset.get&&e.baseAsset.get&&this.props.baseAsset.get("id")!==e.baseAsset.get("id")&&this.formRef&&this.formRef.props&&this.formRef.props.form&&this.formRef.props.form.resetFields(),this.props.lastClickedPrice&&this.props.lastClickedPrice!==e.lastClickedPrice&&this.formRef&&this.formRef.props&&this.formRef.props.form&&this.formRef.props.form.setFieldsValue&&this.formRef.props.form.setFieldsValue({priceLower:Number(this.props.lastClickedPrice)})}prepareOrders(e){const t=[],s=Number(e.amount),a=Number(e.priceLower),r=Number(e.priceUpper),i=Number(e.orderCount);let o=null;this.props.expirationType,o=this.props.expirations[this.props.expirationType].get(this.props.type);const n=e=>!isNaN(e);if(!n(a)||!n(r)||!n(s)||!n(i)||i<=0||a>=r)return[];const l=((r-a)/(i-1)).toPrecision(5),c=s/i,d=e.action===Q.x6.SELL?this.props.quoteAsset:this.props.baseAsset,h=e.action===Q.x6.BUY?this.props.quoteAsset:this.props.baseAsset,p=t=>{let s=c*(a+l*t);return e.action===Q.x6.BUY?Number(s.toPrecision(5))*Math.pow(10,d.get("precision")):Number(c.toPrecision(5))*Math.pow(10,d.get("precision"))},m=t=>{let s=c*(a+l*t);return e.action===Q.x6.SELL?Number(s.toPrecision(5))*Math.pow(10,h.get("precision")):Number(c.toPrecision(5))*Math.pow(10,h.get("precision"))};for(let e=0;e<i;e+=1)t.push({for_sale:new O.Vd({asset_id:d.get("id"),precision:d.get("precision"),amount:p(e)}),to_receive:new O.Vd({asset_id:h.get("id"),precision:h.get("precision"),amount:m(e)}),expirationTime:o});this.props.createScaledOrder(t,J.A.getAsset(e.feeCurrency).get("id"))}handleSubmit(){this.formRef.props.form.validateFields(((e,t)=>{e||this.prepareOrders(t)}))}handleCancel(){this.props.hideModal()}saveFormRef(e){this.formRef=e}_getBalanceByAssetId(e,t){let s=0,a=this.props.currentAccount.get("balances");return void 0!==a.get(e)&&(s=J.A.getObject(a.get(e)).get("balance")/Math.pow(10,t)),s}render(){let e=this._getBalanceByAssetId(this.props.baseAsset.get("id"),this.props.baseAsset.get("precision")),t=this._getBalanceByAssetId(this.props.quoteAsset.get("id"),this.props.quoteAsset.get("precision"));return a.createElement(ve,Ae({},this.props,{wrappedComponentRef:this.saveFormRef,baseAssetBalance:e,quoteAssetBalance:t,handleSubmit:this.handleSubmit}))}}const ke=Ee;var we=s(54625);class Te extends a.Component{constructor(){super(),this.state={change:null,curMarket:null,marketChange:!1}}shouldComponentUpdate(e){return!!(e.volume2&&e.volume2!==this.props.volume2||e.base!==this.props.base)||e.price!==this.props.price||e.ready!==this.props.ready}UNSAFE_componentWillReceiveProps(e){let t={change:0},{market:s}=e,a=this.state.curMarket!==s,r=null!=this.state.curMarket&&a;t.marketChange=r,t.curMarket=s,t.prevAsset=this.state.marketAsset,e.ready&&this.props.ready&&(t.change=parseFloat(e.price)-parseFloat(this.props.price)),this.setState(t)}componentDidUpdate(){$.A.rebuild()}render(){let{base:e,quote:t,price:s,content:r,ready:i,volume:o,toolTip:n,ignoreColorChange:l}=this.props,{change:c,marketChange:d}=this.state,h=null;!d&&c&&null!==c&&!0!==l&&(h=c>0?"pulsate green":"pulsate red");let p=o?L.A.format_volume(s):L.A.price_text(s,t,e);return a.createElement("li",{className:b()("stressed-stat",this.props.className,h),onClick:this.props.onClick},a.createElement(u.Tooltip,{placement:"bottom",title:n},a.createElement("span",null,a.createElement("span",{className:"value stat-primary"},i?p:0," "),a.createElement("span",{className:"symbol-text"},a.createElement(W.A,{name:e.get("symbol")}))),r?a.createElement("div",{className:"stat-text"},a.createElement(F(),{content:r})):null))}}function Pe(){return Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Pe.apply(this,arguments)}class xe extends a.Component{static propTypes={debtAsset:M.A.ChainAsset.isRequired,collateralAsset:M.A.ChainAsset.isRequired};_getFeedPrice(){return this.props?1/L.A.get_asset_price(x.A.extractRawFeedPrice(this.props.debtAsset).getIn(["quote","amount"]),this.props.collateralAsset,x.A.extractRawFeedPrice(this.props.debtAsset).getIn(["base","amount"]),this.props.debtAsset):1}_getCollateralRatio(){const e=this.props.object.toJS();return L.A.get_asset_amount(e.collateral,this.props.collateralAsset)/(L.A.get_asset_amount(e.debt,this.props.debtAsset)/this._getFeedPrice())}_getMR(){return this.props.debtAsset.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3}_getStatusClass(){let e=this._getCollateralRatio();const t=this._getMR();return isNaN(e)?null:e<t?"danger":e<t+.5?"warning":""}_getCRTip(){const e=this._getStatusClass(),t=this._getMR();return e&&""!==e?"danger"===e?_().translate("tooltip.cr_danger",{mr:t}):"warning"===e?_().translate("tooltip.cr_warning",{mr:t}):null:null}render(){let{object:e}=this.props;const t=e.toJS(),s=this._getCollateralRatio(),r=(L.A.get_asset_amount(t.debt,this.props.debtAsset),this._getStatusClass());return a.createElement(u.Tooltip,{placement:"bottom",title:this._getCRTip()},a.createElement("li",{className:b()("stressed-stat",this.props.className),onClick:this.props.onClick},a.createElement("span",null,a.createElement("span",{className:b()("value stat-primary",r)},L.A.format_number(s,2))),a.createElement("div",{className:"stat-text"},a.createElement(F(),{content:"header.collateral_ratio"}))))}}xe=(0,D.A)(xe);class Ne extends a.Component{static propTypes={object:M.A.ChainObject.isRequired};render(){let{object:e,account:t}=this.props,s=e.getIn(["call_price","quote","asset_id"]),r=e.getIn(["call_price","base","asset_id"]);return a.createElement(xe,Pe({debtAsset:s,collateralAsset:r,account:t},this.props))}}const Oe=Ne=(0,D.A)(Ne);class Ie extends a.Component{constructor(e){super(),this.state={isModalVisible:!1,volumeShowQuote:!0,selectedMarketPickerAsset:e.selectedMarketPickerAsset}}UNSAFE_componentWillReceiveProps(e){this.setState({selectedMarketPickerAsset:e.selectedMarketPickerAsset})}shouldComponentUpdate(e){return!!e.marketReady}_addMarket(e,t){let s=`${e}_${t}`;this.props.starredMarkets.has(s)?T.A.removeStarMarket(e,t):T.A.addStarMarket(e,t)}changeVolumeBase(){this.setState({volumeShowQuote:!this.state.volumeShowQuote})}marketPicker(e){let{selectedMarketPickerAsset:t}=this.state;t=t&&t==e?null:e,this.setState({selectedMarketPickerAsset:t}),this.props.onToggleMarketPicker(t)}render(){const{quoteAsset:e,baseAsset:t,starredMarkets:r,hasPrediction:i,feedPrice:o,showCallLimit:n,lowestCallPrice:l,marketReady:c,latestPrice:d,marketStats:h,account:p}=this.props,g=t.get("symbol"),b=e.get("symbol"),y=`${b}_${g}`,f=r.has(y)?"gold-star":"grey-star",C=h.get("change"),S=0===parseFloat(C)||isNaN(C)?"":parseFloat(C)<0?"negative":"positive",A=h.get("volumeBase"),v=h.get("volumeQuote"),E=isNaN(C)?void 0:C>0?"+"+C:C,k=this.state.volumeShowQuote?v:A,w=this.state.volumeShowQuote?e:t;let T=!1;const x=e.get("id"),N=t.get("id"),I="1.3.0"===x?N:"1.3.0"===N?x:null,L=I?m.ChainStore.getAsset(I):null;let B="",R=null,M="exchange.settle",D="tooltip.settle_price";if(L&&L.get("bitasset")){if(p.toJS&&p.has("call_orders")){const e=p.get("call_orders").toJS();for(let t=0;t<e.length;t++){let s=e[t];if(m.ChainStore.getObject(s).getIn(["call_price","quote","asset_id"])===I){B=s,T=!0;break}}}let s="1.3.0"==N?e:"1.3.0"==x?t:e;if(L.get("bitasset").get("settlement_fund")>0)M="exchange.global_settle",D="tooltip.global_settle_price",R=L.get("bitasset").get("settlement_price").toJS(),R.base.asset_id==t.get("id")?(R.base.precision=t.get("precision"),R.quote.precision=e.get("precision")):(R.quote.precision=t.get("precision"),R.base.precision=e.get("precision")),R=new O.gm({quote:new O.Vd({asset_id:R.quote.asset_id,precision:R.quote.precision,amount:R.quote.amount}),base:new O.Vd({asset_id:R.base.asset_id,precision:R.base.precision,amount:R.base.amount})}).toReal(),R="1.3.0"==N?1/R:R;else if(s&&o){let e=s.getIn(["bitasset","options"]).toJS().force_settlement_offset_percent;R="1.3.0"==N?o.toReal()/(1+e/1e4):o.toReal()*(1+e/1e4)}}const q=s(10658);let V=!!this.state.selectedMarketPickerAsset&&this.state.selectedMarketPickerAsset==b,U=!!this.state.selectedMarketPickerAsset&&this.state.selectedMarketPickerAsset==g,z=this.props.hasAnyPriceAlert?"exchange--price-alert--show-modal--active":"";return a.createElement("div",{className:"grid-block shrink no-padding overflow-visible top-bar"},a.createElement("div",{className:"grid-block overflow-visible"},a.createElement("div",{className:"grid-block shrink"},a.createElement("div",{style:{padding:"10px"}},i?a.createElement("a",{className:"market-symbol"},a.createElement("span",null,`${b} : ${g}`)):a.createElement("div",{style:{padding:"0 5px",fontSize:this.props.tinyScreen?"13px":"18px",marginTop:"1px"}},a.createElement(u.Icon,{onClick:this.props.showPriceAlertModal,type:"bell",className:`exchange--price-alert--show-modal ${z}`,"data-intro":q.translate("walkthrough.price_alerts")}),a.createElement("span",{onClick:this.marketPicker.bind(this,b),className:"underline",style:{cursor:"pointer",color:V?"#2196f3":""}},a.createElement(W.A,{name:b,replace:!0,noTip:!0})),a.createElement("span",{style:{padding:"0 5px"}},"/"),a.createElement("span",{onClick:this.marketPicker.bind(this,g),className:"underline",style:{cursor:"pointer",color:U?"#2196f3":""}},a.createElement(W.A,{name:g,replace:!0,noTip:!0}))),a.createElement("div",{className:"label-actions",style:{padding:"5px 0 0 5px"}},a.createElement(F(),{component:"span",className:"stat-text",content:"exchange.trading_pair"}),a.createElement(we.N_,{onClick:()=>{P.A.switchMarket()},to:`/market/${g}_${b}`,"data-intro":q.translate("walkthrough.switch_button")},a.createElement(H.A,{className:"shuffle",name:"shuffle",title:"icons.shuffle"})),a.createElement("a",{onClick:()=>{this._addMarket(this.props.quoteAsset.get("symbol"),this.props.baseAsset.get("symbol"))},"data-intro":q.translate("walkthrough.favourite_button")},a.createElement(H.A,{className:f,name:"fi-star",title:"icons.fi_star.market"}))))),a.createElement("div",{className:"grid-block vertical",style:{overflow:"visible"}},a.createElement("div",{className:"grid-block wrap market-stats-container"},a.createElement("ul",{className:"market-stats stats top-stats"},d?a.createElement(Te,{ignoreColorChange:!0,ready:c,price:d,quote:e,base:t,market:y,content:"exchange.latest"}):null,a.createElement("li",{className:"hide-order-1 stressed-stat daily_change "+S},a.createElement("span",null,a.createElement("b",{className:"value"},E?c?E:0:"-"),E&&a.createElement("span",null," %")),a.createElement(F(),{component:"div",className:"stat-text",content:"account.hour_24"})),A>=0?a.createElement(Te,{ignoreColorChange:!0,onClick:this.changeVolumeBase.bind(this),ready:c,decimals:0,volume:!0,price:k,className:"hide-order-2 clickable",base:w,market:y,content:"exchange.volume_24"}):null,!i&&o?a.createElement(Te,{ignoreColorChange:!0,toolTip:_().translate("tooltip.feed_price"),ready:c,className:"hide-order-3",price:o.toReal(),quote:e,base:t,market:y,content:"exchange.feed_price"}):null,!i&&R?a.createElement(Te,{ignoreColorChange:!0,toolTip:_().translate(D),ready:c,className:"hide-order-4",price:R,quote:e,base:t,market:y,content:M}):null,T?a.createElement(Oe,{object:B,account:p,className:"hide-order-1"}):null,l&&n?a.createElement(Te,{toolTip:_().translate("tooltip.call_limit"),ready:c,className:"hide-order-5 is-call",price:l,quote:e,base:t,market:y,content:"explorer.block.call_limit"}):null,o&&n?a.createElement(Te,{toolTip:_().translate("tooltip.margin_price"),ready:c,className:"hide-order-6 is-call",price:o.getSqueezePrice({real:!0}),quote:e,base:t,market:y,content:"exchange.squeeze"}):null),a.createElement("ul",{className:"market-stats stats top-stats","data-position":"left","data-step":"1","data-intro":q.translate("walkthrough.personalize")},a.createElement("li",{className:"stressed-stat input clickable",style:{padding:"16px 16px 16px 0px"},onClick:this.props.onTogglePersonalize.bind(this)},a.createElement(u.Icon,{type:"setting",style:{paddingRight:5}}),a.createElement(F(),{className:"hide-order-2",content:"exchange.settings.header.title"})))))))}}var Le=s(2552),Be=s.n(Le),Fe=s(14830);class Re extends a.Component{render(){let{baseSymbol:e,quoteSymbol:t}=this.props;return a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{style:{textAlign:"right"}},a.createElement(F(),{content:"exchange.price"}),a.createElement("br",null),e?a.createElement("span",{className:"header-sub-title"},"(",a.createElement(W.A,{name:e}),"/",a.createElement(W.A,{name:t}),")"):null),a.createElement("th",{style:{textAlign:"right"}},a.createElement(F(),{content:"transfer.amount"}),a.createElement("br",null),t?a.createElement("span",{className:"header-sub-title"},"(",a.createElement(W.A,{name:t}),")"):null),a.createElement("th",{style:{textAlign:"right"}},a.createElement(F(),{content:"transaction.settlement_date"}),a.createElement("br",null),a.createElement("span",{style:{visibility:"hidden"},className:"header-sub-title"},"d"))))}}Re.defaultProps={quoteSymbol:null,baseSymbol:null};class Me extends a.Component{render(){let{base:e,quote:t,order:s,showSymbols:r}=this.props,i="1.3.0"==e.get("id")?s.getPrice()/(1+s.offset_percent/1e4):s.getPrice()*(1+s.offset_percent/1e4),o=r?" "+t.get("symbol"):null;return a.createElement("tr",null,a.createElement("td",{className:"text-center",style:{width:"6%"}}," "),a.createElement("td",null,L.A.format_number(i,t.get("precision"))," ",o),a.createElement("td",null,L.A.format_number(s[s.isBid()?"amountToReceive":"amountForSale"]().getAmount({real:!0}),t.get("precision"))),a.createElement("td",null,L.A.format_number(s[s.isBid()?"amountForSale":"amountToReceive"]().getAmount({real:!0}),e.get("precision"))),a.createElement("td",null,a.createElement(u.Tooltip,{title:new Date(s.settlement_date).toString()},a.createElement("div",{style:{textAlign:"right",whiteSpace:"nowrap"}},_().localize(new Date(s.settlement_date),{type:"date",format:-1!==Be()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history"})))))}}Me.defaultProps={showSymbols:!1,invert:!1};class De extends a.Component{shouldComponentUpdate(e){return e.currentAccount!==this.props.currentAccount||e.orders!==this.props.orders}render(){let{orders:e,base:t,quote:s}=this.props,r=null;const i=a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",{style:{textAlign:"center",lineHeight:4,fontStyle:"italic"},colSpan:"5"},a.createElement(F(),{content:"account.no_orders"}))));return e.size>0&&t&&s&&(r=e.sort(((e,t)=>e.isBefore(t)?-1:1)).map((e=>a.createElement(Me,{key:e.id,order:e,base:t,quote:s}))).toArray()),a.createElement(Fe.A,{ref:"contentTransition",component:"tbody",transitionName:"newrow"},r||i)}}De.defaultProps={base:{},quote:{},orders:{},quoteSymbol:"",baseSymbol:""},De.propTypes={base:w().object.isRequired,quote:w().object.isRequired,orders:w().object.isRequired,quoteSymbol:w().string.isRequired,baseSymbol:w().string.isRequired};const qe=De,Ve={textAlign:"right"};function We({baseSymbol:e,quoteSymbol:t,selected:s,onCancelToggle:r}){return a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{style:{width:"6%",textAlign:"center"}},r?a.createElement(u.Tooltip,{title:_().translate("exchange.cancel_order_select_all"),placement:"left"},a.createElement(u.Checkbox,{className:"order-cancel-toggle",checked:s,onChange:r})):null),a.createElement("th",{style:Ve},a.createElement(F(),{className:"header-sub-title",content:"exchange.price"})),a.createElement("th",{style:Ve},e?a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:t})):null),a.createElement("th",{style:Ve},e?a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:e})):null),a.createElement("th",{style:Ve},a.createElement(F(),{className:"header-sub-title",content:"transaction.expiration"}))))}function Ue({order:e,selected:t,base:s,quote:r,onCheckCancel:i}){const o=e.isBid(),n=e.isCall(),l=n?"orderHistoryCall":o?"orderHistoryBid":"orderHistoryAsk";return a.createElement("tr",{key:e.id},a.createElement("td",{className:"text-center",style:{width:"6%"}},n?null:a.createElement(u.Checkbox,{className:"orderCancel",checked:t,onChange:i})),a.createElement("td",{className:l,style:{paddingLeft:10}},a.createElement(V,{price:e.getPrice(),base:s,quote:r})),a.createElement("td",null,L.A.format_number(e[o?"amountToReceive":"amountForSale"]().getAmount({real:!0}),r.get("precision"))," "),a.createElement("td",null,L.A.format_number(e[o?"amountForSale":"amountToReceive"]().getAmount({real:!0}),s.get("precision"))," "),a.createElement("td",null,a.createElement(u.Tooltip,{title:e.expiration.toLocaleString()},a.createElement("div",{style:{textAlign:"right",whiteSpace:"nowrap"}},n?null:_().localize(new Date(e.expiration),{type:"date",format:"short_custom"})))))}We.defaultProps={quoteSymbol:null,baseSymbol:null};class ze extends a.Component{render(){let{style:e,className:t,innerClass:s,innerStyle:r,headerStyle:i,noHeader:o,isSelected:n,tinyScreen:l,activeTab:c,baseSymbol:d,quoteSymbol:h,contentContainer:p,footerContainer:m,onCancelToggle:u}=this.props;return a.createElement("div",{style:e,key:"open_orders",className:t},a.createElement("div",{className:s,style:r},o?null:a.createElement("div",{style:i,className:"exchange-content-header"},"my_orders"==c?a.createElement(F(),{content:"exchange.my_orders"}):null,"open_settlement"==c?a.createElement(F(),{content:"exchange.settle_orders"}):null),a.createElement("div",{className:"grid-block shrink left-orderbook-header market-right-padding-only"},a.createElement("table",{className:"table order-table text-right fixed-table market-right-padding"},a.createElement(We,{baseSymbol:d,quoteSymbol:h,selected:n,onCancelToggle:"my_orders"==c?u:null}))),a.createElement("div",{className:"table-container grid-block market-right-padding-only no-overflow",ref:"container",style:{overflow:"hidden",minHeight:l?260:0,maxHeight:260,lineHeight:"13px"}},a.createElement("table",{className:"table order-table table-highlight-hover table-hover no-stripes text-right fixed-table market-right-padding"},p)),m))}}var He=s(81461);class je extends a.Component{shouldComponentUpdate(e){return e.order.for_sale!==this.props.order.for_sale||e.order.id!==this.props.order.id||e.quote!==this.props.quote||e.base!==this.props.base||e.order.market_base!==this.props.order.market_base||e.selected!==this.props.selected}render(){let{base:e,quote:t,order:s,selected:r}=this.props;return a.createElement(Ue,{key:s.id,order:s,selected:r,base:e,quote:t,onCheckCancel:this.props.onCheckCancel.bind(this)})}}class $e extends a.Component{constructor(e){super(),this.state={activeTab:e.activeTab,rowCount:20,showAll:!1,selectedOrders:[]},this._getOrders=this._getOrders.bind(this)}shouldComponentUpdate(e,t){return e.baseSymbol!==this.props.baseSymbol||e.quoteSymbol!==this.props.quoteSymbol||e.className!==this.props.className||e.activeTab!==this.props.activeTab||t.activeTab!==this.state.activeTab||t.showAll!==this.state.showAll||e.currentAccount!==this.props.currentAccount||t.selectedOrders!==this.state.selectedOrders||e.settleOrders!==this.props.settleOrders}componentDidMount(){this.props.hideScrollbars||this.updateContainer(1)}componentDidUpdate(e){let{hideScrollbars:t}=this.props,{showAll:s}=this.state;e.showAll!=s&&(s&&!t?this.updateContainer(2):s||t?s&&t?this.updateContainer(1):this.updateContainer(0):this.updateContainer(3))}UNSAFE_componentWillReceiveProps(e){e.activeTab!==this.state.activeTab&&this.changeTab(e.activeTab),e.baseSymbol===this.props.baseSymbol&&e.quoteSymbol===this.props.quoteSymbol||(this.setState({showAll:!1}),this.updateContainer(0),this.props.hideScrollbars||this.updateContainer(1)),e.hideScrollbars!==this.props.hideScrollbars&&(this.updateContainer(0),e.hideScrollbars||this.updateContainer(1))}updateContainer(e=2){let t=this.refs.view.refs.container,s=this.refs.contentTransition;t&&(0==e?(t.scrollTop=0,E().destroy(t)):1==e?(E().initialize(t),this.updateContainer(3)):2==e?E().update(t):3==e&&(t.scrollTop=0,E().update(t)),s&&s.resetAnimation())}_onSetShowAll(){this.setState({showAll:!this.state.showAll})}changeTab(e){T.A.changeViewSetting({ordersTab:e}),this.setState({activeTab:e}),this.updateContainer(3),setTimeout($.A.rebuild,1e3)}onCheckCancel(e,t){let{selectedOrders:s}=this.state;if(t.target.checked)this.setState({selectedOrders:s.concat([e])});else{let t=s.indexOf(e);t>-1&&this.setState({selectedOrders:s.slice(0,t).concat(s.slice(t+1))})}}cancelSelected(){this._cancelLimitOrders.call(this)}resetSelected(){this.setState({selectedOrders:[]})}onCancelToggle(e){const t=this._getOrders();let s=[];t.forEach((e=>{s.push(e.id)})),e.target.checked?this.setState({selectedOrders:s}):this.resetSelected()}_getSelectedOrders(e){let t=this.props.currentAccount.get("orders").toArray().filter((t=>-1!=e.indexOf(t)));return(0,m.FetchChain)("getObject",t)}_cancelLimitOrders(){this._getSelectedOrders(this.state.selectedOrders).then((e=>{let t=e.toJS().map((e=>e.sell_price.base.asset_id));P.A.cancelLimitOrders(this.props.currentAccount.get("id"),this.state.selectedOrders,t).then((()=>{this.resetSelected()})).catch((e=>{"string"==typeof e&&e.startsWith("Insufficient balance")?He.A.error(e):console.log("cancel orders error:",e)}))}))}_getOrders(){const{currentAccount:e,base:t,quote:s,feedPrice:a}=this.props,r=e.get("orders"),i=e.get("call_orders"),o=t.get("id"),n=s.get("id"),l={[t.get("id")]:{precision:t.get("precision")},[s.get("id")]:{precision:s.get("precision")}};let c=r.toArray().map((e=>{let t=m.ChainStore.getObject(e);if(!t)return null;let a=t.getIn(["sell_price","base","asset_id"]),r=t.getIn(["sell_price","quote","asset_id"]);return a===o&&r===n||a===n&&r===o?new O.qw(t.toJS(),l,s.get("id")):void 0})).filter((e=>!!e)),d=i.toArray().map((e=>{try{let t=m.ChainStore.getObject(e);if(!t)return null;let r=t.getIn(["call_price","base","asset_id"]),i=t.getIn(["call_price","quote","asset_id"]);if(r===o&&i===n||r===n&&i===o)return a?new O.Vt(t.toJS(),l,s.get("id"),a):null}catch(e){return null}})).filter((e=>!!e)).filter((e=>{try{return e.isMarginCalled()}catch(e){return!1}}));return c.concat(d)}render(){let e,t,{base:s,quote:r,quoteSymbol:i,baseSymbol:o,settleOrders:n}=this.props,{activeTab:l,showAll:c,rowCount:d,selectedOrders:h}=this.state;if(!s||!r)return null;let p=0;if(!l||"my_orders"==l){const i=this._getOrders();let o=i.filter((e=>e.isBid())).sort(((e,t)=>t.getPrice()-e.getPrice())).map((e=>{let t=e.getPrice();return a.createElement(je,{price:t,key:e.id,order:e,base:s,quote:r,selected:this.state.selectedOrders.length>0&&this.state.selectedOrders.includes(e.id),onCancel:this.props.onCancel.bind(this,e.id),onCheckCancel:this.onCheckCancel.bind(this,e.id)})})),n=i.filter((e=>!e.isBid())).sort(((e,t)=>e.getPrice()-t.getPrice())).map((e=>{let t=e.getPrice();return a.createElement(je,{price:t,key:e.id,order:e,base:s,quote:r,selected:this.state.selectedOrders.length>0&&this.state.selectedOrders.includes(e.id),onCancel:this.props.onCancel.bind(this,e.id),onCheckCancel:this.onCheckCancel.bind(this,e.id)})})),l=[];n.length&&(l=l.concat(n)),o.length&&(l=l.concat(o)),l.sort(((e,t)=>e.props.price-t.props.price)),p=l.length,p>0&&!c&&l.splice(d,l.length);let m=a.createElement("tr",null,a.createElement("td",{style:{textAlign:"center",lineHeight:4,fontStyle:"italic"},colSpan:"5"},a.createElement(F(),{content:"account.no_orders"}))),g=a.createElement("div",{style:{display:"grid"}},a.createElement(u.Button,{onClick:this.cancelSelected.bind(this)},a.createElement(F(),{content:"exchange.cancel_selected_orders"})));e=a.createElement(Fe.A,{ref:"contentTransition",component:"tbody",transitionName:"newrow"},l.length?l:m),t=p>11?a.createElement(a.Fragment,null,a.createElement("div",{className:"orderbook-showall"},a.createElement("a",{onClick:this._onSetShowAll.bind(this)},a.createElement(F(),{content:c?"exchange.hide":"exchange.show_all_orders",rowcount:p}))),h.length>0?g:null):h.length>0?g:null}l&&"open_settlement"==l&&(p=n.length,p>0&&!c&&n.splice(d,n.length),e=a.createElement(qe,{key:"settle_orders",orders:n,base:s,quote:r,baseSymbol:o,quoteSymbol:i}),t=p>11&&a.createElement("div",{className:"orderbook-showall"},a.createElement("a",{onClick:this._onSetShowAll.bind(this)},a.createElement(F(),{content:c?"exchange.hide":"exchange.show_all_orders",rowcount:p}))));let m=this.state.selectedOrders.length>0&&this.state.selectedOrders.length==p;return a.createElement(ze,{ref:"view",style:this.props.style,className:this.props.className,innerClass:this.props.innerClass,innerStyle:this.props.innerStyle,headerStyle:this.props.headerStyle,noHeader:this.props.noHeader,isSelected:m,tinyScreen:this.props.tinyScreen,activeTab:l,baseSymbol:o,quoteSymbol:i,contentContainer:e,footerContainer:t,onCancelToggle:this.onCancelToggle.bind(this)})}}$e.defaultProps={base:{},quote:{},orders:{},quoteSymbol:"",baseSymbol:""},$e.propTypes={base:w().object.isRequired,quote:w().object.isRequired,orders:w().object.isRequired,quoteSymbol:w().string.isRequired,baseSymbol:w().string.isRequired};var Ge=s(94726),Ke=s(40961);class Qe extends a.Component{static propTypes={orderRows:w().array.isRequired,noOrders:w().bool.isRequired,isBid:w().bool.isRequired};render(){let{orderRows:e,noOrders:t,isBid:s,id:r}=this.props;return a.createElement(Fe.A,{id:r,ref:s?"bidTransition":"askTransaction",component:null,transitionName:"newrow"},e.length>0?e:t||a.createElement("div",{className:"sticky-table-row"},a.createElement("td",{className:"cell no-orders",colSpan:"3"},s?a.createElement(F(),{content:"exchange.no_bids"}):a.createElement(F(),{content:"exchange.no_asks"}))))}}class Je extends a.Component{shouldComponentUpdate(e){return e.order.market_base===this.props.order.market_base&&(e.order.ne(this.props.order)||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount||e.isPanelActive!==this.props.isPanelActive||e.horizontal!==this.props.horizontal)}render(){let{order:e,quote:t,base:s,final:r}=this.props;const i=e.isBid();let o=e.isCall()?"orderHistoryCall":i?"orderHistoryBid":"orderHistoryAsk",n=a.createElement(V,{price:e.getPrice(),quote:t,base:s});return a.createElement(Ge.Row,{onClick:this.props.onClick,className:b()("sticky-table-row order-row",{"final-row":r},{"my-order":e.isMine(this.props.currentAccount)},"clickable")},a.createElement(Ge.Cell,{className:"cell left"},L.A.format_number(e[i?"amountForSale":"amountToReceive"]().getAmount({real:!0}),s.get("precision"))),a.createElement(Ge.Cell,{className:"cell"},L.A.format_number(e[i?"amountToReceive":"amountForSale"]().getAmount({real:!0}),t.get("precision"))),a.createElement(Ge.Cell,{className:`cell ${o} right`},n))}}const Ye=e=>e?e.getBoundingClientRect().height:0;class Ze extends a.Component{shouldComponentUpdate(e){return e.order.ne(this.props.order)||e.position!==this.props.position||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount||e.quoteTotal!==this.props.quoteTotal}render(){let{order:e,quote:t,base:s,position:r,quoteTotal:i}=this.props;const o=e.isBid();let n=e.isCall()?"orderHistoryCall":o?"orderHistoryBid":"orderHistoryAsk",l=a.createElement(V,{price:e.getPrice(),quote:t,base:s}),c=o?L.A.format_number(e.amountToReceive().getAmount({real:!0}),t.get("precision")):L.A.format_number(e.amountForSale().getAmount({real:!0}),t.get("precision")),d=o?L.A.format_number(e.amountForSale().getAmount({real:!0}),s.get("precision")):L.A.format_number(e.amountToReceive().getAmount({real:!0}),s.get("precision"));const h=i?e.totalToReceive():e.totalForSale(),p=i?e.totalForSale():e.totalToReceive(),m=i?t:s,u=o?L.A.format_number(h.getAmount({real:!0}),m.get("precision")):L.A.format_number(p.getAmount({real:!0}),m.get("precision"));let g="";return this.props.marketDepthPercentage&&!this.props.isBid?g=`linear-gradient(to right, rgba(255,0,0,.15) ${this.props.marketDepthPercentage||0}%, rgba(0,0,0,0) ${this.props.marketDepthPercentage||0}%)`:this.props.marketDepthPercentage&&this.props.isBid&&(g=`linear-gradient(to left, rgba(0,255,0,.15) ${this.props.marketDepthPercentage||0}%, rgba(0,0,0,0) ${this.props.marketDepthPercentage||0}%)`),a.createElement("tr",{onClick:this.props.onClick,className:e.isMine(this.props.currentAccount)?"my-order":"",style:{backgroundImage:g}},"left"===r?a.createElement("td",{className:"column-hide-xs"},u):a.createElement("td",{style:{width:"25%"},className:n},l),a.createElement("td",null,"left"===r?d:c),a.createElement("td",null,"left"===r?c:d),"right"===r?a.createElement("td",{className:"column-hide-xs"},u):a.createElement("td",{style:{width:"25%"},className:n},l))}}class Xe extends a.Component{shouldComponentUpdate(e){return e.order.market_base===this.props.order.market_base&&(e.order.ne(this.props.order)||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount)}render(){let{order:e,quote:t,base:s,final:r}=this.props;const i=e.isBid();let o=i?"orderHistoryBid":"orderHistoryAsk",n=a.createElement(V,{price:e.getPrice(),quote:t,base:s});return a.createElement(Ge.Row,{onClick:this.props.onClick,className:b()("sticky-table-row order-row",{"final-row":r},"clickable")},a.createElement(Ge.Cell,{className:"cell left"},L.A.format_number(e[i?"amountForSale":"amountToReceive"]().getAmount({real:!0}),s.get("precision"))),a.createElement(Ge.Cell,{className:"cell"},L.A.format_number(e[i?"amountToReceive":"amountForSale"]().getAmount({real:!0}),t.get("precision"))),a.createElement(Ge.Cell,{className:`cell ${o} right`},n))}}class et extends a.Component{shouldComponentUpdate(e){return e.order.ne(this.props.order)||e.position!==this.props.position||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount||e.quoteTotal!==this.props.quoteTotal}render(){let{order:e,quote:t,base:s,position:r,quoteTotal:i}=this.props;const o=e.isBid();let n=o?"orderHistoryBid":"orderHistoryAsk",l=a.createElement(V,{price:e.getPrice(),quote:t,base:s}),c=o?L.A.format_number(e.amountToReceive().getAmount({real:!0}),t.get("precision")):L.A.format_number(e.amountForSale().getAmount({real:!0}),t.get("precision")),d=o?L.A.format_number(e.amountForSale().getAmount({real:!0}),s.get("precision")):L.A.format_number(e.amountToReceive().getAmount({real:!0}),s.get("precision"));const h=i?e.totalToReceive():e.totalForSale(),p=i?e.totalForSale():e.totalToReceive(),m=i?t:s,u=o?L.A.format_number(h.getAmount({real:!0}),m.get("precision")):L.A.format_number(p.getAmount({real:!0}),m.get("precision"));return a.createElement("tr",{onClick:this.props.onClick},"left"===r?a.createElement("td",{className:"column-hide-xs"},u):a.createElement("td",{style:{width:"25%"},className:n},l),a.createElement("td",null,"left"===r?d:c),a.createElement("td",null,"left"===r?c:d),"right"===r?a.createElement("td",{className:"column-hide-xs"},u):a.createElement("td",{style:{width:"25%"},className:n},l))}}class tt extends a.Component{constructor(){super(),this.state={groupLimit:""}}static getDerivedStateFromProps(e){return{groupLimit:e.currentGroupOrderLimit}}render(){const e=0===this.props.trackedGroupsConfig.length,t=this.props.trackedGroupsConfig.map((e=>this.props.globalSettingsSelector?a.createElement(u.Select.Option,{value:e,key:e},e/100+"%"):a.createElement("option",{value:e,key:e},e/100+"%")));return this.props.globalSettingsSelector?a.createElement(u.Select,{placeholder:"Select option",style:{width:"100%"},value:this.props.currentGroupOrderLimit,disabled:e,onChange:this.props.handleGroupOrderLimitChange.bind(this)},e?a.createElement(u.Select.Option,{value:0},a.createElement(F(),{content:"tooltip.no_groups_available"})):a.createElement(u.Select.Option,{value:0},a.createElement(F(),{content:"settings.disabled"})),t):a.createElement(u.Tooltip,{placement:"bottom",title:e?_().translate("tooltip.no_groups_available"):null},a.createElement("select",{value:this.state.groupLimit,onChange:this.props.handleGroupOrderLimitChange,className:"settings-select",style:e?{cursor:"not-allowed"}:null},a.createElement(F(),{content:"exchange.group_order_limit",component:"option",value:"0"}),t))}}class st extends a.Component{constructor(e){super(),this.state={flip:e.flipOrderBook,showAllBids:!1,showAllAsks:!1,rowCount:20,autoScroll:e.autoScroll,quoteTotalBids:!1,quoteTotalAsks:!1},this.verticalStickyTable=a.createRef(),this.centerText=a.createRef(),this.hor_bids=a.createRef(),this.hor_asks=a.createRef(),this.askTransition=a.createRef(),this.bidTransition=a.createRef()}shouldComponentUpdate(e,t){if(this.props.horizontal&&this.props.hideScrollbars&&t.showAllAsks!=this.state.showAllAsks){let e=this.hor_asks.current;t.showAllAsks?(E().initialize(e),this.psUpdate()):E().destroy(e),this.askTransition.current.resetAnimation(),this.hor_asks.current&&(this.hor_asks.current.scrollTop=0)}if(this.props.horizontal&&this.props.hideScrollbars&&t.showAllBids!=this.state.showAllBids){let e=this.hor_bids.current;t.showAllBids?(E().initialize(e),this.psUpdate()):E().destroy(e),this.bidTransition.current.resetAnimation(),this.hor_bids.current&&(this.hor_bids.current.scrollTop=0)}return!0}componentDidUpdate(e,t,s){const a=this.props;a.base.get("id")===e.base.get("id")&&a.quote.get("id")===e.quote.get("id")||(this.askTransition.current&&(this.askTransition.current.resetAnimation(),this.hor_asks.current&&(this.hor_asks.current.scrollTop=0),this.hor_bids.current&&(this.hor_bids.current.scrollTop=0)),this.bidTransition.current&&this.bidTransition.current.resetAnimation(),this.refs.vert_bids&&(this.refs.vert_bids.scrollTop=0),this.props.horizontal||this.setState({autoScroll:this.state.autoScroll}));let r=this.hor_bids.current,i=this.hor_asks.current;this.props.horizontal&&a.hideScrollbars!==this.props.hideScrollbars&&a.hideScrollbars&&(E().destroy(r),E().destroy(i)),this.props.horizontal&&a.hideScrollbars!==this.props.hideScrollbars&&!a.hideScrollbars&&(E().initialize(r),E().initialize(i),this.askTransition.current.resetAnimation(),this.bidTransition.current.resetAnimation(),i&&(i.scrollTop=0),r&&(r.scrollTop=0),this.psUpdate()),this.centerVerticalScrollBar()}queryStickyTable=(e=null)=>{const t=Ke.findDOMNode(this.verticalStickyTable.current);return null==e?t:t.querySelector(e)};verticalScrollBar=()=>this.queryStickyTable();componentDidMount(){if(this.props.horizontal){if(!this.props.hideScrollbars){let e=this.hor_bids.current;E().initialize(e);let t=this.hor_asks.current;E().initialize(t)}}else E().initialize(this.verticalScrollBar())}centerVerticalScrollBar(){if(!this.props.horizontal&&this.state.autoScroll){const e=this.queryStickyTable(),t=this.queryStickyTable(".top-header"),s=this.centerText.current,a=Ye(this.queryStickyTable(".order-row")),r=(0!==this.props.currentGroupOrderLimit?this.props.orderBookReversed?this.props.groupedBids:this.props.groupedAsks:this.props.orderBookReversed?this.props.combinedBids:this.props.combinedAsks).length*a,i=Ye(e)-Ye(t),o=r+Ye(s)/2-i/2;e.scrollTop=o}}psUpdate(){if(this.props.horizontal){let e=this.hor_bids.current;E().update(e);let t=this.hor_asks.current;E().update(t)}else E().update(this.verticalScrollBar())}_onSetShowAll(e){"asks"===e?(this.setState({showAllAsks:!this.state.showAllAsks}),this.state.showAllAsks&&(this.hor_asks.current.scrollTop=0)):(this.setState({showAllBids:!this.state.showAllBids}),this.state.showAllBids&&(this.hor_bids.current.scrollTop=0))}toggleSpreadValue=()=>{this.setState({displaySpreadAsPercentage:!this.state.displaySpreadAsPercentage})};toggleAutoScroll=()=>{this.setState({autoScroll:!this.state.autoScroll})};toggleTotalAsset(e){const t=e?"quoteTotalBids":"quoteTotalAsks";this.setState({[t]:!this.state[t]})}render(){let{combinedBids:e,combinedAsks:t,highestBid:s,lowestAsk:r,quote:i,base:o,totalAsks:n,totalBids:l,quoteSymbol:c,baseSymbol:d,horizontal:h,trackedGroupsConfig:p,currentGroupOrderLimit:m,handleGroupOrderLimitChange:u,orderBookReversed:g,groupedBids:y,groupedAsks:f,flipOrderBook:C}=this.props,{showAllAsks:S,showAllBids:A,rowCount:v,displaySpreadAsPercentage:E}=this.state;const k=!r.sell_price&&!s.sell_price,w=!(!r.sell_price||!s.sell_price)&&(E?`${(100*(r._real_price/s._real_price-1)).toFixed(2)}%`:a.createElement(V,{price:r._real_price-s._real_price,base:o,quote:i}));let T=null,P=null,x=0!==this.props.currentGroupOrderLimit?f:t,N=0!==this.props.currentGroupOrderLimit?y:e;if(h||g?!h&&g&&(N.sort(((e,t)=>e.getPrice()-t.getPrice())),x.sort(((e,t)=>e.getPrice()-t.getPrice()))):(N.sort(((e,t)=>t.getPrice()-e.getPrice())),x.sort(((e,t)=>t.getPrice()-e.getPrice()))),o&&i)if(0!==this.props.currentGroupOrderLimit)T=N.map(((e,t)=>h?a.createElement(et,{index:t,key:e.getPrice()+(e.isBid()?"_bid":""),order:e,onClick:this.props.onClick.bind(this,e),base:o,quote:i,position:C?"right":"left",currentAccount:this.props.currentAccount,quoteTotal:this.state.quoteTotalBids}):a.createElement(Xe,{index:t,key:e.getPrice()+(e.isBid()?"_bid":""),order:e,onClick:this.props.onClick.bind(this,e),base:o,quote:i,final:0===t,currentAccount:this.props.currentAccount}))),P=x.map(((e,t)=>h?a.createElement(et,{index:t,key:e.getPrice()+(e.isBid()?"_bid":""),order:e,onClick:this.props.onClick.bind(this,e),base:o,quote:i,type:e.type,position:C?"left":"right",currentAccount:this.props.currentAccount,quoteTotal:this.state.quoteTotalAsks}):a.createElement(Xe,{index:t,key:e.getPrice()+(e.isBid()?"_bid":""),order:e,onClick:this.props.onClick.bind(this,e),base:o,quote:i,type:e.type,final:0===t,currentAccount:this.props.currentAccount})));else{let e=N.length?N[N.length-1].totalForSale().getAmount():0;T=N.map(((t,s)=>{const r=t.totalForSale().getAmount(),n=Math.ceil(100*r/e);return h?a.createElement(Ze,{index:s,key:t.getPrice()+(t.isCall()?"_call":""),marketDepthPercentage:n,isBid:!0,order:t,onClick:this.props.onClick.bind(this,t),base:o,quote:i,position:C?"right":"left",currentAccount:this.props.currentAccount,quoteTotal:this.state.quoteTotalBids}):a.createElement(Je,{index:s,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:this.props.onClick.bind(this,t),base:o,quote:i,final:0===s,currentAccount:this.props.currentAccount})}));let t=x.length?x[x.length-1].totalForSale().getAmount():0;P=x.map(((e,s)=>{const r=e.totalForSale().getAmount(),n=Math.ceil(100*r/t);return h?a.createElement(Ze,{index:s,marketDepthPercentage:n,isBid:!1,key:e.getPrice()+(e.isCall()?"_call":""),order:e,onClick:this.props.onClick.bind(this,e),base:o,quote:i,type:e.type,position:C?"left":"right",currentAccount:this.props.currentAccount,quoteTotal:this.state.quoteTotalAsks}):a.createElement(Je,{index:s,key:e.getPrice()+(e.isCall()?"_call":""),order:e,onClick:this.props.onClick.bind(this,e),base:o,quote:i,type:e.type,final:0===s,currentAccount:this.props.currentAccount})}))}if(this.props.horizontal){let e=T.length,t=P.length;A||T.splice(v,T.length),S||P.splice(v,P.length);let s=a.createElement("thead",null,a.createElement("tr",{key:"top-header",className:"top-header"},a.createElement("th",{className:"column-hide-xs"},a.createElement(F(),{className:"header-sub-title",content:"exchange.total"}),a.createElement("a",{onClick:()=>this.toggleTotalAsset(!0),className:"header-sub-title underline-title"}," ",a.createElement(W.A,{dataPlace:"top",name:this.state.quoteTotalBids?c:d,noTip:!0}))),a.createElement("th",null,a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:d}))),a.createElement("th",null,a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:c}))),a.createElement("th",null,a.createElement(F(),{className:(C?"ask-total":"bid-total")+" header-sub-title",content:"exchange.price"})))),r=a.createElement("thead",null,a.createElement("tr",{key:"top-header",className:"top-header"},a.createElement("th",null,a.createElement(F(),{className:(C?"bid-total":"ask-total")+" header-sub-title",content:"exchange.price"})),a.createElement("th",null,a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:c}))),a.createElement("th",null,a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:d}))),a.createElement("th",{className:"column-hide-xs"},a.createElement(F(),{className:"header-sub-title",content:"exchange.total"}),a.createElement("a",{onClick:()=>this.toggleTotalAsset(),className:"header-sub-title underline-title"}," ",a.createElement(W.A,{dataPlace:"top",name:this.state.quoteTotalAsks?c:d,noTip:!0}))))),h=this.props.wrapperClass,g=this.props.innerClass;return a.createElement("div",{ref:"order_book",style:{marginRight:this.props.smallScreen?10:0},className:b()(h)},a.createElement("div",{className:b()(g,C?"order-1":"order-2")},a.createElement("div",null,a.createElement("div",{className:"exchange-content-header ask"},a.createElement(F(),{content:"exchange.asks"}),C&&!this.props.hideFunctionButtons?a.createElement("div",{style:{display:"inline-block"}},a.createElement("span",{onClick:this.props.onFlipOrderBook.bind(this),style:{cursor:"pointer",fontSize:"1rem",marginLeft:"4px",position:"relative",top:"-2px"},className:"flip-arrow"}," ","⇆")):null,C&&!this.props.hideFunctionButtons?a.createElement("div",{className:"float-right header-sub-title grouped_order"},p?a.createElement(tt,{trackedGroupsConfig:p,handleGroupOrderLimitChange:u,currentGroupOrderLimit:m}):null):null,this.props.onTogglePosition&&!this.props.hideFunctionButtons?a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):null,C&&!this.props.hideFunctionButtons?a.createElement("span",{className:"order-book-button-v",onClick:this.props.moveOrderBook},a.createElement(H.A,{name:"thumb-tack",className:"icon-14px icon-fill"})):null,a.createElement("div",{style:{lineHeight:"16px"},className:"header-sub-title float-right"},a.createElement(F(),{content:"exchange.market_depth"}),a.createElement("span",null,": "),L.A.format_number(n,i.get("precision")),a.createElement("span",null," ","(",a.createElement(W.A,{name:c}),")"))),a.createElement("div",{className:"market-right-padding-only",style:{paddingRight:"0.6rem"}},a.createElement("table",{className:"table order-table table-hover fixed-table text-right"},C?s:r)),a.createElement("div",{className:"grid-block",ref:this.hor_asks,style:{paddingRight:"0.6rem",overflow:"hidden",maxHeight:260,lineHeight:"13px"}},a.createElement("table",{style:{paddingBottom:5},className:"table order-table no-stripes table-hover fixed-table text-right no-overflow"},a.createElement(Fe.A,{ref:this.askTransition,className:"orderbook clickable",component:"tbody",transitionName:"newrow",id:"top-order-rows"},P))),t>11?a.createElement("div",{className:"orderbook-showall"},a.createElement("a",{onClick:this._onSetShowAll.bind(this,"asks")},a.createElement(F(),{content:S?"exchange.hide":"exchange.show_asks",ordercount:t}))):null)),a.createElement("div",{className:b()(g,C?"order-2":"order-1")},a.createElement("div",null,a.createElement("div",{className:"exchange-content-header bid"},a.createElement(F(),{content:"exchange.bids"}),C||this.props.hideFunctionButtons?null:a.createElement("div",{style:{display:"inline-block"}},a.createElement("span",{onClick:this.props.onFlipOrderBook.bind(this),style:{cursor:"pointer",fontSize:"1rem",marginLeft:"4px",position:"relative",top:"-2px"},className:"flip-arrow"}," ","⇆")),C||this.props.hideFunctionButtons?null:a.createElement("div",{className:"float-right header-sub-title grouped_order"},p?a.createElement(tt,{trackedGroupsConfig:p,handleGroupOrderLimitChange:u,currentGroupOrderLimit:m}):null),0!==m&&this.props.hideFunctionButtons&&a.createElement(H.A,{name:"grouping",className:"float-right icon-14px",title:_().translate("icons.order_grouping"),style:{marginLeft:"0.5rem"}}),this.props.onTogglePosition&&!this.props.hideFunctionButtons?a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):null,C||this.props.hideFunctionButtons?null:a.createElement("span",{className:"order-book-button-v",onClick:this.props.moveOrderBook},a.createElement(H.A,{name:"thumb-tack",className:"icon-14px"})),a.createElement("div",{style:{lineHeight:"16px"},className:"float-right header-sub-title"},a.createElement(F(),{content:"exchange.market_depth"}),a.createElement("span",null,": "),L.A.format_number(l,o.get("precision")),a.createElement("span",null," ","(",a.createElement(W.A,{name:d}),")"))),a.createElement("div",{className:"market-right-padding-only",style:{paddingRight:"0.6rem"}},a.createElement("table",{className:"table order-table table-hover fixed-table text-right"},C?r:s)),a.createElement("div",{className:"grid-block",ref:this.hor_bids,style:{paddingRight:"0.6rem",overflow:"hidden",maxHeight:260,lineHeight:"13px"}},a.createElement("table",{style:{paddingBottom:5},className:"table order-table no-stripes table-hover fixed-table text-right no-overflow"},a.createElement(Fe.A,{ref:this.bidTransition,className:"orderbook clickable",component:"tbody",transitionName:"newrow"},T))),e>v?a.createElement("div",{className:"orderbook-showall"},a.createElement("a",{onClick:this._onSetShowAll.bind(this,"bids")},a.createElement(F(),{content:A?"exchange.hide":"exchange.show_bids",ordercount:e}))):null)))}return a.createElement("div",{className:"order-table-container"},a.createElement(Ge.StickyTable,{borderWidth:"0px",borderColor:"grey",leftStickyColumnCount:0,className:"order-table table",ref:this.verticalStickyTable},a.createElement(Ge.Row,{className:"top-header sticky-table-header"},a.createElement(Ge.Cell,{className:"cell header-cell left"},a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{name:d}))),a.createElement(Ge.Cell,{className:"cell header-cell"},a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{name:c}))),a.createElement(Ge.Cell,{className:"cell header-cell right"},a.createElement(F(),{className:"header-sub-title",content:"exchange.price"}))),g?a.createElement(Qe,{id:"top-order-rows",noOrders:k,orderRows:T,isBid:!0}):a.createElement(Qe,{id:"top-order-rows",noOrders:k,orderRows:P,isBid:!1}),k?a.createElement(Ge.Row,{className:"sticky-table-row",ref:this.centerText},a.createElement(Ge.Cell,{className:"cell"}),a.createElement(Ge.Cell,{className:"cell no-orders padtop"},a.createElement(F(),{content:"exchange.no_orders"}))):a.createElement(Ge.Row,{className:"sticky-table-row orderbook-latest-price",ref:this.centerText,style:{padding:0}},a.createElement(Ge.Cell,{className:"cell right"},a.createElement("span",{className:"clickable left",onClick:this.toggleSpreadValue},a.createElement(F(),{className:"orderbook-center-title",content:"exchange.spread"})," ",a.createElement("span",{className:"spread-value"},w||"0"))),a.createElement(Ge.Cell,{className:"cell cell-center"},a.createElement("span",{style:{width:75}},this.props.hideFunctionButtons?null:a.createElement(H.A,{className:"lock-unlock clickable icon-fill",onClick:this.toggleAutoScroll,name:this.state.autoScroll?"locked":"unlocked",title:this.state.autoScroll?"icons.unlocked.disable_auto_scroll":"icons.locked.enable_auto_scroll"})," ",this.props.hideFunctionButtons?null:a.createElement(H.A,{onClick:this.props.moveOrderBook,name:"thumb-tack",className:"icon-14px icon-fill order-book-button-v clickable",title:this.props.horizontal?"icons.thumb_tack":"icons.thumb_untack",style:{marginLeft:0}})," ",0==m?null:a.createElement(H.A,{name:"grouping",className:"icon-14px",title:_().translate("icons.order_grouping"),style:{marginLeft:0}}))),a.createElement(Ge.Cell,{className:"cell",style:{textAlign:"center"}},!!this.props.latest&&a.createElement("span",{className:"right"},a.createElement("span",{className:this.props.changeClass?this.props.changeClass:"spread-value"},a.createElement(V,{price:this.props.latest,base:this.props.base,quote:this.props.quote}))))),g?a.createElement(Qe,{noOrders:k,orderRows:P,isBid:!1}):a.createElement(Qe,{noOrders:k,orderRows:T,isBid:!0})))}}st.defaultProps={bids:[],asks:[],orders:{}},st.propTypes={bids:w().array.isRequired,asks:w().array.isRequired,orders:w().object.isRequired};var at=s(9404),rt=s.n(at),it=s(9476),ot=s(77157),nt=s(6882);class lt extends a.Component{static defaultProps={format:-1!==Be()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history",tooltip:!1,component:"span"};UNSAFE_componentWillMount(){this.props.blockHeader||nt.A.getHeader.defer(this.props.block_number)}shouldComponentUpdate(e){return e.blockHeader&&!this.props.blockHeader&&setTimeout($.A.rebuild,1e3),e.blockHeader!==this.props.blockHeader}render(){const{blockHeader:e,tooltip:t,component:s,format:r}=this.props;return e?a.createElement(s,{className:t?"tooltip":""},a.createElement(u.Tooltip,{title:t?e.timestamp.toString():"",placement:"left"},a.createElement("span",null,_().localize(e.timestamp,{type:"date",format:r})))):a.createElement(s)}}const ct=lt=(0,it.N)(lt,{listenTo:()=>[ot.A],getProps:e=>({blockHeader:ot.A.getState().blockHeaders.get(e.block_number)})});function dt({fill:e,base:t,quote:s}){const r=-1!==e.id.indexOf("5.0")?a.createElement("td",null,a.createElement(u.Tooltip,{title:e.time.toString(),placement:"left"},a.createElement("div",{className:"tooltip",style:{whiteSpace:"nowrap"}},_().localize(e.time,{type:"date",format:-1!==Be()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history"})))):a.createElement(ct,{component:"td",block_number:e.block,tooltip:!0});return a.createElement("tr",null,a.createElement("td",{className:e.className},a.createElement(V,{price:e.getPrice(),base:t,quote:s})),a.createElement("td",null,e.amountToReceive()),a.createElement("td",null,e.amountToPay()),r)}class ht extends a.Component{render(){let{className:e,innerClass:t,innerStyle:s,noHeader:r,headerStyle:i,activeTab:o,quoteSymbol:n,baseSymbol:l,tinyScreen:c,totalRows:d,historyRows:h,showAll:p}=this.props;const m=a.createElement("tr",null,a.createElement("td",{style:{textAlign:"center",lineHeight:4,fontStyle:"italic"},colSpan:"5"},a.createElement(F(),{content:"account.no_trades"})));return a.createElement("div",{className:b()(e)},a.createElement("div",{className:t,style:s},r?null:a.createElement("div",{style:i,className:"exchange-content-header"},"my_history"===o?a.createElement(F(),{content:"exchange.my_history"}):null,"history"===o?a.createElement(F(),{content:"exchange.history"}):null),a.createElement("div",{className:"grid-block shrink left-orderbook-header market-right-padding-only"},a.createElement("table",{className:"table table-no-padding order-table text-left fixed-table market-right-padding"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{style:{textAlign:"right"}},a.createElement(F(),{className:"header-sub-title",content:"exchange.price"})),a.createElement("th",{style:{textAlign:"right"}},a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:n}))),a.createElement("th",{style:{textAlign:"right"}},a.createElement("span",{className:"header-sub-title"},a.createElement(W.A,{dataPlace:"top",name:l}))),a.createElement("th",{style:{textAlign:"right"}},a.createElement(F(),{className:"header-sub-title",content:"explorer.block.date"})))))),a.createElement("div",{className:"table-container grid-block market-right-padding-only no-overflow",ref:"history",style:{minHeight:c?0:260,maxHeight:260,overflow:"hidden",lineHeight:"13px"}},a.createElement("table",{className:"table order-table no-stripes table-hover fixed-table text-right no-overflow"},a.createElement(Fe.A,{ref:"historyTransition",component:"tbody",transitionName:"newrow",className:"orderbook"},h&&h.length>0?h:m))),h&&d>11?a.createElement("div",{className:"orderbook-showall"},a.createElement("a",{onClick:e=>this.props.onSetShowAll(e)},a.createElement(F(),{content:p?"exchange.hide":"exchange.show_all_trades",rowcount:d}))):null))}}const{operations:pt}=m.ChainTypes;class mt extends a.Component{constructor(e){super(),this.state={activeTab:e.viewSettings.get("historyTab","history"),rowCount:20,showAll:!1}}shouldComponentUpdate(e,t){return!rt().is(e.history,this.props.history)||e.baseSymbol!==this.props.baseSymbol||e.quoteSymbol!==this.props.quoteSymbol||e.className!==this.props.className||e.activeTab!==this.props.activeTab||t.activeTab!==this.state.activeTab||t.showAll!==this.state.showAll||e.currentAccount!==this.props.currentAccount||e.isPanelActive!==this.props.isPanelActive||e.hideScrollbars!==this.props.hideScrollbars}componentDidMount(){this.props.hideScrollbars||this.updateContainer(1)}componentDidUpdate(e){let{hideScrollbars:t}=this.props,{showAll:s}=this.state;e.showAll!=s&&(s&&!t?this.updateContainer(2):s||t?s&&t?this.updateContainer(1):this.updateContainer(0):this.updateContainer(3))}UNSAFE_componentWillReceiveProps(e){e.activeTab!==this.props.activeTab&&this.changeTab(e.activeTab),e.baseSymbol===this.props.baseSymbol&&e.quoteSymbol===this.props.quoteSymbol||(this.setState({showAll:!1}),this.updateContainer(0),this.props.hideScrollbars||this.updateContainer(1)),e.hideScrollbars!==this.props.hideScrollbars&&(this.updateContainer(0),e.hideScrollbars||this.updateContainer(1))}updateContainer(e=2){let t=this.refs.view.refs.history,s=this.refs.view.refs.historyTransition;t&&(0==e?(t.scrollTop=0,E().destroy(t)):1==e?(E().initialize(t),this.updateContainer(3)):2==e?E().update(t):3==e&&(t.scrollTop=0,E().update(t)),s&&s.resetAnimation())}onSetShowAll(){this.setState({showAll:!this.state.showAll})}changeTab(e){T.A.changeViewSetting({historyTab:e}),this.setState({activeTab:e}),this.updateContainer(3),setTimeout($.A.rebuild,1e3)}render(){let{history:e,myHistory:t,base:s,quote:r,baseSymbol:i,quoteSymbol:o,isNullAccount:n,activeTab:l}=this.props,{rowCount:c,showAll:d}=this.state,h=null;if(n&&(l="history"),"my_history"===l&&t&&t.size){const e={[r.get("id")]:{precision:r.get("precision")},[s.get("id")]:{precision:s.get("precision")}};h=t.filter((e=>e.getIn(["op",0])===pt.fill_order)).filter((e=>{let t=r.get("id"),a=s.get("id"),i=e.getIn(["op",1,"pays","asset_id"]),o=e.getIn(["op",1,"receives","asset_id"]);return!(t!==i&&t!==o||a!==i&&a!==o)})).sort(((e,t)=>t.get("block_num")-e.get("block_num"))).map((t=>{let i=new O.yK(t.toJS(),e,r.get("id"));return a.createElement(dt,{key:i.id,fill:i,base:s,quote:r})})).toArray()}else e&&e.size&&(h=this.props.history.take(100).map((e=>a.createElement(dt,{key:e.id,fill:e,base:s,quote:r}))).toArray());let p=h?h.length:null;return!d&&h&&h.splice(c,h.length),a.createElement(ht,{ref:"view",className:this.props.className,innerClass:this.props.innerClass,innerStyle:this.props.innerStyle,noHeader:this.props.noHeader,headerStyle:this.props.headerStyle,activeTab:l,quoteSymbol:o,baseSymbol:i,tinyScreen:this.props.tinyScreen,historyRows:h,totalRows:p,showAll:d,onSetShowAll:this.onSetShowAll.bind(this)})}}mt.defaultProps={history:[]},mt.propTypes={history:w().object.isRequired};const ut=(0,it.N)(mt,{listenTo:()=>[o.A],getProps:()=>({viewSettings:o.A.getState().viewSettings})});var gt=s(9540),bt=s(44352),yt=s(72181),_t=s(44483);function ft(){return ft=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ft.apply(this,arguments)}class Ct extends a.Component{static propTypes={onClose:w().func,quoteSymbol:w().string,baseSymbol:w().string,market:w().array,marketPickerAsset:w().string};onKeyPress(e,t){"Enter"==t.key&&this.props.history.push(e)}render(){const{quoteSymbol:e,baseSymbol:t,market:s,marketPickerAsset:r}=this.props,{onClose:i}=this.props,o=s[1].quote,n=e==r?`/market/${o}_${t}`:`/market/${e}_${o}`;return a.createElement("li",{key:s[0],style:{height:40},onKeyPress:this.onKeyPress.bind(this,n),tabIndex:this.props.tabIndex},a.createElement(we.N_,{style:{display:"flex"},onClick:i,to:n},a.createElement("div",{style:{flex:2}},a.createElement(W.A,{name:s[1].quote})),a.createElement("div",{style:{flex:3}},s[1].issuer)))}}class St extends a.Component{constructor(){super(),this.state=this.initialState(),this.getAssetList=(0,h.A)(bt.A.getAssetList.defer,150),this.setState=this.setState.bind(this),this._checkAndUpdateMarketList=this._checkAndUpdateMarketList.bind(this)}initialState(){return{marketsList:[],lookupQuote:null,inputValue:""}}componentDidMount(){this.refs.marketPicker_input.focus()}componentDidUpdate(){this.refs.marketPicker_input.focus()}UNSAFE_componentWillReceiveProps(e){e.marketPickerAsset!==this.props.marketPickerAsset&&this.setState(this.initialState()),e.searchAssets!==this.props.searchAssets&&(0,_t.DB)({searchAssets:this.props.searchAssets,marketPickerAsset:this.props.marketPickerAsset,baseAsset:this.props.baseAsset,quoteAsset:this.props.quoteAsset},{inputValue:this.state.inputValue,lookupQuote:this.state.lookupQuote},this.setState,this._checkAndUpdateMarketList)}shouldComponentUpdate(e,t){return e.visible!==this.props.visible||e.marketPickerAsset!==this.props.marketPickerAsset||e.searchAssets!==this.props.searchAssets||t.marketsList!==this.state.marketsList||!L.A.are_equal_shallow(t,this.state)}componentWillUnmount(){this.intervalId&&clearInterval(this.intervalId)}_onInputName(e,t){let s=t.target.value.trim().toUpperCase();m.ChainValidation.is_valid_symbol_error(s,!0)?this.setState({inputValue:s,activeSearch:!1,marketsList:[]}):(this.setState({inputValue:s,activeSearch:!0,marketsList:[]}),this.state.inputValue!==s&&this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{(0,_t.YY)(s,e,this.getAssetList,this.setState)}),1500))}_checkAndUpdateMarketList(e){clearInterval(this.intervalId),this.intervalId=setInterval((()=>{let t=0;for(let[,s]of e)s.issuer||(s.issuer=(0,_t.nM)(s.issuerId),s.issuer||t++);t||(clearInterval(this.intervalId),this.setState({marketsList:e,activeSearch:!1}))}),300)}renderSearchBar(){const{inputValue:e}=this.state,t=_().translate("exchange.market_picker.find_by_asset").toUpperCase();return a.createElement("div",{id:"filter"},a.createElement(u.Form.Item,{label:t},a.createElement(u.Input,{type:"text",ref:"marketPicker_input",value:e,onChange:this._onInputName.bind(this,!0),placeholder:_().translate("exchange.market_picker.search"),maxLength:16,tabIndex:2})))}renderResults(){const{marketsList:e}=this.state,{activeSearch:t,inputValue:s}=this.state,r=t&&0!=s.length;let{marketPickerAsset:i}=this.props,o=this.props.baseAsset.get("symbol"),n=this.props.quoteAsset.get("symbol");return r?a.createElement(u.Icon,{style:{marginLeft:"8px"},type:"loading",theme:"outlined"}):a.createElement("div",{className:"results"},a.createElement("ul",{style:{marginLeft:0,minHeight:"20px"}},e.map(((e,t)=>a.createElement(Ct,{key:t,tabIndex:t+100,baseSymbol:o,quoteSymbol:n,market:e,marketPickerAsset:i,history:this.props.history,onClose:this.props.onClose.bind(this)})))))}render(){const{marketPickerAsset:e}=this.props;return a.createElement("div",{className:"marketPicker"},a.createElement("div",{className:"marketPicker__subHeader"},a.createElement(F(),{content:"exchange.market_picker.sub_title"})," ",a.createElement(we.N_,{to:`/asset/${e}`,style:{cursor:"pointer",color:"lightblue !important"}},a.createElement(W.A,{name:e}))),this.renderSearchBar(),this.renderResults())}}class At extends a.Component{constructor(){super(),this.state={open:!1,smallScreen:!1}}UNSAFE_componentWillMount(){this.setState({smallScreen:window.innerWidth<=800})}UNSAFE_componentWillReceiveProps(e){this.props.quoteAsset.get("id")===e.quoteAsset.get("id")&&this.props.baseAsset.get("id")===e.baseAsset.get("id")||this.onClose()}show(){this.props.showModal()}onClose(){this.props.onToggleMarketPicker(null),this.props.hideModal()}render(){return a.createElement(u.Modal,ft({title:_().translate("exchange.market_picker.title"),closable:!1,visible:this.props.visible,id:this.props.modalId,overlay:!0,onCancel:this.onClose.bind(this),noHeaderContainer:!0,footer:null,ref:this.props.modalId},this.props),a.createElement(St,ft({onClose:this.onClose.bind(this)},this.props)))}}const vt=At=(0,it.N)(At,{listenTo:()=>[yt.A],getProps:()=>({searchAssets:yt.A.getState().assets,assetsLoading:yt.A.getState().assetsLoading})});class Et extends a.Component{constructor(e){super(e),this.submit=this.submit.bind(this),this.cancel=this.cancel.bind(this)}_onForce(e,t){t.preventDefault(),this.props.hideModal(),e&&this.props.onForce()}submit(e){this._onForce(!0,e)}cancel(e){this._onForce(!1,e)}render(){let{type:e,diff:t,hasOrders:s}=this.props;const r=[a.createElement(u.Button,{key:"submit",onClick:this.submit},_().translate("settings.yes")),a.createElement(u.Button,{key:"cancel",type:"primary",onClick:this.cancel},_().translate("settings.no"))];return a.createElement(u.Modal,{footer:r,visible:this.props.visible,onCancel:this.cancel,title:_().translate("transaction.confirm")},a.createElement("div",{className:"grid-block vertical"},s?a.createElement(F(),{content:"exchange.confirm_"+e,diff:L.A.format_number(t,2)}):a.createElement(F(),{content:"exchange.confirm_no_orders_"+e})))}}class kt extends a.Component{constructor(e){super(),this.state={open:!1,smallScreen:!1,autoScroll:e.viewSettings.get("global_AutoScroll",!0)},this.setChartHeight=this.setChartHeight.bind(this)}UNSAFE_componentWillMount(){this.setState({smallScreen:window.innerWidth<=800})}onClose(){this.props.hideModal()}setChartHeight(e){this.props.onChangeChartHeight({value:e})}setAutoscroll(e){let t=1==e;this.setState({autoScroll:t}),T.A.changeViewSetting({global_AutoScroll:t}),this.props.onSetAutoscroll(t)}_getGroupingOptions(e){return a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},onChange:this.props.onSetPanelTabs.bind(this,e),value:this.props.panelTabs[e]},a.createElement(u.Select.Option,{value:0},a.createElement(F(),{content:"exchange.settings.options.grouping_standalone"})),a.createElement(u.Select.Option,{value:1},a.createElement(F(),{content:"exchange.settings.options.grouping_1"})),a.createElement(u.Select.Option,{value:2},a.createElement(F(),{content:"exchange.settings.options.grouping_2"})))}render(){let{chartType:e,chartHeight:t}=this.props;return a.createElement(u.Modal,{title:_().translate("exchange.settings.header.title"),visible:this.props.visible,id:this.props.modalId,overlay:!0,footer:[a.createElement(u.Button,{key:"close",onClick:this.onClose.bind(this)},_().translate("modal.close"))],onCancel:this.onClose.bind(this),noHeaderContainer:!0,ref:this.props.modalId},a.createElement(u.Form.Item,null,a.createElement("header",null,a.createElement(F(),{content:"exchange.settings.header.chart_options"})),this.props.tinyScreen?null:a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.chart_type"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_type")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"}))," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_reload")},a.createElement(u.Icon,{type:"info-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},value:e,onChange:this.props.onToggleChart.bind(this)},a.createElement(u.Select.Option,{value:"market_depth"},_().translate("exchange.order_depth")),a.createElement(u.Select.Option,{value:"price_chart"},_().translate("exchange.price_history")),a.createElement(u.Select.Option,{value:"hidden_chart"},_().translate("exchange.settings.options.hidden_chart"))))),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.chart_height"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_height")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.InputNumber,{value:"number"==typeof t&&t,onChange:this.setChartHeight.bind(this)}))),!this.props.tinyScreen&&"price_chart"==e&&a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.chart_tools"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_tools")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"}))," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_reload")},a.createElement(u.Icon,{type:"info-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.props.chartTools,onChange:this.props.onChartTools.bind(this)}))),!this.props.tinyScreen&&"price_chart"==e&&a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.chart_zoom"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_zoom")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"}))," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_reload")},a.createElement(u.Icon,{type:"info-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.props.chartZoom,onChange:this.props.onChartZoom.bind(this)}))),a.createElement("header",null,a.createElement(F(),{content:"exchange.settings.header.order_options"})),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.order_book_grouping"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.order_book_grouping")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},this.props.trackedGroupsConfig?a.createElement(tt,{globalSettingsSelector:!0,trackedGroupsConfig:this.props.trackedGroupsConfig,handleGroupOrderLimitChange:this.props.handleGroupOrderLimitChange.bind(this),currentGroupOrderLimit:this.props.currentGroupOrderLimit}):null)),!this.props.tinyScreen&&!this.props.smallScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.order_style"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.order_style")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.verticalOrderBook.toString(),onSelect:this.props.onMoveOrderBook.bind(this)},a.createElement(u.Select.Option,{value:"true"},a.createElement(F(),{content:"exchange.settings.options.vertical"})),a.createElement(u.Select.Option,{value:"false"},a.createElement(F(),{content:"exchange.settings.options.horizontal"}))))),!this.props.tinyScreen&&!this.props.verticalOrderBook||this.props.smallScreen?a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.position_order_form"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.position_order_form")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.flipBuySell.toString(),onSelect:this.props.onFlipBuySell.bind(this)},a.createElement(u.Select.Option,{value:"false"},a.createElement(F(),{content:"exchange.settings.options.position_order_form_opt1"})),a.createElement(u.Select.Option,{value:"true"},a.createElement(F(),{content:"exchange.settings.options.position_order_form_opt2"}))))):null,!this.props.tinyScreen&&!this.props.verticalOrderBook||this.props.smallScreen?a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.position_order_orders"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.position_order_orders")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.flipOrderBook.toString(),onSelect:this.props.onFlipOrderBook.bind(this)},a.createElement(u.Select.Option,{value:"false"},a.createElement(F(),{content:"exchange.settings.options.position_order_orders_opt1"})),a.createElement(u.Select.Option,{value:"true"},a.createElement(F(),{content:"exchange.settings.options.position_order_orders_opt2"}))))):null,!this.props.tinyScreen&&!this.props.verticalOrderBook||this.props.smallScreen?a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.position_order_asset"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.position_order_asset")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.buySellTop.toString(),onSelect:this.props.onToggleBuySellPosition.bind(this)},a.createElement(u.Select.Option,{value:"false"},a.createElement(F(),{content:"exchange.settings.options.position_order_asset_opt1"})),a.createElement(u.Select.Option,{value:"true"},a.createElement(F(),{content:"exchange.settings.options.position_order_asset_opt2"}))))):null,!this.props.tinyScreen&&this.props.verticalOrderBook?a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.orderbook_auto_scroll"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.orderbook_auto_scroll")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.state.autoScroll,onChange:this.setAutoscroll.bind(this)}))):null,!this.props.tinyScreen&&this.props.verticalOrderBook?a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.reverse_order_book"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.reverse_order_book")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.props.orderBookReversed,onChange:this.props.onOrderBookReversed.bind(this)}))):null,!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6",style:{paddingRight:5}},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.single_colum_order_form"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.single_colum_order_form")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.props.singleColumnOrderForm,onChange:this.props.onToggleSingleColumnOrderForm.bind(this)}))),!this.props.tinyScreen&&a.createElement("header",null,a.createElement(F(),{content:"exchange.settings.header.panel_grouping"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.panel_grouping")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"}))),!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.my_trades"}))),a.createElement("div",{className:"small-6"},this._getGroupingOptions("my_history"))),!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.market_trades"}))),a.createElement("div",{className:"small-6"},this._getGroupingOptions("history"))),!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.open_orders"}))),a.createElement("div",{className:"small-6"},this._getGroupingOptions("my_orders"))),!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},a.createElement("div",{className:"small-6"},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.settlements"}))),a.createElement("div",{className:"small-6"},this._getGroupingOptions("open_settlement"))),!this.props.tinyScreen&&a.createElement("header",null,a.createElement(F(),{content:"exchange.settings.header.general"})),!this.props.tinyScreen&&!this.props.smallScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},a.createElement("div",{className:"small-6",style:{paddingRight:5}},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.market_location"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.market_location")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Select,{placeholder:_().translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.mirrorPanels.toString(),onSelect:this.props.onMirrorPanels.bind(this)},a.createElement(u.Select.Option,{value:"false"},a.createElement(F(),{content:"settings.left"})),a.createElement(u.Select.Option,{value:"true"},a.createElement(F(),{content:"settings.right"}))))),!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6",style:{paddingRight:5}},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.reduce_scrollbars"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.reduce_scrollbars")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"}))," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.reload")},a.createElement(u.Icon,{type:"info-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.props.hideScrollbars,onChange:this.props.onToggleScrollbars.bind(this)}))),!this.props.tinyScreen&&a.createElement("div",{className:"grid-block no-overflow wrap shrink"},a.createElement("div",{className:"small-6",style:{paddingRight:5}},a.createElement("h6",{style:{margin:9}},a.createElement(F(),{content:"exchange.settings.title.hide_function_buttons"})," ",a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.hide_function_buttons")},a.createElement(u.Icon,{type:"question-circle",theme:"filled"})))),a.createElement("div",{className:"small-6"},a.createElement(u.Switch,{style:{margin:6},checked:this.props.hideFunctionButtons,onChange:this.props.onHideFunctionButtons.bind(this)})))))}}const wt=kt;var Tt=s(37385),Pt=s.n(Tt),xt=s(84743),Nt=s.n(xt),Ot=s(41321);class It{constructor(e){this.name=e.ticker,this.ticker=e.ticker;const t=(0,Ot.ML)(e.quoteAsset),s=(0,Ot.ML)(e.baseAsset);let a=t===s||t&&!s?t:!t&&s?s:`${t} / ${s}`,{name:r,prefix:i}=L.A.replaceName(e.baseAsset),{name:o,prefix:n}=L.A.replaceName(e.quoteAsset);this.description=`${n||""}${o} / ${i||""}${r} ${a?`(${a})`:""}`,this.type="bitcoin",this.session="24x7",this.timezone=Nt().tz.guess(),this.data_status="streaming",this.supported_resolutions=e.resolutions,this.has_empty_bars=!0,this.pricescale=Math.pow(10,e.baseAsset.get("precision")),this.quoteAsset=e.quoteAsset,this.baseAsset=e.baseAsset,this.minmov=1,this.has_intraday=this.supported_resolutions.reduce(((e,t)=>e||!isNaN(parseInt(t,10))),!1),this.intraday_multipliers=this.supported_resolutions.filter((e=>!isNaN(parseInt(e,10)))),this.has_seconds=this.supported_resolutions.reduce(((e,t)=>e||-1!==t.indexOf("S")),!1),this.seconds_multipliers=this.supported_resolutions.filter((e=>-1!==e.indexOf("S"))),this.has_daily=this.supported_resolutions.reduce(((e,t)=>e||-1!==t.indexOf("D")),!1),this.has_daily=this.supported_resolutions.reduce(((e,t)=>e||-1!==t.indexOf("D")),!1)}}function Lt(e,t=!1){return e.map((e=>{let s=e/60,a=s/60/24;return s<1&&!t?e+"S":a<1&&parseInt(s,10)===s&&!t?s.toString():(a=parseInt(a,10),1!==a||t?0===a?"1D":a+"D":"D")})).filter((e=>!!e))}class Bt{update(e){for(let t in e)switch(t){case"resolutions":this.supported_resolutions=Lt(e.resolutions);break;case"onMarketChange":r.A.unsubscribe("market_change"),r.A.subscribe("market_change",e[t]);break;default:this[t]=e[t]}}clearSubs(){r.A.clearSubs()}onReady(e){setTimeout((()=>{e({exchanges:[{value:"OPEN.",name:"Openledger",desc:"Openledger Gateway"}],symbols_types:[],supported_resolutions:this.supported_resolutions,supports_marks:!1,supports_search:!1,supports_time:!0})}),10)}searchSymbols(e,t,s,a){console.log("searchSymbols",e,t,s),a([])}resolveSymbol(e,t,s){let[a,r]=e.split("_");Promise.all([(0,m.FetchChain)("getAsset",a),(0,m.FetchChain)("getAsset",r)]).then((s=>{let[a,r]=s;t(new It({ticker:e,quoteAsset:a,baseAsset:r,resolutions:this.supported_resolutions}))})).catch(s)}getBars(e,t,s,a,r){let i=s.from,o=s.to,n=s.countBack,l=s.firstDataRequest;i*=1e3,o*=1e3;let c=this._getHistory();this.latestBar=c[c.length-1];let d=c.filter((e=>e.time>=i&&e.time<o));if(c=d.length>=n?d:c.filter((e=>e.time<i)).slice(d.length-n).concat(d),this.interval!==t){if(!l)return;let s="D"===(h=t)?86400:-1!==h.indexOf("W")?7*parseInt(h.replace("D",""),10)*24*60*60:-1!==h.indexOf("D")?24*parseInt(h.replace("D",""),10)*60*60:-1!==h.indexOf("S")?parseInt(h.replace("S",""),10):60*parseInt(h,10);return P.A.changeBucketSize(s),P.A.unSubscribeMarket(e.quoteAsset.get("id"),e.baseAsset.get("id")).then((()=>{P.A.subscribeMarket(e.baseAsset,e.quoteAsset,s).then((()=>{let e=this._getHistory();this.latestBar=e[e.length-1];let s=e.filter((e=>e.time>=i&&e.time<o));if(e=s.length>=n?s:e.filter((e=>e.time<i)).slice(s.length-n).concat(s),this.interval=t,!e.length)return a(e,{noData:!0});a(e)}))}))}var h;if(this.interval=t,!c.length)return a(c,{noData:!0});a(c)}_getHistory(){return r.A.getState().priceData}subscribeBars(e,t,s,a,i){r.A.unsubscribe("subscribeBars"),i(),r.A.subscribe("subscribeBars",(()=>{let e=this._getHistory(),t=e.filter((e=>!this.latestBar||e.time>this.latestBar.time));if(t.length)t.forEach((e=>{s(e)})),this.latestBar=t[t.length-1];else{let t=!1;for(let s in this.latestBar)this.latestBar[s]!==e[e.length-1][s]&&(t=!0);t&&s(e[e.length-1])}}))}unsubscribeBars(){}calculateHistoryDepth(e,t,s){}getServerTime(e){e((new Date).getTime()/1e3)}}const Ft=["America/Argentina/Buenos_Aires","America/Bogota","America/Caracas","America/Chicago","America/El_Salvador","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Almaty","Asia/Ashkhabad","Asia/Bangkok","Asia/Dubai","Asia/Hong_Kong","Asia/Kathmandu","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tehran","Asia/Tokyo","Australia/ACT","Australia/Adelaide","Australia/Brisbane","Australia/Sydney","Europe/Athens","Europe/Berlin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Warsaw","Europe/Zurich","Pacific/Auckland","Pacific/Chatham","Pacific/Fakaofo","Pacific/Honolulu","US/Mountain"];function Rt(){const e=Nt().tz.guess();if(-1!==Ft.indexOf(e))return e;{const s=Nt()().toISOString(),a=Nt().tz(s,e).format();for(var t=0;t<Ft.length;t++)if(Nt().tz(s,Ft[t]).format()===a)return Ft[t]}return console.log(`No matching timezone found for ${e}, setting to default value of Europe/London`),"Europe/London"}const Mt=s(24400);class Dt extends a.Component{constructor(e){super(),this.state={showSaveModal:!1,showLoadModal:!1,error:!1},this.layoutName=a.createRef(),this.hideModal=this.hideModal.bind(this),this.resetError=this.resetError.bind(this),this.loadLastChart=this.loadLastChart.bind(this)}loadTradingView(e){const{dataFeed:t}=e;let s=Pt()[e.theme];const a=this;if(!t)return;if(this.tvWidget)return;t.update({resolutions:e.buckets,ticker:e.quoteSymbol+"_"+e.baseSymbol,interval:Lt([e.bucketSize])[0]});let r=["symbol_info","symbol_search_hot_key","border_around_the_chart","header_symbol_search","header_compare","header_saveload","header_settings"],i=[];!this.props.mobile&&this.props.chartZoom||(r.push("chart_scroll"),r.push("chart_zoom")),this.props.mobile||!this.props.chartTools?(r.push("left_toolbar"),r.push("chart_crosshair_menu"),r.push("chart_events"),r.push("footer_share_buttons"),r.push("footer_screenshot"),r.push("timeframes_toolbar"),r.push("footer_publish_idea_button"),r.push("caption_buttons_text_if_possible"),r.push("line_tool_templates"),r.push("widgetbar_tabs"),r.push("support_manage_drawings"),r.push("support_multicharts"),r.push("right_bar_stays_on_scroll"),r.push("charts_auto_save"),r.push("edit_buttons_in_legend"),r.push("context_menus"),r.push("control_bar"),r.push("header_fullscreen_button"),r.push("header_widget"),r.push("symbollist_context_menu"),r.push("show_pro_features")):(i.push("study_templates"),i.push("keep_left_toolbar_visible_on_small_screens"));const o=e.buckets.map((e=>({text:Lt([250*e],!0)[0],resolution:Lt([e])[0]})));this.tvWidget=new Mt.widget({fullscreen:!1,symbol:e.quoteSymbol+"_"+e.baseSymbol,interval:Lt([e.bucketSize])[0],timeframe:Lt([250*e.bucketSize],!0)[0],time_frames:o,library_path:"/charting_library/",datafeed:t,container:"tv_chart",charts_storage_url:"https://saveload.tradingview.com",charts_storage_api_version:"1.1",client_id:"tradingview.com",user_id:"public_user_id",autosize:!0,locale:e.locale,timezone:Rt(),overrides:{"paneProperties.background":s.bgColor,"paneProperties.horzGridProperties.color":s.axisLineColor,"paneProperties.vertGridProperties.color":s.axisLineColor},custom_css_url:e.theme+".css",enabled_features:i,disabled_features:r,debug:!1,preset:this.props.mobile?"mobile":""}),this.tvWidget.onChartReady((()=>{let e=this.tvWidget;!this.props.mobile&&this.props.chartTools&&e.headerReady().then((()=>{const e=this.tvWidget.createButton();e.setAttribute("title",_().translate("exchange.load_custom_charts")),e.classList.add("apply-common-tooltip"),e.addEventListener("click",(()=>{a.setState({showLoadModal:!0})})),e.innerHTML=`<span>${_().translate("exchange.chart_load")}</span>`;const t=this.tvWidget.createButton();t.setAttribute("title",_().translate("exchange.save_custom_charts")),t.classList.add("apply-common-tooltip"),t.addEventListener("click",(()=>{a.setState({showSaveModal:!0})})),t.innerHTML=`<span>${_().translate("exchange.chart_save")}</span>`})),t.update({onMarketChange:this._setSymbol.bind(this)}),this.loadLastChart()})),this._onWheel=this._onWheel.bind(this)}UNSAFE_componentWillReceiveProps(e){e.marketReady&&!this.props.dataFeed&&e.dataFeed&&this.loadTradingView(e)}_setSymbol(e){this.tvWidget&&(this.tvWidget.chart().removeAllShapes(),this.loadLastChart(),this.tvWidget.setSymbol(e,Lt([this.props.bucketSize])[0]))}componentDidMount(){this.loadTradingView(this.props)}componentWillUnmount(){this.props.dataFeed.clearSubs()}shouldComponentUpdate(e,t){return t.showLoadModal!==this.state.showLoadModal||t.showSaveModal!==this.state.showSaveModal||e.chartHeight!==this.props.chartHeight||this.props.charts.size!==e.charts.size||!this.tvWidget||e.marketReady}_onWheel(e){console.log("Test wheel interception")}onSubmitConfirmation(e){const{layoutName:t}=this,s=this.props.charts.some((e=>e.key===t.current.state.value&&e.symbol===this.props.quoteSymbol+"_"+this.props.baseSymbol)),a=this;s?this.setState({error:s}):(this.resetError(),this.tvWidget.save((function(e){let s={};s.key=t.current.state.value||"",s.object=e,s.name=t.current.state.value||"",s.symbol=a.props.quoteSymbol+"_"+a.props.baseSymbol,s.modified=(new Date).toLocaleDateString("en-US"),T.A.addChartLayout(s),a.setState({showSaveModal:!1},(()=>{a.layoutName.current.state&&(a.layoutName.current.state.value=null)}))})))}hideModal(){this.resetError(),this.setState({showSaveModal:!1,showLoadModal:!1})}handleDelete(e){T.A.deleteChartLayout(e)}resetError(){this.setState({error:!1})}loadLastChart(){const{charts:e,quoteSymbol:t,baseSymbol:s}=this.props,a=e.toArray().filter((e=>e.symbol===t+"_"+s&&e.enabled));a[0]&&this.tvWidget.load(a[0].object)}render(){const{charts:e,quoteSymbol:t,baseSymbol:s}=this.props,{error:r}=this.state;let i=r?"has-error":"",o=e.toArray().filter((e=>e.symbol===t+"_"+s));const n=[{title:_().translate("exchange.layout_name"),dataIndex:"name",key:"name"},{title:_().translate("exchange.modified"),dataIndex:"modified",key:"modified"},{title:_().translate("exchange.actions"),dataIndex:"actions",key:"actions",render:(e,t)=>a.createElement(u.Icon,{style:{width:"32px"},onClick:this.handleDelete.bind(this,t.name),type:"delete"})}];return a.createElement("div",{className:"small-12"},a.createElement("div",{className:"exchange-bordered",style:{height:this.props.chartHeight+"px"},id:"tv_chart"}),a.createElement(u.Modal,{title:_().translate("exchange.load_chart_layout"),closable:!1,visible:this.state.showLoadModal,footer:[a.createElement(u.Button,{key:"cancel",onClick:this.hideModal},_().translate("modal.close"))]},a.createElement(u.Table,{dataSource:o||[],columns:n,onRow:e=>({onClick:t=>{"td"===t.target.localName?(this.hideModal(),T.A.addChartLayout(e),this.tvWidget.load(e.object)):1===t.currentTarget.parentElement.childElementCount&&this.hideModal()}})})),a.createElement(u.Modal,{title:_().translate("exchange.save_new_chart_layout"),closable:!1,visible:this.state.showSaveModal,footer:[a.createElement(u.Button,{key:"submit",type:"primary",onClick:this.onSubmitConfirmation.bind(this)},_().translate("modal.save")),a.createElement(u.Button,{key:"cancel",onClick:this.hideModal},_().translate("modal.close"))]},a.createElement("div",null,r?a.createElement("span",{className:i},a.createElement(F(),{content:"exchange.chart_error"})):null,a.createElement("span",{className:i,style:{borderBottom:"#A09F9F 1px dotted"}},a.createElement(u.Input,{placeholder:_().translate("exchange.enter_chart_layout_name"),ref:this.layoutName,onChange:this.resetError,onPressEnter:this.onSubmitConfirmation.bind(this)})))))}}const qt=(0,it.N)(Dt,{listenTo:()=>[o.A],getProps:()=>({charts:o.A.getState().chartLayouts})});var Vt=s(20903),Wt=s(58921),Ut=s.n(Wt);function zt(e){let t="";"-"==(e+="").charAt(0)&&(e=e.substring(1),t="-");let s=e.split(/[eE]/g);if(s.length<2)return t+e;let a=s[1],r=1.1.toLocaleString().substring(1,2);s=s[0].split(r);let i=s[1]||"",o=s[0];if(a>=0)a>i.length&&(i+="0".repeat(a-i.length)),i=i.slice(0,a)+r+i.slice(a),i.charAt(i.length-1)==r&&(i=i.slice(0,-1));else{let e=Math.abs(a)-o.length;e>0&&(o="0".repeat(e)+o),o=o.slice(0,a)+r+o.slice(a),o.charAt(0)==r&&(o="0"+o)}return t+(o+i).replace(/^0*(\d+|\d+\.\d+?)\.?0*$/,"$1")}class Ht extends a.Component{shouldComponentUpdate(e){let t=!isNaN(e.feedPrice)&&e.feedPrice!==this.props.feedPrice;return(0,O.Tg)(e.orders,this.props.orders)||(0,O.Tg)(e.call_orders,this.props.call_orders)||t||e.feedPrice!==this.props.feedPrice||e.height!==this.props.height||e.isPanelActive!==this.props.isPanelActive||e.activePanels!==this.props.activePanels||e.LCP!==this.props.LCP||e.showCallLimit!==this.props.showCallLimit||e.hasPrediction!==this.props.hasPrediction||e.feedPrice!==this.props.feedPrice||e.marketReady!==this.props.marketReady}componentDidMount(){this.reflowChart(500)}UNSAFE_componentWillReceiveProps(e){this.refs.depthChart&&e.activePanels!==this.props.activePanels&&this.reflowChart(100)}UNSAFE_componentWillUpdate(){this.props.centerRef&&(this.tempScroll=this.props.centerRef.scrollTop)}componentDidUpdate(){this.props.centerRef&&(this.props.centerRef.scrollTop=this.tempScroll)}reflowChart(e){setTimeout((()=>{this.refs.depthChart&&this.refs.depthChart.chart.reflow()}),e)}_getThemeColors(e=this.props){return Pt()[e.theme]}render(){let{flat_bids:e,flat_asks:t,flat_calls:s,flat_settles:r,totalBids:i,totalAsks:o,base:n,quote:l,feedPrice:c}=this.props;const{primaryText:d,callColor:h,settleColor:p,settleFillColor:m,bidColor:u,bidFillColor:g,askColor:b,askFillColor:y,axisLineColor:f}=this._getThemeColors();let{name:C,prefix:S}=L.A.replaceName(n),{name:A,prefix:v}=L.A.replaceName(l);C=(S||"")+C,A=(v||"")+A;let E=(0,Vt.A)(e),k=(0,Vt.A)(t),w=(0,Vt.A)(s),T=(0,Vt.A)(r),P={chart:{type:"area",backgroundColor:"rgba(255, 0, 0, 0)",spacing:[10,0,5,0]},title:{text:null},credits:{enabled:!1},legend:{enabled:!1},rangeSelector:{enabled:!1},navigator:{enabled:!1},scrollbar:{enabled:!1},dataGrouping:{enabled:!1},tooltip:{shared:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",useHTML:!0,formatter:function(){return`\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>${_().translate("exchange.price")}:</td>\n\t\t\t\t\t\t\t<td style="text-align: right">${L.A.format_number(this.x,n.get("precision"))} ${C}/${A}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>${_().translate("exchange.quantity")}:</td>\n\t\t\t\t\t\t\t<td style="text-align: right">${L.A.format_number(this.y,l.get("precision"))} ${A}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t`},style:{color:"#FFFFFF"}},series:[],yAxis:{labels:{enabled:!0,style:{color:d},formatter:function(){return L.A.format_number(this.value,l.get("precision"))}},opposite:!1,title:{text:null,style:{color:"#FFFFFF"}},gridLineWidth:1,gridLineColor:"rgba(196, 196, 196, 0.30)",gridZIndex:1,crosshair:{snap:!1},currentPriceIndicator:{enabled:!1}},xAxis:{labels:{style:{color:d},formatter:function(){return zt(this.value)}},ordinal:!1,lineColor:"#000000",title:{text:null},plotLines:[]},plotOptions:{area:{animation:!1,marker:{enabled:!1},series:{enableMouseTracking:!1}}}};if(E.length>0&&k.length>0){let e=(k[0][0]+E[E.length-1][0])/2;P.xAxis.min=.4*e,P.xAxis.max=1.6*e,P.xAxis.max<k[0][0]&&(P.xAxis.max=1.5*k[0][0]),P.xAxis.min>E[E.length-1][0]&&(P.xAxis.min=.5*E[E.length-1][0]);let t=0;E.forEach((e=>{e[0]>=P.xAxis.min&&(t=Math.max(e[1],t))})),k.forEach((e=>{e[0]<=P.xAxis.max&&(t=Math.max(e[1],t))})),P.yAxis.max=1.15*t;let s=t>10?0:t>1?2:5;P.yAxis.labels.formatter=function(){return L.A.format_number(this.value,s)}}else E.length&&!k.length?(P.xAxis.min=.4*E[E.length-1][0],P.xAxis.max=1.6*E[E.length-1][0]):k.length&&!E.length&&(P.xAxis.min=0,P.xAxis.max=2*k[0][0]);if(this.props.hasPrediction&&(P.xAxis.min=-.05,P.xAxis.max=1.05),this.props.LCP){let e=n.get("bitasset_data_id")?n:l,t=e.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3,s=e.getIn(["bitasset","current_feed","maximum_short_squeeze_ratio"])/1e3,a=this.props.invertedCalls?this.props.LCP/t*s:this.props.LCP*t/s;P.xAxis.plotLines.push({color:f,id:"plot_line",dashStyle:"longdash",value:this.props.LCP,label:{text:_().translate("explorer.block.call_limit",{price:this.props.LCP.toFixed(4)}),style:{color:d,fontWeight:"bold"},x:this.props.invertedCalls?5:-10},width:2,zIndex:5}),P.xAxis.plotLines.push({color:f,id:"plot_line",dashStyle:"longdash",value:a,label:{text:_().translate("explorer.block.gs_support",{price:a.toFixed(4)}),style:{color:d,fontWeight:"bold"},x:this.props.invertedCalls?-10:5},width:2,zIndex:5})}if(c){const e=n.has("bitasset")?b:u;P.xAxis.plotLines.push({color:e,id:"plot_line",dashStyle:"solid",value:c,label:{text:_().translate("explorer.block.feed_price",{price:c.toFixed(4)}),style:{color:d,fontWeight:"bold"},x:this.props.invertedCalls?5:-10},width:2,zIndex:5}),w&&w.length&&P.series.push({name:`Call ${A}`,data:w,color:h})}return c&&T&&T.length&&P.series.push({name:`Settle ${A}`,data:T,color:p,fillColor:m}),E.length&&P.series.push({step:"right",name:`Bid ${A}`,data:E,color:u,fillColor:g}),k.length&&P.series.push({step:"left",name:`Ask ${A}`,data:k,color:b,fillColor:y}),this.props.height?P.chart.height=this.props.height:P.chart.height="400px",this.props.onClick&&(P.chart.events={click:this.props.onClick.bind(this)}),this.props.noFrame?a.createElement("div",{className:"grid-content no-overflow no-padding"},E.length||k.length||w.length?null:a.createElement("span",{className:"no-data"},a.createElement(F(),{content:"exchange.no_data"})),this.props.noText?null:a.createElement("p",{className:"bid-total"},L.A.format_number(i,n.get("precision"))," ",C),this.props.noText?null:a.createElement("p",{className:"ask-total"},L.A.format_number(o,l.get("precision"))," ",A),E||k||w?a.createElement(Ut(),{config:P}):null):a.createElement("div",{className:"grid-content no-overflow no-padding middle-content"},a.createElement("div",{className:"exchange-bordered",id:"depth_chart"},a.createElement("div",{className:"exchange-content-header"},this.props.noText?null:a.createElement("span",{className:"bid-total"},L.A.format_number(i,n.get("precision"))," ",a.createElement(W.A,{name:n.get("symbol")})),this.props.noText?null:a.createElement("span",{className:"ask-total float-right"},L.A.format_number(o,l.get("precision"))," ",a.createElement(W.A,{name:l.get("symbol")}))),E.length||k.length||w.length?null:a.createElement("span",{className:"no-data"},a.createElement(F(),{content:"exchange.no_data"})),E||k||w?a.createElement(Ut(),{ref:"depthChart",config:P}):null))}}Ht.defaultProps={flat_bids:[],flat_asks:[],orders:{},noText:!1,noFrame:!0},Ht.propTypes={flat_bids:w().array.isRequired,flat_asks:w().array.isRequired,orders:w().object.isRequired};const jt=Ht;var $t=s(40702),Gt=s(35277),Kt=s(41223),Qt=s.n(Kt),Jt=s(54392),Yt=s.n(Jt),Zt=s(35917);let{operations:Xt}=m.ChainTypes,es=Object.keys(Xt);class ts extends a.Component{static propTypes={account:M.A.ChainAccount.isRequired};UNSAFE_componentWillReceiveProps(e){if(e.account&&e.account.size&&this.props.account&&this.props.account.get("history")){let t=this.props.account.get("history")&&this.props.account.get("history").first()?this.props.account.get("history").first().toJS():null,s=e.account.get("history")&&e.account.get("history").first()?e.account.get("history").first().toJS():null;s&&t&&"fill_order"===es[s.op[0]]&&(!t&&s.id||s.id!==t.id)&&(Yt().publish("account-notify","open"),setTimeout((function(){Yt().publish("account-notify","close")}),5e3))}}shouldComponentUpdate(e){return!(!e.account||!this.props.account||rt().is(e.account.get("history"),this.props.account.get("history"))&&rt().is(e.account,this.props.account))}render(){let e,t,{account:s}=this.props;return s?(this.props.account.get("history")&&this.props.account.get("history").size&&(e=this.props.account.get("history").first().toJS(),e&&(t=a.createElement(Zt.A,{key:e.id,op:e.op,result:e.result,block:e.block_num,current:s.get("id"),hideDate:!0,hideFee:!0}))),e?a.createElement(Qt().Static,{id:"account-notify",title:null,image:"",wrapperElement:"div"},a.createElement("table",{className:"table"},a.createElement("tbody",null,t))):a.createElement("div",null)):a.createElement("div",null)}}const ss=ts=(0,D.A)(ts);class as extends a.Component{render(){return a.createElement(d.A,{stores:[i.A],inject:{account:()=>i.A.getState().currentAccount}},a.createElement(ss,null))}}const rs=as;var is=s(99429),os=s(52550),ns=s(21561),ls=s(6356),cs=s(18450),ds=s(45964),hs=s(84181),ps=s(48287).Buffer;function ms(){return ms=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ms.apply(this,arguments)}class us extends ls.x{static propTypes={balance:M.A.ChainObject,sender:M.A.ChainAccount.isRequired,asset:M.A.ChainAsset.isRequired,coreAsset:M.A.ChainAsset.isRequired,globalObject:M.A.ChainAsset.isRequired};static defaultProps={coreAsset:"1.3.0",globalObject:"2.0.0"};constructor(e){super(),this.state={toAddress:os.fH.getLast(e.walletType),withdrawValue:"",amountError:null,symbol:e.asset.get("symbol"),to_withdraw:new O.Vd({asset_id:e.asset.get("id"),precision:e.asset.get("precision")}),feeAsset:{asset_id:m.ChainStore.assets_by_symbol.get(e.fee_asset_symbol)||"1.3.0",amount:0},loading:!1,emptyAddressDeposit:!1},this._validateAddress(this.state.toAddress,e),this.addDepositAddress=this.addDepositAddress.bind(this),this._checkBalance=this._checkBalance.bind(this),this._getCurrentBalance=this._getCurrentBalance.bind(this)}UNSAFE_componentWillMount(){this._getDepositAddress()}UNSAFE_componentWillReceiveProps(e){e.asset&&this.props.asset&&e.asset.get("id")!==this.props.asset.get("id")&&this.setState({to_withdraw:new O.Vd({asset_id:e.asset.get("id"),precision:e.asset.get("precision")}),gateFee:e.asset.get("gateFee"),intermediateAccount:e.asset.get("intermediateAccount"),symbol:e.asset.get("symbol"),memo:"",withdrawValue:"",receive_address:null,toAddress:os.fH.getLast(e.walletType)},this._getDepositAddress)}_getDepositAddress(){if(!this.props.backingCoinType)return;let e=(0,os.rZ)({coin:`open.${this.props.backingCoinType.toLowerCase()}`,account:this.props.account,stateCallback:this.addDepositAddress});e?this.setState({receive_address:e}):(0,os.e4)(this._getDepositObject())}_getDepositObject(){return{inputCoinType:this.props.backingCoinType.toLowerCase(),outputCoinType:this.props.symbol.toLowerCase(),outputAddress:this.props.sender.get("name"),stateCallback:this.addDepositAddress}}requestDepositAddressLoad(){this.setState({loading:!0,emptyAddressDeposit:!1}),(0,os.e4)(this._getDepositObject())}addDepositAddress(e){e.error&&("no_address"===e.error.message?this.setState({emptyAddressDeposit:!0}):this.setState({emptyAddressDeposit:!1})),this.setState({receive_address:e,loading:!1})}componentDidUpdate(){$.A.rebuild()}getMemo(){return this.props.backingCoinType.toLowerCase()+":"+this.state.toAddress+(this.state.memo?":"+new ps(this.state.memo,"utf-8"):"")}onSubmit(e){if(e.preventDefault(),0===this.state.to_withdraw.getAmount())return this.setState({amountError:"transfer.errors.pos"});if(!this.props.intermediateAccount)return;const t=this.state.feeAsset,s=this._getGateFee();let a=this.state.to_withdraw.clone(),r=a.clone(this._getCurrentBalance().get("balance"));a.plus(s),r.lt(a)&&(a=this.state.to_withdraw.clone()),is.A.transfer(this.props.sender.get("id"),this.props.intermediateAccount,this.state.to_withdraw.getAmount(),this.state.to_withdraw.asset_id,this.getMemo(),null,t.asset_id)}_updateAmount(){const{feeAsset:e}=this.state,t=this._getCurrentBalance();let s=new O.Vd({amount:t?t.get("balance"):0,asset_id:this.props.asset.get("id"),precision:this.props.asset.get("precision")});s.asset_id===e.asset_id&&s.minus(e),this.state.to_withdraw.setAmount({sats:s.getAmount()}),this.setState({withdrawValue:s.getAmount({real:!0}),amountError:null},this._checkBalance)}_getCurrentBalance(){let e=this.props.balance?[m.ChainStore.getObject(this.props.balance)]:this.props.balances;return e?e.find((e=>e&&e.get("asset_type")===this.props.asset.get("id"))):null}_checkBalance(){const{feeAsset:e,to_withdraw:t}=this.state,{asset:s}=this.props,a=this._getCurrentBalance();if(!a||!e)return;const r=(0,I.rT)(t.getAmount({real:!0}),s,e,a,this._getGateFee());return null!==r?(this.state.balanceError!==!r&&this.setState({balanceError:!r}),r):void 0}_onInputAmount(e){try{this.state.to_withdraw.setAmount({real:parseFloat(e.target.value||0)}),this.setState({withdrawValue:e.target.value,amountError:null},this._checkBalance)}catch(e){console.error("err:",e)}}_onInputTo(e){let t=e.target.value.trim();this.setState({withdraw_address_check_in_progress:!0,withdraw_address_selected:t,validAddress:null,toAddress:t}),this._validateAddress(t)}_onMemoChanged(e){this.setState({memo:e.target.value})}_validateAddress(e,t=this.props){(0,os.jl)({url:cs.TH.BASE,walletType:t.walletType,newAddress:e}).then((t=>{this.state.toAddress===e&&this.setState({withdraw_address_check_in_progress:!1,validAddress:!!t})})).catch((e=>{console.error("Error when validating address:",e)}))}_openRegistrarSite(e){e.preventDefault(),window.open(o.A.site_registr,"_blank").opener=null}_getGateFee(){const{gateFee:e,asset:t}=this.props;return new O.Vd({real:parseFloat(e?e.replace(",",""):0),asset_id:t.get("id"),precision:t.get("precision")})}onFeeChanged(e){this.setState({feeAsset:e})}_renderWithdraw(){const{amountError:e,toAddress:t,memo:s,feeAsset:r,balanceError:i,withdrawValue:o,validAddress:n}=this.state,{supportsMemos:l,asset:c,account:d}=this.props,{name:h}=L.A.replaceName(c);let p=1;const m=r,g=this.getMemo(),b=!m||i||!t||!o;return a.createElement("div",null,a.createElement("p",null,a.createElement(F(),{content:"gateway.withdraw_funds",asset:h,wallet_name:(0,ds.vj)()})),this._renderCurrentBalance(),a.createElement("div",{className:"SimpleTrade__withdraw-row"},a.createElement("label",{className:"left-label"},_().translate("modal.withdraw.amount")),a.createElement("div",{className:"inline-label input-wrapper"},a.createElement("input",{tabIndex:p++,type:"number",min:"0",onKeyPress:this.onKeyPress.bind(this),value:o,onChange:this._onInputAmount.bind(this)}),a.createElement("div",{className:"form-label select floating-dropdown"},a.createElement("div",{className:"dropdown-wrapper inactive"},a.createElement("div",null,h)))),e?a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},a.createElement(F(),{content:e})):null,this.state.balanceError?a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},a.createElement(F(),{content:"transfer.errors.insufficient"})):null),a.createElement("div",{className:"SimpleTrade__withdraw-row withdraw-fee-selector"},a.createElement(hs.A,{label:"showcases.barter.fee_when_proposal_executes",account:d,transaction:{type:"transfer",options:["price_per_kbyte"],data:{type:"memo",content:g}},onChange:this.onFeeChanged.bind(this)})),a.createElement("div",{className:"SimpleTrade__withdraw-row"},a.createElement("label",{className:"left-label"},_().translate("modal.withdraw.address")),a.createElement("div",{className:"inline-label input-wrapper"},a.createElement("input",{placeholder:_().translate("gateway.withdraw_placeholder",{asset:h}),tabIndex:p++,type:"text",value:t,onChange:this._onInputTo.bind(this)}),a.createElement("div",{className:"form-label select floating-dropdown"},a.createElement("div",{className:"dropdown-wrapper inactive"},a.createElement(u.Tooltip,{placement:"right",title:_().translate("tooltip.withdraw_address",{asset:h})},"?")))),!n&&t?a.createElement("div",{className:"has-error",style:{paddingTop:10}},a.createElement(F(),{content:"gateway.valid_address",coin_type:h})):null),l?a.createElement("div",{className:"SimpleTrade__withdraw-row"},a.createElement("label",{className:"left-label"},_().translate("transfer.memo")),a.createElement("div",{className:"inline-label input-wrapper"},a.createElement("textarea",{rows:"3",value:s,tabIndex:p++,onChange:this._onMemoChanged.bind(this)})),!n&&t?a.createElement("div",{className:"has-error",style:{paddingTop:10}},a.createElement(F(),{content:"gateway.valid_address",coin_type:h})):null):null,a.createElement("div",{className:"button-group SimpleTrade__withdraw-row"},a.createElement("button",{tabIndex:p++,className:"button"+(b?" disabled":""),onClick:this.onSubmit.bind(this),type:"submit"},a.createElement(F(),{content:"gateway.withdraw_now"}))))}_renderDeposit(){const{receive_address:e,loading:t,emptyAddressDeposit:s}=this.state,{name:r}=L.A.replaceName(this.props.asset),i=e&&"memo"in e&&e.memo,o=e&&e.address||"";let n=1;return a.createElement("div",{className:o?"":"no-overflow"},a.createElement("p",null,a.createElement(F(),{unsafe:!0,content:"gateway.add_funds",account:this.props.sender.get("name"),wallet_name:(0,ds.vj)()})),this._renderCurrentBalance(),a.createElement("div",{className:"SimpleTrade__withdraw-row"},a.createElement(u.Tooltip,{placement:"right",title:_().translate("tooltip.deposit_tip",{asset:r})},a.createElement("p",{style:{marginBottom:10}},a.createElement(F(),{className:"help-tooltip",content:"gateway.deposit_to",asset:r}),":",a.createElement("label",{className:"fz_12 left-label"},a.createElement(F(),{content:"gateway.deposit_notice_delay"})))),o?a.createElement("label",null,s?a.createElement(F(),{content:"gateway.please_generate_address"}):a.createElement("span",{className:"inline-label"},a.createElement("input",{readOnly:!0,type:"text",value:o}),a.createElement(ns.A,{text:o})," ")):a.createElement($t.A,{type:"three-bounce"}),i?a.createElement("label",null,a.createElement("span",{className:"inline-label"},a.createElement("input",{readOnly:!0,type:"text",value:_().translate("transfer.memo")+": "+e.memo}),a.createElement(ns.A,{text:e.memo}))):null,e&&e.error?a.createElement("div",{className:"has-error",style:{paddingTop:10}},e.error.message):null),a.createElement("div",{className:"button-group SimpleTrade__withdraw-row"},a.createElement("button",{tabIndex:n++,className:"button spinner-button-circle",onClick:this.requestDepositAddressLoad.bind(this),type:"submit"},t?a.createElement($t.A,{type:"circle"}):null,a.createElement(F(),{content:"gateway.generate_new"}))))}_renderCurrentBalance(){const{name:e}=L.A.replaceName(this.props.asset),t="deposit"===this.props.action;let s=this._getCurrentBalance(),r=s?new O.Vd({asset_id:s.get("asset_type"),precision:this.props.asset.get("precision"),amount:s.get("balance")}):null;const i=t?a.createElement("span",{style:{border:"2px solid black",borderLeft:"none"},className:"form-label"},e):a.createElement(u.Tooltip,{placement:"right",title:_().translate("tooltip.withdraw_full")},a.createElement("button",{className:"button",style:{border:"2px solid black",borderLeft:"none"},onClick:this._updateAmount.bind(this,s?parseInt(s.get("balance"),10):0)},a.createElement(H.A,{name:"clippy",title:"icons.clippy.withdraw_full"})));return a.createElement("div",{className:"SimpleTrade__withdraw-row",style:{fontSize:"1rem"}},a.createElement("label",{style:{fontSize:"1rem"}},_().translate("gateway.balance_asset",{asset:e}),":",a.createElement("span",{className:"inline-label"},a.createElement("input",{disabled:!0,style:{color:"black",border:"2px solid black",padding:10,width:"100%"},value:r?r.getAmount({real:!0}):0}),i)))}render(){let{asset:e,action:t}=this.props,s="deposit"===t;if(!e)return null;const{name:r}=L.A.replaceName(e);let i=this.props.isDown?a.createElement("div",null,a.createElement(F(),{className:"txtlabel cancel",content:"gateway.unavailable_OPEN",component:"p"})):this.props.isAvailable?s?this._renderDeposit():this._renderWithdraw():a.createElement("div",null,a.createElement(F(),{className:"txtlabel cancel",content:"gateway.unavailable",component:"p"}));return a.createElement("div",{className:"SimpleTrade__modal"},a.createElement("div",{className:"grid-block vertical no-overflow",style:{zIndex:1002,paddingLeft:"2rem",paddingRight:"2rem",paddingTop:"1rem"}},i))}}us=(0,it.N)(us,{listenTo:()=>[o.A],getProps:e=>({fee_asset_symbol:o.A.getState().settings.get("fee_asset")})}),us=(0,D.A)(us);class gs extends a.Component{constructor(){super(),this.state={open:!1}}show(){this.setState({open:!0},(()=>{Yt().publish(this.props.modalId,"open")}))}onClose(){this.setState({open:!1})}render(){const e="deposit"===this.props.action?_().translate("gateway.deposit"):_().translate("modal.withdraw.submit");return a.createElement(u.Modal,{title:e,footer:[],visible:this.props.visible,onCancel:this.props.hideModal,className:"test",onClose:this.onClose.bind(this),overlay:!0,id:this.props.modalId},this.props.visible?a.createElement(us,ms({},this.props,{open:this.props.visible})):null)}}var bs=s(15255),ys=s(60819);class _s extends a.Component{constructor(e){super(e),this.state={rules:[]},this.handleSave=this.handleSave.bind(this),this.handleAddRule=this.handleAddRule.bind(this),this.handleTypeChange=this.handleTypeChange.bind(this),this.handleDeleteRule=this.handleDeleteRule.bind(this),this.handlePriceChange=this.handlePriceChange.bind(this),this.handlePriceFieldBlur=this.handlePriceFieldBlur.bind(this)}componentDidUpdate(e){if(!e.visible&&this.props.visible){let e={type:Q.zD.HIGHER_THAN,price:this.props.latestPrice?Number(this.props.latestPrice):null},t=[];t=this.props.rules.length?this.props.rules:this.state.openedPreviously?[]:[e],this.setState({rules:t,openedPreviously:!0})}}handleTypeChange(e){return t=>{let s=this.state.rules.map(((s,a)=>{if(Number(e)!==Number(a))return s;let r=this.validatePrice(t,Number(s.price),Number(this.props.latestPrice));return{...s,...r,type:String(t)}}));this.setState({rules:s})}}validatePrice(e,t,s){return e===Q.zD.HIGHER_THAN&&t<s?{validateStatus:"error",help:"Price of Alert should be higher than current price"}:e===Q.zD.LOWER_THAN&&t>s?{validateStatus:"error",help:"Price of Alert  should be lower than current price"}:{validateStatus:"success",help:""}}validatePriceFieldByKey(e){let t=this.state.rules.map(((t,s)=>{if(Number(e)!==Number(s))return t;const a=this.validatePrice(t.type,Number(t.price),Number(this.props.latestPrice));return{...t,validateStatus:a.validateStatus,help:a.help}}));this.setState({rules:t})}handlePriceFieldBlur(e){return()=>{this.validatePriceFieldByKey(e)}}handlePriceChange(e){return t=>{let s=this.state.rules.map(((s,a)=>{if(Number(e)!==Number(a))return s;let r={};return s.validateStatus&&(r=this.validatePrice(s.type,Number(t.target.value),Number(this.props.latestPrice))),{...s,...r,price:t.target.value}}));this.setState({rules:s})}}handleAddRule(){let e=[...this.state.rules];e.push({type:Q.zD.HIGHER_THAN,price:this.props.latestPrice?Number(this.props.latestPrice):null}),this.setState({rules:e})}handleDeleteRule(e){return()=>{let t=this.state.rules.filter(((t,s)=>Number(s)!==Number(e)));this.setState({rules:t})}}handleSave(){this.props.onSave(this.state.rules)}render(){if(!(this.props.quoteAsset&&this.props.quoteAsset.get&&this.props.baseAsset&&this.props.baseAsset.get))return null;const e=[a.createElement(u.Button,{key:"submit",type:"primary",onClick:this.handleSave},_().translate("modal.save")),a.createElement(u.Button,{key:"cancel",onClick:this.props.hideModal},_().translate("modal.cancel"))],t=this.props.baseAsset.get("symbol"),s=this.props.quoteAsset.get("symbol"),r=`${s}_${t}`;return a.createElement(u.Modal,{visible:this.props.visible,onCancel:this.props.hideModal,title:_().translate("exchange.price_alert.title"),footer:e},a.createElement("div",{className:"exchange--price-alert"},a.createElement("div",{className:"exchange--price-alert--description"},this.state.rules.length?a.createElement("div",null,_().translate("exchange.price_alert.alert_when")," ",a.createElement(we.N_,{to:r},a.createElement(W.A,{name:s}),"/",a.createElement(W.A,{name:t}))," ","price:"):a.createElement("div",null,_().translate("exchange.price_alert.use_button"),a.createElement(we.N_,{to:r},a.createElement(W.A,{name:s}),"/",a.createElement(W.A,{name:t})),":"),a.createElement(u.Form,{layout:"vertical"},a.createElement("div",{className:"exchange--price-alert--items"},this.state.rules.map(((e,s)=>a.createElement(u.Form.Item,{key:s,validateStatus:e.validateStatus||null,help:e.help||null},a.createElement(u.Input.Group,{className:"exchange--price-alert--item",compact:!0},a.createElement(u.Select,{value:e.type,style:{width:"200px"},onChange:this.handleTypeChange(s)},a.createElement(u.Select.Option,{value:Q.zD.HIGHER_THAN,key:"1"},_().translate("exchange.price_alert.higher_than")),a.createElement(u.Select.Option,{value:Q.zD.LOWER_THAN,key:"2"},_().translate("exchange.price_alert.lower_than"))),a.createElement(u.Input,{onBlur:this.handlePriceFieldBlur(s),style:{width:"calc(100% - 200px - 32px)",marginTop:"1px"},onChange:this.handlePriceChange(s),value:e.price,className:"exchange--price-alert--item--price",placeholder:_().translate("exchange.price_alert.price"),addonAfter:a.createElement(W.A,{name:t})}),a.createElement(u.Button,{style:{width:"32px"},onClick:this.handleDeleteRule(s),className:"exchange--price-alert--item--control",type:"icon",icon:"delete"})))))),a.createElement("div",{className:"exchange--price-alert--items--add"},a.createElement("a",{href:"javascript:void(0)",onClick:this.handleAddRule},a.createElement(u.Icon,{type:"plus"})," ",_().translate("exchange.price_alert.add_rule")))))))}}const fs=_s=(0,ys.A)(_s,{propNames:["quoteAsset","baseAsset"]});function Cs(){return Cs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Cs.apply(this,arguments)}class Ss extends a.Component{static propTypes={marketCallOrders:w().object.isRequired,activeMarketHistory:w().object.isRequired,viewSettings:w().object.isRequired};static defaultProps={marketCallOrders:[],activeMarketHistory:{},viewSettings:{}};constructor(e){super(),this.state={...this._initialState(e),expirationType:{bid:e.exchange.getIn(["lastExpiration","bid"])||"YEAR",ask:e.exchange.getIn(["lastExpiration","ask"])||"YEAR"},expirationCustomTime:{bid:"Specific",ask:"Specific"},feeStatus:{}},this._getWindowSize=(0,h.A)(this._getWindowSize.bind(this),150),this._checkFeeStatus=this._checkFeeStatus.bind(this),this._handleExpirationChange=this._handleExpirationChange.bind(this),this._handleCustomExpirationChange=this._handleCustomExpirationChange.bind(this),this.showPersonalizeModal=this.showPersonalizeModal.bind(this),this.hidePersonalizeModal=this.hidePersonalizeModal.bind(this),this.showConfirmSellOrderModal=this.showConfirmSellOrderModal.bind(this),this.hideConfirmSellOrderModal=this.hideConfirmSellOrderModal.bind(this),this.showConfirmBuyOrderModal=this.showConfirmBuyOrderModal.bind(this),this.hideConfirmBuyOrderModal=this.hideConfirmBuyOrderModal.bind(this),this.showMarketPickerModal=this.showMarketPickerModal.bind(this),this.hideMarketPickerModal=this.hideMarketPickerModal.bind(this),this.showDepositBridgeModal=this.showDepositBridgeModal.bind(this),this.hideDepositBridgeModal=this.hideDepositBridgeModal.bind(this),this.showDepositModal=this.showDepositModal.bind(this),this.hideDepositModal=this.hideDepositModal.bind(this),this.showBorrowQuoteModal=this.showBorrowQuoteModal.bind(this),this.hideBorrowQuoteModal=this.hideBorrowQuoteModal.bind(this),this.showBorrowBaseModal=this.showBorrowBaseModal.bind(this),this.hideBorrowBaseModal=this.hideBorrowBaseModal.bind(this),this.showPriceAlertModal=this.showPriceAlertModal.bind(this),this.hidePriceAlertModal=this.hidePriceAlertModal.bind(this),this.showScaledOrderModal=this.showScaledOrderModal.bind(this),this.hideScaledOrderModal=this.hideScaledOrderModal.bind(this),this.handlePriceAlertSave=this.handlePriceAlertSave.bind(this),this._createScaledOrder=this._createScaledOrder.bind(this),this.psInit=!0}handleOrderTypeTabChange(e,t){T.A.changeViewSetting({[`order-form-${e}`]:t})}handlePriceAlertSave(e=[]){e=e.map((e=>({type:e.type,price:e.price,baseAssetSymbol:this.props.baseAsset.get("symbol"),quoteAssetSymbol:this.props.quoteAsset.get("symbol")})));let t=this.props.priceAlert.filter((e=>e&&this.props.baseAsset&&this.props.quoteAsset&&(e.get("baseAssetSymbol")!==this.props.baseAsset.get("symbol")||e.get("quoteAssetSymbol")!==this.props.quoteAsset.get("symbol"))));t=[...t,...e],T.A.setPriceAlert(t),this.hidePriceAlertModal()}getPriceAlertRules(){return this.props.priceAlert.filter((e=>e&&this.props.baseAsset&&this.props.quoteAsset&&e.get("baseAssetSymbol")===this.props.baseAsset.get("symbol")&&e.get("quoteAssetSymbol")===this.props.quoteAsset.get("symbol"))).toJS()}_handleExpirationChange(e,t){let s={...this.state.expirationType,[e]:t.target.value};"SPECIFIC"!==t.target.value&&T.A.setExchangeLastExpiration({...this.props.exchange.has("lastExpiration")&&this.props.exchange.get("lastExpiration").toJS()||{},[e]:t.target.value}),this.setState({expirationType:s})}_handleCustomExpirationChange(e,t){let s={...this.state.expirationCustomTime,[e]:t};this.setState({expirationCustomTime:s})}EXPIRATIONS={HOUR:{title:"1 hour",get:()=>A()().add(1,"hour").valueOf()},"12HOURS":{title:"12 hours",get:()=>A()().add(12,"hour").valueOf()},"24HOURS":{title:"24 hours",get:()=>A()().add(1,"day").valueOf()},"7DAYS":{title:"7 days",get:()=>A()().add(7,"day").valueOf()},MONTH:{title:"30 days",get:()=>A()().add(30,"day").valueOf()},YEAR:{title:"1 year",get:()=>A()().add(1,"year").valueOf()},SPECIFIC:{title:"Specific",get:e=>this.state.expirationCustomTime[e].valueOf()}};_initialOrderState(e){let t={forSaleText:"",toReceiveText:"",priceText:"",for_sale:new O.Vd({asset_id:e.baseAsset.get("id"),precision:e.baseAsset.get("precision")}),to_receive:new O.Vd({asset_id:e.quoteAsset.get("id"),precision:e.quoteAsset.get("precision")})};t.price=new O.gm({base:t.for_sale,quote:t.to_receive});let s={forSaleText:"",toReceiveText:"",priceText:"",for_sale:new O.Vd({asset_id:e.quoteAsset.get("id"),precision:e.quoteAsset.get("precision")}),to_receive:new O.Vd({asset_id:e.baseAsset.get("id"),precision:e.baseAsset.get("precision")})};return s.price=new O.gm({base:s.for_sale,quote:s.to_receive}),{ask:s,bid:t}}_initialState(e){let t=e.viewSettings,{ask:s,bid:a}=this._initialOrderState(e),r=t.get("chartHeight",620);return 620==r&&window.innerWidth<640&&(r=425),{isDepositBridgeModelLoaded:!1,isDepositModalLoaded:!1,isPersonalizeModalLoaded:!1,isMarketPickerModalLoaded:!1,isBorrowQuoteModalLoaded:!1,isBorrowBaseModalLoaded:!1,isDepositBridgeModalVisible:!1,isDepositModalVisible:!1,isPersonalizeModalVisible:!1,isMarketPickerModalVisible:!1,isBorrowQuoteModalVisible:!1,isBorrowBaseModalVisible:!1,history:[],isConfirmBuyOrderModalVisible:!1,isConfirmBuyOrderModalLoaded:!1,isConfirmSellOrderModalVisible:!1,isPriceAlertModalVisible:!1,isScaledOrderModalVisible:!1,isConfirmSellOrderModalLoaded:!1,tabVerticalPanel:t.get("tabVerticalPanel","my-market"),tabBuySell:t.get("tabBuySell","buy"),buySellOpen:t.get("buySellOpen",!0),bid:a,ask:s,height:window.innerHeight,width:window.innerWidth,favorite:!1,buyDiff:!1,sellDiff:!1,autoScroll:t.get("global_AutoScroll",!0),buySellTop:t.get("buySellTop",!0),buyFeeAssetIdx:t.get("buyFeeAssetIdx",0),sellFeeAssetIdx:t.get("sellFeeAssetIdx",0),verticalOrderBook:t.get("verticalOrderBook",!1),verticalOrderForm:t.get("verticalOrderForm",!1),hidePanel:t.get("hidePanel",!1),hideScrollbars:t.get("hideScrollbars",!1),singleColumnOrderForm:t.get("singleColumnOrderForm",!0),flipOrderBook:t.get("flipOrderBook",!1),flipBuySell:t.get("flipBuySell",!1),orderBookReversed:t.get("orderBookReversed",!1),chartType:t.get("chartType","price_chart"),chartHeight:r,chartZoom:t.get("chartZoom",!0),chartTools:t.get("chartTools",!1),hideFunctionButtons:t.get("hideFunctionButtons",!0),currentPeriod:t.get("currentPeriod",7776e3),showMarketPicker:!1,activePanels:t.get("activePanels",["left","right"]),mobileKey:[""],forceReRender:0,panelWidth:0,mirrorPanels:t.get("mirrorPanels",!1),panelTabs:t.get("panelTabs",{my_history:1,history:1,my_orders:2,open_settlement:2}),panelTabsActive:t.get("panelTabsActive",{1:"my_history",2:"my_orders"})}}showMarketPickerModal(){this.setState({isMarketPickerModalVisible:!0,isMarketPickerModalLoaded:!0})}hideMarketPickerModal(){this.setState({isMarketPickerModalVisible:!1})}showPersonalizeModal(){this.setState({isPersonalizeModalVisible:!0,isPersonalizeModalLoaded:!0})}hidePersonalizeModal(){this.setState({isPersonalizeModalVisible:!1})}showPriceAlertModal(){this.setState({isPriceAlertModalVisible:!0})}hidePriceAlertModal(){this.setState({isPriceAlertModalVisible:!1})}showScaledOrderModal(){this.setState({isScaledOrderModalVisible:!0})}hideScaledOrderModal(){this.setState({isScaledOrderModalVisible:!1})}showBorrowQuoteModal(){this.setState({isBorrowQuoteModalVisible:!0,isBorrowQuoteModalLoaded:!0})}hideBorrowQuoteModal(){this.setState({isBorrowQuoteModalVisible:!1})}showBorrowBaseModal(){this.setState({isBorrowBaseModalVisible:!0,isBorrowBaseModalLoaded:!0})}hideBorrowBaseModal(){this.setState({isBorrowBaseModalVisible:!1})}showDepositBridgeModal(){this.setState({isDepositBridgeModalVisible:!0,isDepositBridgeModalLoaded:!0})}hideDepositBridgeModal(){this.setState({isDepositBridgeModalVisible:!1})}showDepositModal(){this.setState({isDepositModalVisible:!0,isDepositModalLoaded:!0})}hideDepositModal(){this.setState({isDepositModalVisible:!1})}_getLastMarketKey(){const e=p.Apis.instance().chain_id;return"lastMarket"+(e?"_"+e.substr(0,8):"")}showConfirmBuyOrderModal(){this.setState({isConfirmBuyOrderModalVisible:!0,isConfirmBuyOrderModalLoaded:!0})}hideConfirmBuyOrderModal(){this.setState({isConfirmBuyOrderModalVisible:!1})}showConfirmSellOrderModal(){this.setState({isConfirmSellOrderModalVisible:!0,isConfirmSellOrderModalLoaded:!0})}hideConfirmSellOrderModal(){this.setState({isConfirmSellOrderModalVisible:!1})}UNSAFE_componentWillMount(){window.addEventListener("resize",this._setDimensions,{capture:!1,passive:!0}),this._checkFeeStatus()}componentDidMount(){P.A.getTrackedGroupsConfig(),T.A.changeViewSetting.defer({[this._getLastMarketKey()]:this.props.quoteAsset.get("symbol")+"_"+this.props.baseAsset.get("symbol")}),window.addEventListener("resize",this._getWindowSize,{capture:!1,passive:!0})}_forceRender(e,t){this.state.forceReRender&&this.setState({forceReRender:!1}),L.A.are_equal_shallow(this.state.activePanels,t.activePanels)&&L.A.are_equal_shallow(this.state.verticalOrderBook,t.verticalOrderBook)&&e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset||this.setState({forceReRender:!0})}shouldComponentUpdate(e,t){let{expirationType:s}=this.state;if(this._forceRender(e,t),!e.marketReady&&!this.props.marketReady)return!1;let a=!1,r=!1;e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset||this.setState({expirationType:{bid:"SPECIFIC"==s.bid?s.bid:"YEAR",ask:"SPECIFIC"==s.ask?s.ask:"YEAR"}});for(let t in e)if(e.hasOwnProperty(t)&&(a=a||!L.A.are_equal_shallow(e[t],this.props[t]),a))break;for(let e in t.panelTabsActive)r=!L.A.are_equal_shallow(t.panelTabsActive[e],this.state.panelTabsActive[e]);return a||r||!L.A.are_equal_shallow(t,this.state)}_checkFeeStatus(e=[this.props.coreAsset,this.props.baseAsset,this.props.quoteAsset],t=this.props.currentAccount){let s={},a=[];e.forEach((e=>{a.push((0,I.hQ)({accountID:t.get("id"),feeID:e.get("id"),type:"limit_order_create"}))})),Promise.all(a).then((t=>{e.forEach(((e,a)=>{s[e.get("id")]=t[a]})),L.A.are_equal_shallow(this.state.feeStatus,s)||this.setState({feeStatus:s})})).catch((e=>{console.error("checkFeeStatusAsync error",e),this.setState({feeStatus:{}})}))}_getWindowSize(){let{innerHeight:e,innerWidth:t}=window;if(e!==this.state.height||t!==this.state.width){this.setState({height:e,width:t});let s=this.refs.center;s&&E().update(s)}}componentDidUpdate(e,t){if(this._initPsContainer(),!this.props.exchange.get("tutorialShown")&&e.coreAsset&&t.feeStatus&&!this.tutorialShown){this.tutorialShown=!0;const e=this.props.settings.get("themes");C().introJs().setOptions({tooltipClass:e,highlightClass:e,showBullets:!1,hideNext:!0,hidePrev:!0,nextLabel:_().translate("walkthrough.next_label"),prevLabel:_().translate("walkthrough.prev_label"),skipLabel:_().translate("walkthrough.skip_label"),doneLabel:_().translate("walkthrough.done_label")}).start(),T.A.setExchangeTutorialShown.defer(!0)}}_initPsContainer(){if(this.refs.center&&this.psInit){let e=this.refs.center;e&&(E().initialize(e),this.psInit=!1)}}UNSAFE_componentWillReceiveProps(e){if(this._initPsContainer(),e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset&&e.currentAccount===this.props.currentAccount||this._checkFeeStatus([e.coreAsset,e.baseAsset,e.quoteAsset],e.currentAccount),e.quoteAsset.get("symbol")!==this.props.quoteAsset.get("symbol")||e.baseAsset.get("symbol")!==this.props.baseAsset.get("symbol"))return this.setState(this._initialState(e)),T.A.changeViewSetting({[this._getLastMarketKey()]:e.quoteAsset.get("symbol")+"_"+e.baseAsset.get("symbol")})}componentWillUnmount(){window.removeEventListener("resize",this._getWindowSize)}_getFeeAssets(e,t,s){let{currentAccount:a}=this.props;const{feeStatus:r}=this.state;function i(e,t){-1===e.indexOf(t)&&e.push(t)}let o=[s,e===s?t:e];i(o,e),i(o,t);let n=[s,t===s?e:t];i(n,e),i(n,t);let l={};function c(e,t,a){let i;return(e=e.filter((e=>{return!!t[e.get("id")]&&(s=e.get("id"),r[s]&&r[s].hasPoolBalance&&function(e){return r[e]&&r[e].hasBalance}(e.get("id")));var s}))).length?i=e[Math.min(e.length-1,a)]:(i=s,e.push(s)),{assets:e,asset:i}}a.get("balances",[]).filter(((s,a)=>["1.3.0",e.get("id"),t.get("id")].indexOf(a)>=0)).forEach(((e,t)=>{let s=m.ChainStore.getObject(e);l[t]={balance:s?parseInt(s.get("balance"),10):0,fee:this._getFee(m.ChainStore.getAsset(t))}}));let{assets:d,asset:h}=c(o,l,this.state.sellFeeAssetIdx),{assets:p,asset:u}=c(n,l,this.state.buyFeeAssetIdx);return{sellFeeAsset:h,sellFeeAssets:d,sellFee:this._getFee(h),buyFeeAsset:u,buyFeeAssets:p,buyFee:this._getFee(u)}}_getFee(e=this.props.coreAsset){return this.state.feeStatus[e.get("id")]&&this.state.feeStatus[e.get("id")].fee}_verifyFee(e,t,s,a){let r=this._getFee();return"1.3.0"===e.asset_id?r.getAmount()<=a?"1.3.0":null:(t.asset_id===e.asset_id?e.getAmount()+t.getAmount():t.getAmount())<=s?e.asset_id:r.getAmount()<=a&&"1.3.0"!==e.asset_id?"1.3.0":null}_createLimitOrderConfirm(e,t,s,a,r,i,o=!0,n){n.preventDefault();let{highestBid:l,lowestAsk:c}=this.props.marketData,d=this.state["sell"===i?"ask":"bid"];s=d.for_sale.clone(s?parseInt(m.ChainStore.getObject(s).toJS().balance,10):0),a=new O.Vd({amount:a?parseInt(m.ChainStore.getObject(a).toJS().balance,10):0});let h=this._getFee(r),p=this._verifyFee(h,d.for_sale,s.getAmount(),a.getAmount());if(!p)return u.Notification.error({message:_().translate("notifications.exchange_insufficient_funds_for_fees")});if("buy"===i&&c){let e=this.state.bid.price.toReal()/c.getPrice();if(e>1.2)return this.showConfirmBuyOrderModal(),this.setState({buyDiff:e})}else if("sell"===i&&l){let e=1/(this.state.ask.price.toReal()/l.getPrice());if(e>1.2)return this.showConfirmSellOrderModal(),this.setState({sellDiff:e})}let g=t.getIn(["bitasset","is_prediction_market"]);return d.for_sale.gt(s)&&!g?u.Notification.error({message:_().translate("notifications.exchange_insufficient_funds_to_place_order",{amount:d.for_sale.getAmount({real:!0}),symbol:t.get("symbol")})}):d.for_sale.getAmount()>0&&d.to_receive.getAmount()>0?"sell"===i&&g&&o?this._createPredictionShort(p):void this._createLimitOrder(i,p):u.Notification.warning({message:_().translate("notifications.exchange_enter_valid_values")})}_createScaledOrder(e,t){const s=e.map((e=>new O.uw({for_sale:e.for_sale,expiration:new Date(e.expirationTime||!1),to_receive:e.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:t,amount:0}})));return P.A.createLimitOrder2(s).then((e=>{e.error&&"wallet locked"!==e.error.message&&u.Notification.error({message:_().translate("notifications.exchange_unknown_error_place_scaled_order")}),console.log("order success")})).catch((e=>{console.log("order failed:",e)}))}_createLimitOrder(e,t){let s="sell"===e?"ask":"bid",a=this.state[s],r=null;r="SPECIFIC"===this.state.expirationType[s]?this.EXPIRATIONS[this.state.expirationType[s]].get(s):this.EXPIRATIONS[this.state.expirationType[s]].get();const i=new O.uw({for_sale:a.for_sale,expiration:new Date(r||!1),to_receive:a.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:t,amount:0}}),{marketName:o,first:n}=N.A.getMarketName(this.props.baseAsset,this.props.quoteAsset),l=this.props.marketDirections.get(o);if(l&&n.get("id")!==this.props.baseAsset.get("id")||!l&&n.get("id")===this.props.baseAsset.get("id")){let e={};e[o]=!l,T.A.changeMarketDirection(e)}return P.A.createLimitOrder2(i).then((e=>{e.error&&"wallet locked"!==e.error.message&&u.Notification.error({message:_().translate("notifications.exchange_unknown_error_place_order",{amount:a.to_receive.getAmount({real:!0}),symbol:a.to_receive.asset_id})})})).catch((e=>{console.error("order failed:",e)}))}_clearForms(e){let{ask:t,bid:s}=this._initialOrderState(this.props);e?"ask"==e?this.setState({ask:t}):"bid"==e&&this.setState({bid:s}):this.setState({bid:s,ask:t})}_createPredictionShort(e){let t=this.state.ask;const s=new O.uw({for_sale:t.for_sale,to_receive:t.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:e,amount:0}});Promise.all([(0,m.FetchChain)("getAsset",this.props.quoteAsset.getIn(["bitasset","options","short_backing_asset"]))]).then((e=>{let[t]=e,a=new O.Vd({amount:s.amount_for_sale.getAmount(),asset_id:t.get("id"),precision:t.get("precision")});P.A.createPredictionShort(s,a).then((e=>{e.error&&"wallet locked"!==e.error.message&&u.Notification.error({message:_().translate("notifications.exchange_unknown_error_place_order",{amount:buyAssetAmount,symbol:buyAsset.symbol})})}))}))}_forceBuy(e,t,s,a){let r=this.state["sell"===e?"ask":"bid"];s=r.for_sale.clone(s?parseInt(m.ChainStore.getObject(s).get("balance"),10):0),a=new O.Vd({amount:a?parseInt(m.ChainStore.getObject(a).toJS().balance,10):0});let i=this._getFee(t),o=this._verifyFee(i,r.for_sale,s.getAmount(),a.getAmount());o?this._createLimitOrder(e,o):console.error("Unable to pay fees, aborting limit order creation")}_forceSell(e,t,s,a){let r=this.state["sell"===e?"ask":"bid"];s=r.for_sale.clone(s?parseInt(m.ChainStore.getObject(s).get("balance"),10):0),a=new O.Vd({amount:a?parseInt(m.ChainStore.getObject(a).toJS().balance,10):0});let i=this._getFee(t),o=this._verifyFee(i,r.for_sale,s.getAmount(),a.getAmount());o?this._createLimitOrder(e,o):console.error("Unable to pay fees, aborting limit order creation")}_cancelLimitOrder(e,t){t.preventDefault();let{currentAccount:s}=this.props;P.A.cancelLimitOrder(s.get("id"),e)}_changeZoomPeriod(e,t){t.preventDefault(),e!==this.state.currentPeriod&&(this.setState({currentPeriod:e}),T.A.changeViewSetting({currentPeriod:e}))}_onGroupOrderLimitChange(e){let t;if("object"==typeof e&&(e.preventDefault(),t=parseInt(e.target.value)),"number"==typeof e&&(t=parseInt(e)),P.A.changeCurrentGroupLimit(t),t!==this.props.currentGroupOrderLimit){P.A.changeCurrentGroupLimit(t);let e=this.props.sub.split("_");P.A.unSubscribeMarket(e[0],e[1]).then((()=>{this.props.subToMarket(this.props,this.props.bucketSize,t)}))}}_depthChartClick(e,t,s){s.preventDefault();let{bid:a,ask:r}=this.state;a.price=new O.gm({base:this.state.bid.for_sale,quote:this.state.bid.to_receive,real:s.xAxis[0].value}),a.priceText=a.price.toReal(),r.price=new O.gm({base:this.state.ask.to_receive,quote:this.state.ask.for_sale,real:s.xAxis[0].value}),r.priceText=r.price.toReal();let i={bid:a,ask:r,depthLine:a.price.toReal()};this._setForSale(a,!0)||this._setReceive(a,!0),this._setReceive(r)||this._setForSale(r),this._setPriceText(a,!0),this._setPriceText(r,!1),this.setState(i)}_setAutoscroll(e){this.setState({autoScroll:e})}_togglePanel(e){if(!e)return;let t=[];this.state.activePanels.forEach((s=>{s!==e&&t.push(s)})),this.state.activePanels.includes(e)||t.push(e),this.setState({activePanels:t}),T.A.changeViewSetting({activePanels:t})}_toggleChart(e){this.setState({chartType:e}),T.A.changeViewSetting({chartType:e})}_chartZoom=()=>{T.A.changeViewSetting({chartZoom:!this.state.chartZoom});let e=this.state.chartType;this.setState({chartZoom:!this.state.chartZoom,chartType:"hidden_chart"}),setTimeout((()=>{this.setState({chartType:e})}),100)};_chartTools=()=>{T.A.changeViewSetting({chartTools:!this.state.chartTools});let e=this.state.chartType;this.setState({chartTools:!this.state.chartTools,chartType:"hidden_chart"}),setTimeout((()=>{this.setState({chartType:e})}),100)};_flipBuySell(){this.setState({flipBuySell:!this.state.flipBuySell}),T.A.changeViewSetting({flipBuySell:!this.state.flipBuySell})}_flipOrderBook=()=>{T.A.changeViewSetting({flipOrderBook:!this.state.flipOrderBook}),this.setState({flipOrderBook:!this.state.flipOrderBook})};_orderBookReversed=()=>{T.A.changeViewSetting({orderBookReversed:!this.state.orderBookReversed}),this.setState({orderBookReversed:!this.state.orderBookReversed})};_hideFunctionButtons=()=>{T.A.changeViewSetting({hideFunctionButtons:!this.state.hideFunctionButtons}),this.setState({hideFunctionButtons:!this.state.hideFunctionButtons})};_toggleOpenBuySell(){T.A.changeViewSetting({buySellOpen:!this.state.buySellOpen}),this.setState({buySellOpen:!this.state.buySellOpen})}_toggleMarketPicker(e){let t=!!e;t&&this.showMarketPickerModal(),this.setState({showMarketPicker:t,marketPickerAsset:e})}_moveOrderBook(){this.state.verticalOrderForm&&this._moveOrderForm(),T.A.changeViewSetting({verticalOrderBook:!this.state.verticalOrderBook}),this.setState({verticalOrderBook:!this.state.verticalOrderBook})}_moveOrderForm(){this.state.verticalOrderBook&&this._moveOrderBook(),T.A.changeViewSetting({verticalOrderForm:!this.state.verticalOrderForm}),this.setState({verticalOrderForm:!this.state.verticalOrderForm})}_togglePersonalize(){this.state.isPersonalizeModalVisible?this.setState({isPersonalizeModalVisible:!this.state.isPersonalizeModalVisible}):this.setState({isPersonalizeModalVisible:!this.state.isPersonalizeModalVisible,isPersonalizeModalLoaded:!0})}_toggleScrollbars(){T.A.changeViewSetting({hideScrollbars:!this.state.hideScrollbars}),this.setState({hideScrollbars:!this.state.hideScrollbars})}_toggleSingleColumnOrderForm(){T.A.changeViewSetting({singleColumnOrderForm:!this.state.singleColumnOrderForm}),this.setState({singleColumnOrderForm:!this.state.singleColumnOrderForm})}_mirrorPanels(){this.setState({mirrorPanels:!this.state.mirrorPanels}),T.A.changeViewSetting({mirrorPanels:!this.state.mirrorPanels})}_currentPriceClick(e,t){const s="bid"===e;let a=this.state[e];a.price=t[s?"invert":"clone"](),a.priceText=a.price.toReal(),s?this._setForSale(a,s)||this._setReceive(a,s):this._setReceive(a,s)||this._setForSale(a,s),this.forceUpdate()}_orderbookClick(e){const t=e.isBid();let s=e.totalToReceive({noCache:!0}),a=s.times(e.sellPrice()),r=new O.gm({base:t?a:s,quote:t?s:a}),i=this.state[t?"bid":"ask"];i.price=r,i.priceText=r.toReal();let o={[t?"ask":"bid"]:{for_sale:s,forSaleText:s.getAmount({real:!0}),to_receive:a,toReceiveText:a.getAmount({real:!0}),price:r,priceText:r.toReal()}};t?this._setForSale(i,t)||this._setReceive(i,t):this._setReceive(i,t)||this._setForSale(i,t),this.setState(o)}_borrowQuote(){this.showBorrowQuoteModal()}_borrowBase(){this.showBorrowBaseModal()}_onDeposit(e){this.setState({depositModalType:e}),this.showDepositModal()}_onBuy(e){this.setState({buyModalType:e}),this.showDepositBridgeModal()}_getSettlementInfo(){let{lowestCallPrice:e,feedPrice:t,quoteAsset:s}=this.props,a=!1;return t&&(a=t.inverted?e<=t.toReal():e>=t.toReal()),!(!a||!e||s.getIn(["bitasset","is_prediction_market"]))}_setTabVerticalPanel(e){this.setState({tabVerticalPanel:e}),T.A.changeViewSetting({tabVerticalPanel:e})}_setTabBuySell(e){this.setState({tabBuySell:e}),T.A.changeViewSetting({tabBuySell:e})}_setPanelTabInGroup(e,t){let{panelTabsActive:s}=this.state;Object.keys(s).map((a=>{a==e&&(s[a]=t)})),this.setState({panelTabsActive:s,forceReRender:!0}),T.A.changeViewSetting({panelTabsActive:s})}_setPanelTabs(e,t){let{panelTabs:s,panelTabsActive:a}=this.state,r={panelTabs:s,panelTabsActive:a};Object.keys(s).map((a=>{r.panelTabs[a]=a==e?t:s[a]})),Object.keys(a).map((e=>{r.panelTabsActive[e]=""})),this.setState({newState:r}),T.A.changeViewSetting({...r})}onChangeFeeAsset(e,t){"buy"===e?(this.setState({buyFeeAssetIdx:t}),T.A.changeViewSetting({buyFeeAssetIdx:t})):(this.setState({sellFeeAssetIdx:t}),T.A.changeViewSetting({sellFeeAssetIdx:t}))}onChangeChartHeight({value:e,increase:t}){let s=e||this.state.chartHeight+(t?20:-20);s<425&&(s=425),s>1e3&&(s=1e3),this.setState({chartHeight:s}),T.A.changeViewSetting({chartHeight:s})}_toggleBuySellPosition(){this.setState({buySellTop:!this.state.buySellTop}),T.A.changeViewSetting({buySellTop:!this.state.buySellTop})}_setReceive(e,t){return!(!e.price.isValid()||!e.for_sale.hasAmount()||(e.to_receive=e.for_sale.times(e.price),e.toReceiveText=e.to_receive.getAmount({real:!0}).toString(),0))}_setForSale(e,t){return!(!e.price.isValid()||!e.to_receive.hasAmount()||(e.for_sale=e.to_receive.times(e.price,!0),e.forSaleText=e.for_sale.getAmount({real:!0}).toString(),0))}_setPrice(e){return!(!e.for_sale.hasAmount()||!e.to_receive.hasAmount()||(e.price=new O.gm({base:e.for_sale,quote:e.to_receive}),e.priceText=e.price.toReal().toString(),0))}_setPriceText(e,t){const s=e[t?"for_sale":"to_receive"],a=e[t?"to_receive":"for_sale"];s.hasAmount()&&a.hasAmount()&&(e.priceText=new O.gm({base:s,quote:a}).toReal().toString())}_onInputPrice(e,t){let s=this.state[e];const a="bid"===e;s.price=new O.gm({base:s[a?"for_sale":"to_receive"],quote:s[a?"to_receive":"for_sale"],real:parseFloat(t.target.value)||0}),a?this._setForSale(s,a)||this._setReceive(s,a):this._setReceive(s,a)||this._setForSale(s,a),s.priceText=t.target.value,this.forceUpdate()}_onInputSell(e,t,s){let a=this.state[e];a.for_sale.setAmount({real:parseFloat(s.target.value)||0}),a.price.isValid()?this._setReceive(a,t):this._setPrice(a),a.forSaleText=s.target.value,this._setPriceText(a,"bid"===e),this.forceUpdate()}_onInputReceive(e,t,s){let a=this.state[e];a.to_receive.setAmount({real:parseFloat(s.target.value)||0}),a.price.isValid()?this._setForSale(a,t):this._setPrice(a),a.toReceiveText=s.target.value,this._setPriceText(a,"bid"===e),this.forceUpdate()}isMarketFrozen(){let{baseAsset:e,quoteAsset:t}=this.props,s=e.getIn(["options","whitelist_markets"]).toJS(),a=t.getIn(["options","whitelist_markets"]).toJS(),r=e.getIn(["options","blacklist_markets"]).toJS(),i=t.getIn(["options","blacklist_markets"]).toJS();return a.length&&-1===a.indexOf(e.get("id"))?{isFrozen:!0,frozenAsset:t.get("symbol")}:s.length&&-1===s.indexOf(t.get("id"))?{isFrozen:!0,frozenAsset:e.get("symbol")}:i.length&&-1!==i.indexOf(e.get("id"))?{isFrozen:!0,frozenAsset:t.get("symbol")}:r.length&&-1!==r.indexOf(t.get("id"))?{isFrozen:!0,frozenAsset:e.get("symbol")}:{isFrozen:!1}}_toggleMiniChart(){T.A.changeViewSetting({miniDepthChart:!this.props.miniDepthChart})}_onChangeMobilePanel(e){this.setState({mobileKey:e})}render(){let{currentAccount:e,marketLimitOrders:t,marketCallOrders:s,marketData:r,activeMarketHistory:i,invertedCalls:o,starredMarkets:n,quoteAsset:l,baseAsset:c,lowestCallPrice:d,marketStats:h,marketReady:p,marketSettleOrders:m,bucketSize:g,totals:y,feedPrice:f,buckets:C,coreAsset:S,trackedGroupsConfig:A,currentGroupOrderLimit:v}=this.props;const{combinedBids:E,combinedAsks:k,lowestAsk:w,highestBid:T,flatBids:P,flatAsks:N,flatCalls:O,flatSettles:I,groupedBids:L,groupedAsks:B}=r;let{bid:F,ask:M,verticalOrderBook:D,verticalOrderForm:q,chartHeight:V,chartType:W,flipBuySell:U,buyDiff:z,sellDiff:H,width:j,buySellTop:$,tabBuySell:G,tabVerticalPanel:Q,hidePanel:J,hideScrollbars:Y,buyModalType:Z,depositModalType:X,autoScroll:ee,activePanels:te,panelWidth:se,mirrorPanels:ae,panelTabsActive:re,panelTabs:ie,singleColumnOrderForm:oe,flipOrderBook:ne,orderBookReversed:le,chartZoom:ce,chartTools:de,hideFunctionButtons:he}=this.state;const{isFrozen:pe,frozenAsset:me}=this.isMarketFrozen();let ue=j;this.refs.center&&(ue=this.refs.center.clientWidth);let ge,be,ye,_e,fe=null,Ce=null,Se=null,Ae=null,ve=null,Ee=null,we=!1;const Te=this.props.viewSettings.get("showVolumeChart",!0);let Pe=j<850,xe=j<640;if(Y=!!xe||Y,l.size&&c.size&&e.size){if(fe=c,Ce=l,be=fe.get("symbol"),ge=Ce.get("symbol"),Se=e.get("balances").toJS(),Se)for(let e in Se)e===Ce.get("id")&&(Ae=Se[e]),e===fe.get("id")&&(ve=Se[e]),"1.3.0"===e&&(Ee=Se[e]);we=this._getSettlementInfo()}let Ne=!!l.get("bitasset_data_id"),Oe=!!c.get("bitasset_data_id"),Le=w&&T?w.getPrice()-T.getPrice():0;if(i.size){let e=i.take(2);ye=e.first();let t=e.last();_e=ye.getPrice()===t.getPrice()?"":ye.getPrice()-t.getPrice()>0?"change-up":"change-down"}if(!S||!Object.keys(this.state.feeStatus).length)return null;let{sellFeeAsset:Be,sellFeeAssets:Fe,sellFee:Re,buyFeeAsset:Me,buyFeeAssets:De,buyFee:qe}=this._getFeeAssets(Ce,fe,S),Ve=fe.getIn(["bitasset","is_prediction_market"])||Ce.getIn(["bitasset","is_prediction_market"]),We=null;Ve&&(We=l.getIn(["options","description"]),We=x.A.parseDescription(We).main);const Ue=Math.max(this.state.height>1100?V:V-125,300);let ze=this.state.expirationType,He=this.state.expirationCustomTime,je=te.length>=1,Ge=fe.getIn(["bitasset","is_prediction_market"]),Ke=0;const Qe=e=>a.createElement("div",{className:"exchange-content-header"},a.createElement(R.A,{string:"exchange.buysell_formatter",noLink:!0,noTip:!0,keys:[{type:"asset",value:this.props.quoteAsset.get("symbol"),arg:"asset"},{type:"translate",value:e?"exchange.buy":"exchange.sell",arg:"direction"}]}));let Je=pe||xe&&!this.state.mobileKey.includes("buySellTab")?null:a.createElement(u.Tabs,{animated:!1,activeKey:this.props.viewSettings.get("order-form-bid")||"limit",onChange:this.handleOrderTypeTabChange.bind(this,"bid"),tabBarExtraContent:a.createElement("div",null,Qe(!0)),defaultActiveKey:"limit",className:b()("exchange--buy-sell-form",q&&!Pe?"":ue>1200?"medium-6 large-6 xlarge-4":ue>800?"medium-6":"","small-12 exchange-padded middle-content",U?`order-${$?2:3} large-order-${$?2:5} sell-form`:`order-${$?1:2} large-order-${$?1:4} buy-form`)},a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.limit"),key:"limit"},a.createElement(K,{showScaledOrderModal:this.showScaledOrderModal,key:"actionCard_"+Ke++,onBorrow:Oe?this._borrowBase.bind(this):null,onBuy:this._onBuy.bind(this,"bid"),onDeposit:this._onDeposit.bind(this,"bid"),currentAccount:e,backedCoin:this.props.backedCoins.find((e=>e.symbol===fe.get("symbol"))),currentBridges:this.props.bridgeCoins.get(fe.get("symbol"))||null,isOpen:this.state.buySellOpen,onToggleOpen:this._toggleOpenBuySell.bind(this),parentWidth:ue,styles:{padding:5,paddingRight:ae?15:5},type:"bid",hideHeader:!0,expirationType:ze.bid,expirations:this.EXPIRATIONS,expirationCustomTime:He.bid,onExpirationTypeChange:this._handleExpirationChange.bind(this,"bid"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"bid"),amount:zt(F.toReceiveText),price:zt(F.priceText),total:zt(F.forSaleText),quote:Ce,base:fe,amountChange:this._onInputReceive.bind(this,"bid",!0),priceChange:this._onInputPrice.bind(this,"bid"),setPrice:this._currentPriceClick.bind(this),totalChange:this._onInputSell.bind(this,"bid",!1),clearForm:this._clearForms.bind(this,"bid"),balance:ve,balanceId:fe.get("id"),onSubmit:this._createLimitOrderConfirm.bind(this,Ce,fe,ve,Ee,Me,"buy"),balancePrecision:fe.get("precision"),quotePrecision:Ce.get("precision"),totalPrecision:fe.get("precision"),currentPrice:w.getPrice(),currentPriceObject:w,account:e.get("name"),fee:qe,hasFeeBalance:this.state.feeStatus[qe.asset_id].hasBalance,feeAssets:De,feeAsset:Me,onChangeFeeAsset:this.onChangeFeeAsset.bind(this,"buy"),isPredictionMarket:fe.getIn(["bitasset","is_prediction_market"]),onFlip:U?null:this._flipBuySell.bind(this),onTogglePosition:this.state.buySellTop&&!D?this._toggleBuySellPosition.bind(this):null,moveOrderForm:Pe||U&&!q?null:this._moveOrderForm.bind(this),verticalOrderForm:!Pe&&q,isPanelActive:je,activePanels:te,singleColumnOrderForm:oe,hideFunctionButtons:he})),a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.scaled"),key:"scaled"},a.createElement(ke,{expirationType:ze.bid,expirations:this.EXPIRATIONS,expirationCustomTime:He.bid,onExpirationTypeChange:this._handleExpirationChange.bind(this,"bid"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"bid"),currentPrice:w.getPrice(),lastClickedPrice:this.state.ask&&this.state.ask.priceText,currentAccount:e,createScaledOrder:this._createScaledOrder,type:"bid",quoteAsset:Ce,baseAsset:fe}))),Ye=pe||xe&&!this.state.mobileKey.includes("buySellTab")?null:a.createElement(u.Tabs,{activeKey:this.props.viewSettings.get("order-form-ask")||"limit",onChange:this.handleOrderTypeTabChange.bind(this,"ask"),animated:!1,tabBarExtraContent:a.createElement("div",null,Qe(!1)),defaultActiveKey:"limit",className:b()("exchange--buy-sell-form",q&&!Pe?"":ue>1200?"medium-6 large-6 xlarge-4":ue>800?"medium-6":"","small-12 exchange-padded middle-content",U?`order-${$?1:2} large-order-${$?1:4} buy-form`:`order-${$?2:3} large-order-${$?2:5} sell-form`)},a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.limit"),key:"limit"},a.createElement(K,{showScaledOrderModal:this.showScaledOrderModal,key:"actionCard_"+Ke++,onBorrow:Ne?this._borrowQuote.bind(this):null,onBuy:this._onBuy.bind(this,"ask"),onDeposit:this._onDeposit.bind(this,"ask"),currentAccount:e,backedCoin:this.props.backedCoins.find((e=>e.symbol===Ce.get("symbol"))),currentBridges:this.props.bridgeCoins.get(Ce.get("symbol"))||null,isOpen:this.state.buySellOpen,onToggleOpen:this._toggleOpenBuySell.bind(this),parentWidth:ue,styles:{padding:5,paddingRight:ae?15:5},type:"ask",hideHeader:!0,amount:zt(M.forSaleText),price:zt(M.priceText),total:zt(M.toReceiveText),quote:Ce,base:fe,expirationType:ze.ask,expirations:this.EXPIRATIONS,expirationCustomTime:He.ask,onExpirationTypeChange:this._handleExpirationChange.bind(this,"ask"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"ask"),amountChange:this._onInputSell.bind(this,"ask",!1),priceChange:this._onInputPrice.bind(this,"ask"),setPrice:this._currentPriceClick.bind(this),totalChange:this._onInputReceive.bind(this,"ask",!0),clearForm:this._clearForms.bind(this,"ask"),balance:Ae,balanceId:Ce.get("id"),onSubmit:this._createLimitOrderConfirm.bind(this,fe,Ce,Ae,Ee,Be,"sell"),balancePrecision:Ce.get("precision"),quotePrecision:Ce.get("precision"),totalPrecision:fe.get("precision"),currentPrice:T.getPrice(),currentPriceObject:T,account:e.get("name"),fee:Re,hasFeeBalance:this.state.feeStatus[Re.asset_id].hasBalance,feeAssets:Fe,feeAsset:Be,onChangeFeeAsset:this.onChangeFeeAsset.bind(this,"sell"),isPredictionMarket:Ce.getIn(["bitasset","is_prediction_market"]),onFlip:U?this._flipBuySell.bind(this):null,onTogglePosition:this.state.buySellTop&&!D?this._toggleBuySellPosition.bind(this):null,moveOrderForm:Pe||!U&&!q?null:this._moveOrderForm.bind(this),verticalOrderForm:!Pe&&q,isPanelActive:je,activePanels:te,singleColumnOrderForm:oe,hideFunctionButtons:he})),a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.scaled"),key:"scaled"},a.createElement(ke,{expirationType:ze.ask,expirations:this.EXPIRATIONS,expirationCustomTime:He.ask,onExpirationTypeChange:this._handleExpirationChange.bind(this,"ask"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"ask"),currentPrice:T.getPrice(),lastClickedPrice:this.state.ask&&this.state.ask.priceText,currentAccount:e,createScaledOrder:this._createScaledOrder,type:"ask",baseAsset:fe,quoteAsset:Ce}))),Ze=xe&&!this.state.mobileKey.includes("myMarkets")?null:a.createElement(gt.A,{key:"actionCard_"+Ke++,className:"left-order-book no-overflow order-9",style:{minWidth:350,height:Pe?680:"calc(100vh - 215px)",padding:Pe?10:0},headerStyle:{width:"100%",display:Pe?"":"display: none"},noHeader:!0,listHeight:this.state.height-450,columns:[{name:"star",index:1},{name:"market",index:2},{name:"vol",index:3},{name:"price",index:4},{name:"change",index:5}],findColumns:[{name:"market",index:1},{name:"issuer",index:2},{name:"vol",index:3},{name:"add",index:4}],current:`${ge}_${be}`,location:this.props.location,history:this.props.history,activeTab:Q||"my-market"}),Xe=xe&&!this.state.mobileKey.includes("orderBook")?null:a.createElement(st,{ref:"order_book",key:"actionCard_"+Ke++,latest:ye&&ye.getPrice(),changeClass:_e,orders:t,calls:s,invertedCalls:o,combinedBids:E,combinedAsks:k,highestBid:T,lowestAsk:w,totalBids:y.bid,totalAsks:y.ask,base:fe,quote:Ce,baseSymbol:be,quoteSymbol:ge,onClick:this._orderbookClick.bind(this),horizontal:!(D&&!Pe),flipOrderBook:ne,orderBookReversed:le,marketReady:p,wrapperClass:b()(ue>1200?"xlarge-8":"","medium-12 large-12","small-12 grid-block orderbook no-padding align-spaced no-overflow wrap shrink",`order-${$?3:1} xlarge-order-${$?4:1}`),innerClass:b()(ue>1200?"medium-6":ue>800?"medium-6 large-6":"","small-12 middle-content",xe?"":"exchange-padded"),currentAccount:this.props.currentAccount.get("id"),handleGroupOrderLimitChange:this._onGroupOrderLimitChange.bind(this),trackedGroupsConfig:A,currentGroupOrderLimit:v,groupedBids:L,groupedAsks:B,isPanelActive:te.length>=1,onTogglePosition:this.state.buySellTop?null:this._toggleBuySellPosition.bind(this),moveOrderBook:Pe?null:this._moveOrderBook.bind(this),smallScreen:Pe,hideScrollbars:Y,autoScroll:ee,onFlipOrderBook:this._flipOrderBook.bind(this),hideFunctionButtons:he});se=350,this.refs.order_book&&this.refs.order_book.verticalStickyTable&&this.refs.order_book.verticalStickyTable.current&&this.refs.order_book.verticalStickyTable.current.scrollData&&(se=this.refs.order_book.verticalStickyTable.current.scrollData.scrollWidth);let et=xe&&!this.state.mobileKey.includes("marketHistory")?null:a.createElement(ut,{key:"actionCard_"+Ke++,className:b()(0==ie.history?ue>1200?"medium-6 large-6 xlarge-4":ue>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12 order-6"),innerClass:xe?"":"exchange-padded",innerStyle:{paddingBottom:xe?"0":"1.2rem"},noHeader:0!=ie.history,history:i,currentAccount:e,myHistory:e.get("history"),base:fe,quote:Ce,baseSymbol:be,quoteSymbol:ge,activeTab:"history",tinyScreen:xe,isPanelActive:je,hideScrollbars:Y}),tt=xe&&!this.state.mobileKey.includes("myMarketHistory")?null:a.createElement(ut,{key:"actionCard_"+Ke++,className:b()(0==ie.my_history?ue>1200?"medium-6 large-6 xlarge-4":ue>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12",D||q?"order-4":"order-3"),innerClass:xe?"":"exchange-padded",innerStyle:{paddingBottom:xe?"0":"1.2rem"},noHeader:0!=ie.my_history,history:i,currentAccount:e,myHistory:e.get("history"),base:fe,quote:Ce,baseSymbol:be,quoteSymbol:ge,activeTab:"my_history",tinyScreen:xe,isPanelActive:je,hideScrollbars:Y}),at=xe&&!this.state.mobileKey.includes("myOpenOrders")?null:a.createElement($e,{key:"actionCard_"+Ke++,style:{marginBottom:xe?0:15},className:b()(0==ie.my_orders?ue>1200?"medium-6 large-6 xlarge-4":ue>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12 order-7"),innerClass:xe?"":"exchange-padded",innerStyle:{paddingBottom:xe?"0":"1.2rem"},noHeader:0!=ie.my_orders,orders:t,settleOrders:m,currentAccount:e,base:fe,quote:Ce,baseSymbol:be,quoteSymbol:ge,activeTab:"my_orders",onCancel:this._cancelLimitOrder.bind(this),flipMyOrders:this.props.viewSettings.get("flipMyOrders"),feedPrice:this.props.feedPrice,smallScreen:Pe,tinyScreen:xe,hidePanel:J,isPanelActive:je,hideScrollbars:Y}),rt=0===m.size||xe&&!this.state.mobileKey.includes("settlementOrders")?null:a.createElement($e,{key:"actionCard_"+Ke++,style:{marginBottom:xe?0:15},className:b()(0==ie.open_settlement?ue>1200?"medium-6 large-6 xlarge-4":ue>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12 order-8"),innerClass:xe?"":"exchange-padded",innerStyle:{paddingBottom:xe?"0":"1.2rem"},noHeader:0!=ie.open_settlement,orders:t,settleOrders:m,currentAccount:e,base:fe,quote:Ce,baseSymbol:be,quoteSymbol:ge,activeTab:"open_settlement",onCancel:this._cancelLimitOrder.bind(this),flipMyOrders:this.props.viewSettings.get("flipMyOrders"),feedPrice:this.props.feedPrice,smallScreen:Pe,tinyScreen:xe,hidePanel:J,isPanelActive:je,hideScrollbars:Y}),it=!xe&&"price_chart"!=W||xe&&!this.state.mobileKey.includes("tradingViewChart")?null:a.createElement(qt,{locale:this.props.locale,dataFeed:this.props.dataFeed,baseSymbol:be,quoteSymbol:ge,marketReady:p,theme:this.props.settings.get("themes"),buckets:C,bucketSize:g,currentPeriod:this.state.currentPeriod,chartHeight:Ue,chartZoom:!xe&&ce,chartTools:!xe&&de,mobile:xe}),ot=!xe&&"market_depth"!=W||xe&&!this.state.mobileKey.includes("deptHighChart")?null:a.createElement(jt,{marketReady:p,orders:t,showCallLimit:we,call_orders:s,flat_asks:N,flat_bids:P,flat_calls:we?O:[],flat_settles:this.props.settings.get("showSettles")&&I,settles:m,invertedCalls:o,totalBids:y.bid,totalAsks:y.ask,base:fe,quote:Ce,height:Ue,isPanelActive:je,onClick:this._depthChartClick.bind(this,fe,Ce),feedPrice:!Ve&&f&&f.toReal(),spread:Le,LCP:we?d:null,hasPrediction:Ve,noFrame:!1,theme:this.props.settings.get("themes"),centerRef:this.refs.center,activePanels:te}),nt=a.createElement("div",{className:"exchange--chart-control",style:{height:33,right:"price_chart"==W?"6rem":"15rem",top:"1px",position:"absolute",zIndex:1,padding:"0.2rem"}},"price_chart"==W&&a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.chart_tools")},a.createElement(u.Icon,{style:{cursor:"pointer",fontSize:"1.4rem",marginRight:"0.6rem"},onClick:this._chartTools.bind(this),type:"tool"})),a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.increase_chart_height")},a.createElement(u.Icon,{style:{cursor:"pointer",fontSize:"1.4rem",marginRight:"0.6rem"},onClick:()=>{this.onChangeChartHeight({increase:!0})},type:"up"})),a.createElement(u.Tooltip,{title:_().translate("exchange.settings.tooltip.decrease_chart_height")},a.createElement(u.Icon,{style:{cursor:"pointer",fontSize:"1.4rem",marginRight:"0.6rem"},onClick:()=>{this.onChangeChartHeight({increase:!1})},type:"down"})),a.createElement(u.Tooltip,{title:"market_depth"==W?_().translate("exchange.settings.tooltip.show_price_chart"):_().translate("exchange.settings.tooltip.show_market_depth")},a.createElement(u.Icon,{style:{cursor:"pointer",fontSize:"1.4rem"},onClick:()=>{"market_depth"==W?this._toggleChart("price_chart"):this._toggleChart("market_depth")},type:"market_depth"==W?"bar-chart":"area-chart"}))),lt=a.createElement("div",{key:"actionCard_"+Ke++,className:"left-order-book small-12",style:{paddingLeft:5,width:Pe?"auto":300}},a.createElement(u.Tabs,{defaultActiveKey:"buy",activeKey:G,onChange:this._setTabBuySell.bind(this),style:{padding:"0px !important",margin:"0px !important"}},a.createElement(u.Tabs.TabPane,{tab:a.createElement(R.A,{string:"exchange.buysell_formatter",noLink:!0,noTip:!1,keys:[{type:"asset",value:Ce.get("symbol"),arg:"asset"},{type:"translate",value:Ge?"exchange.short":"exchange.buy",arg:"direction"}]}),key:"buy"},Je),a.createElement(u.Tabs.TabPane,{tab:a.createElement(R.A,{string:"exchange.buysell_formatter",noLink:!0,noTip:!1,keys:[{type:"asset",value:Ce.get("symbol"),arg:"asset"},{type:"translate",value:Ge?"exchange.short":"exchange.sell",arg:"direction"}]}),key:"sell"},Ye))),ct={1:[],2:[]},dt=[];Object.keys(ie).sort().map((e=>{0==ie[e]?("my_history"==e&&dt.push(tt),"history"==e&&dt.push(et),"my_orders"==e&&dt.push(at),"open_settlement"==e&&null!==rt&&dt.push(rt)):("my_history"==e&&ct[ie[e]].push(a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.my_history"),key:"my_history"},tt)),"history"==e&&ct[ie[e]].push(a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.history"),key:"history"},et)),"my_orders"==e&&ct[ie[e]].push(a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.my_orders"),key:"my_orders"},at)),"open_settlement"==e&&null!==rt&&ct[ie[e]].push(a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.settle_orders"),key:"open_settlement"},rt)))})),Object.keys(re).map((e=>{Object.keys(ie).map((t=>{let s=!1;s||e!=ie[t]||(re[e]=re[e]?re[e]:t,s=!0)}))}));let ht=dt.length;Object.keys(ct).map((e=>{ct[e].length&&ht++}));let pt=ct[1].length>0?a.createElement("div",{key:"actionCard_"+Ke++,className:b()(ue>1200?1==ht?"medium-12 xlarge-4":"medium-6 xlarge-4 ":ue>800?1==ht?"medium-12":"medium-6":"","small-12 order-5",D?"xlarge-order-5":"",D||q?"":ue<1200?"xlarge-order-5":"xlarge-order-2"),style:{paddingRight:5}},a.createElement(u.Tabs,{activeKey:re[1],onChange:this._setPanelTabInGroup.bind(this,1)},ct[1])):null,mt=ct[2].length>0?a.createElement("div",{key:"actionCard_"+Ke++,className:b()(ue>1200?1==ht?"medium-12 xlarge-4":"medium-6 xlarge-4 ":ue>800?1==ht?"medium-12":"medium-6":"","small-12 order-6"),style:{paddingRight:5}},a.createElement(u.Tabs,{activeKey:re[2],onChange:this._setPanelTabInGroup.bind(this,2)},ct[2])):null,bt=ht>2?null:a.createElement("div",{className:b()(ue>1200&&(D||D)?"xlarge-order-6 xlarge-8 order-9":"","small-12 grid-block orderbook no-padding align-spaced no-overflow wrap"),key:"actionCard_"+Ke++}," "),yt=[];Pe?xe?yt=a.createElement(u.Collapse,{activeKey:this.state.mobileKey,onChange:this._onChangeMobilePanel.bind(this),style:{paddingRight:8}},a.createElement(u.Collapse.Panel,{header:_().translate("exchange.price_history"),key:"tradingViewChart"},it),a.createElement(u.Collapse.Panel,{header:_().translate("exchange.order_depth"),key:"deptHighChart"},ot),a.createElement(u.Collapse.Panel,{header:_().translate("exchange.buy_sell"),key:"buySellTab"},lt),a.createElement(u.Collapse.Panel,{header:_().translate("exchange.order_book"),key:"orderBook"},Xe),a.createElement(u.Collapse.Panel,{header:_().translate("exchange.history"),key:"marketHistory"},et),null!==rt?a.createElement(u.Collapse.Panel,{header:_().translate("exchange.settle_orders"),key:"settlementOrders"},rt):null,a.createElement(u.Collapse.Panel,{header:_().translate("exchange.my_history"),key:"myMarketHistory"},tt),a.createElement(u.Collapse.Panel,{header:_().translate("exchange.my_orders"),key:"myOpenOrders"},at),a.createElement(u.Collapse.Panel,{header:_().translate("exchange.market_name"),key:"myMarkets"},a.createElement(u.Tabs,{defaultActiveKey:"my-market",activeKey:Q,onChange:this._setTabVerticalPanel.bind(this)},a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.market_name"),key:"my-market"}),a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.more"),key:"find-market"})),Ze)):(yt.push(Je),yt.push(Ye),yt.push(Xe),yt.push(dt),yt.push(pt),yt.push(mt),yt.push(a.createElement("div",{className:"order-10 small-12",key:"actionCard_"+Ke++},a.createElement(u.Tabs,{defaultActiveKey:"my-market",activeKey:Q,onChange:this._setTabVerticalPanel.bind(this)},a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.market_name"),key:"my-market"}),a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.more"),key:"find-market"})),Ze))):(q||(yt.push(Je),yt.push(Ye)),D||yt.push(Xe),(D||q)&&yt.push(bt),yt.push(dt),yt.push(pt),yt.push(mt));let _t=null,ft=null,Ct=null,St=null,At=!1,kt=!1;return Pe||(D&&(_t=a.createElement("div",{className:"left-order-book no-padding no-overflow",style:{display:"block",height:"calc(100vh - 170px)",width:se}},Xe)),q&&(_t=a.createElement("div",{className:"left-order-book no-padding no-overflow",style:{display:"block",height:"calc(100vh - 170px)",width:300}},lt)),ft=a.createElement("div",{className:"left-order-book no-padding no-overflow",style:{display:"block"},key:"actionCard_"+Ke++},a.createElement("div",{className:"v-align no-padding align-center grid-block footer shrink column","data-intro":_().translate("walkthrough.my_markets")},a.createElement(u.Tabs,{defaultActiveKey:"my-market",activeKey:Q,onChange:this._setTabVerticalPanel.bind(this)},a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.market_name"),key:"my-market"}),a.createElement(u.Tabs.TabPane,{tab:_().translate("exchange.more"),key:"find-market"}))),Ze),(!ae&&_t||ae&&ft)&&(At=!0),(!ae&&ft||ae&&_t)&&(kt=!0),Ct=a.createElement("div",{className:"grid-block left-column shrink no-overflow"},te.includes("left")?ae?ft:_t:null,At?a.createElement("div",{style:{width:"auto",paddingTop:"calc(50vh - 80px)"},onClick:this._togglePanel.bind(this,"left")},a.createElement(u.Icon,{"data-intro":_().translate("walkthrough.panel_hide"),type:te.includes("left")?"caret-left":"caret-right"})):null),St=a.createElement("div",{className:"grid-block left-column shrink no-overflow"},kt?a.createElement("div",{style:{width:"auto",paddingTop:"calc(50vh - 80px)"},onClick:this._togglePanel.bind(this,"right")},a.createElement(u.Icon,{"data-intro":_().translate("walkthrough.panel_hide"),type:te.includes("right")?"caret-right":"caret-left"})):null,te.includes("right")?ae?_t:ft:null)),a.createElement("div",{className:"grid-block vertical"},this.props.marketReady?null:a.createElement($t.A,null),a.createElement(Ie,{hasAnyPriceAlert:this.props.hasAnyPriceAlert,showPriceAlertModal:this.showPriceAlertModal,account:this.props.currentAccount,quoteAsset:l,baseAsset:c,hasPrediction:Ve,starredMarkets:n,lowestAsk:w,highestBid:T,lowestCallPrice:d,showCallLimit:we,feedPrice:f,marketReady:p,latestPrice:ye&&ye.getPrice(),marketStats:h,selectedMarketPickerAsset:this.state.marketPickerAsset,onToggleMarketPicker:this._toggleMarketPicker.bind(this),onTogglePersonalize:this._togglePersonalize.bind(this),showVolumeChart:Te}),a.createElement("div",{className:"grid-block page-layout market-layout"},this.state.isMarketPickerModalVisible||this.state.isMarketPickerModalLoaded?a.createElement(vt,Cs({visible:this.state.isMarketPickerModalVisible,showModal:this.showMarketPickerModal,hideModal:this.hideMarketPickerModal,marketPickerAsset:this.state.marketPickerAsset,onToggleMarketPicker:this._toggleMarketPicker.bind(this)},this.props)):null,this.state.isPersonalizeModalVisible||this.state.isPersonalizeModalLoaded?a.createElement(wt,{visible:this.state.isPersonalizeModalVisible,showModal:this.showPersonalizeModal,hideModal:this.hidePersonalizeModal,viewSettings:this.props.viewSettings,chartType:W,chartHeight:V,onTogglePersonalize:this._togglePersonalize.bind(this),onChangeChartHeight:this.onChangeChartHeight.bind(this),handleGroupOrderLimitChange:this._onGroupOrderLimitChange.bind(this),trackedGroupsConfig:A,currentGroupOrderLimit:v,verticalOrderBook:D,hideScrollbars:Y,mirrorPanels:ae,panelTabs:ie,singleColumnOrderForm:oe,buySellTop:$,flipBuySell:U,flipOrderBook:ne,tinyScreen:xe,smallScreen:Pe,orderBookReversed:le,chartZoom:ce,chartTools:de,hideFunctionButtons:he,onMoveOrderBook:this._moveOrderBook.bind(this),onMirrorPanels:this._mirrorPanels.bind(this),onToggleScrollbars:this._toggleScrollbars.bind(this),onSetAutoscroll:this._setAutoscroll.bind(this),onToggleChart:this._toggleChart.bind(this),onSetPanelTabs:this._setPanelTabs.bind(this),onToggleSingleColumnOrderForm:this._toggleSingleColumnOrderForm.bind(this),onToggleBuySellPosition:this._toggleBuySellPosition.bind(this),onFlipBuySell:this._flipBuySell.bind(this),onFlipOrderBook:this._flipOrderBook.bind(this),onOrderBookReversed:this._orderBookReversed.bind(this),onChartZoom:this._chartZoom.bind(this),onChartTools:this._chartTools.bind(this),onHideFunctionButtons:this._hideFunctionButtons.bind(this)}):null,a.createElement(rs,null),Ct,a.createElement("div",{style:{paddingTop:0},className:b()("grid-block main-content vertical no-overflow")},a.createElement("div",{className:"grid-block vertical no-padding ps-container",id:"CenterContent",ref:"center","data-intro":xe?_().translate("walkthrough.collapsed_items"):null},xe?null:a.createElement("div",null,nt,W&&"price_chart"==W?a.createElement("div",{className:"grid-block shrink no-overflow",id:"market-charts"},it):null,W&&"market_depth"==W?a.createElement("div",{className:"grid-block vertical no-padding shrink"},ot):null),a.createElement("div",{className:"grid-block no-overflow wrap shrink"},yt))),St),Ne&&(this.state.isBorrowQuoteModalVisible||this.state.isBorrowQuoteModalLoaded)?a.createElement(Gt.A,{visible:this.state.isBorrowQuoteModalVisible,hideModal:this.hideBorrowQuoteModal,quoteAssetObj:l.get("id"),backingAssetObj:l.getIn(["bitasset","options","short_backing_asset"]),accountObj:e}):null,Oe&&(this.state.isBorrowBaseModalVisible||this.state.isBorrowBaseModalLoaded)?a.createElement(Gt.A,{visible:this.state.isBorrowBaseModalVisible,hideModal:this.hideBorrowBaseModal,quoteAssetObj:c.get("id"),backingAssetObj:c.getIn(["bitasset","options","short_backing_asset"]),accountObj:e}):null,this.state.isDepositModalVisible||this.state.isDepositModalLoaded?a.createElement(gs,Cs({visible:this.state.isDepositModalVisible,hideModal:this.hideDepositModal,ref:"deposit_modal",action:"deposit",fiatModal:!1,account:e,sender:e,asset:"bid"===X?fe:Ce,modalId:"simple_deposit_modal"+("bid"===X?"":"_ask"),balance:"bid"===X?ve:Ae},this.props.backedCoins.find((e=>e.symbol===("bid"===X?fe.get("symbol"):Ce.get("symbol")))))):null,this.state.isDepositBridgeModalVisible||this.state.isDepositBridgeModalLoaded?a.createElement(bs.A,{visible:this.state.isDepositBridgeModalVisible,hideModal:this.hideDepositBridgeModal,ref:"bridge_modal",action:"deposit",account:e.get("name"),sender:e.get("id"),asset:"bid"===Z?fe.get("id"):Ce.get("id"),modalId:"simple_bridge_modal"+("bid"===Z?"":"_ask"),balances:["bid"===Z?ve:Ae],bridges:this.props.bridgeCoins.get("bid"===Z?fe.get("symbol"):Ce.get("symbol"))||null}):null,this.state.isConfirmBuyOrderModalVisible||this.state.isConfirmBuyOrderModalLoaded?a.createElement(Et,{visible:this.state.isConfirmBuyOrderModalVisible,hideModal:this.hideConfirmBuyOrderModal,type:"buy",onForce:this._forceBuy.bind(this,"buy",Me,ve,Ee),diff:z,hasOrders:k.length>0}):null,this.state.isConfirmSellOrderModalVisible||this.state.isConfirmSellOrderModalLoaded?a.createElement(Et,{visible:this.state.isConfirmSellOrderModalVisible,hideModal:this.hideConfirmSellOrderModal,type:"sell",onForce:this._forceSell.bind(this,"sell",Be,Ae,Ee),diff:H,hasOrders:E.length>0}):null,a.createElement(fs,{onSave:this.handlePriceAlertSave,rules:this.getPriceAlertRules(),latestPrice:ye&&ye.getPrice(),quoteAsset:this.props.quoteAsset.get("id"),baseAsset:this.props.baseAsset.get("id"),visible:this.state.isPriceAlertModalVisible,showModal:this.showPriceAlertModal,hideModal:this.hidePriceAlertModal}))}}const As=Ss;var vs=s(188);function Es(){return Es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Es.apply(this,arguments)}class ks extends a.Component{render(){let e=this.props.match.params.marketID.toUpperCase().split("_");return e[0]===e[1]?a.createElement(vs.A,{subtitle:"market_not_found_subtitle"}):a.createElement(d.A,{stores:[r.A,i.A,o.A,c.A,l.A],inject:{hasAnyPriceAlert:()=>o.A.hasAnyPriceAlert(e[0],e[1]),priceAlert:()=>o.A.getState().priceAlert,locale:()=>l.A.getState().currentLocale,lockedWalletState:()=>c.A.getState().locked,marketLimitOrders:()=>r.A.getState().marketLimitOrders,marketCallOrders:()=>r.A.getState().marketCallOrders,invertedCalls:()=>r.A.getState().invertedCalls,marketSettleOrders:()=>r.A.getState().marketSettleOrders,marketData:()=>r.A.getState().marketData,totals:()=>r.A.getState().totals,activeMarketHistory:()=>r.A.getState().activeMarketHistory,bucketSize:()=>r.A.getState().bucketSize,buckets:()=>r.A.getState().buckets,lowestCallPrice:()=>r.A.getState().lowestCallPrice,feedPrice:()=>r.A.getState().feedPrice,currentAccount:()=>i.A.getState().currentAccount,myActiveAccounts:()=>i.A.getState().myActiveAccounts,viewSettings:()=>o.A.getState().viewSettings,settings:()=>o.A.getState().settings,exchange:()=>o.A.getState().exchange,starredMarkets:()=>o.A.getState().starredMarkets,marketDirections:()=>o.A.getState().marketDirections,marketStats:()=>r.A.getState().marketStats,marketReady:()=>r.A.getState().marketReady,backedCoins:()=>n.A.getState().backedCoins.get("OPEN",[]),bridgeCoins:()=>n.A.getState().bridgeCoins,miniDepthChart:()=>o.A.getState().viewSettings.get("miniDepthChart",!0),dataFeed:()=>new Bt,trackedGroupsConfig:()=>r.A.getState().trackedGroupsConfig,currentGroupOrderLimit:()=>r.A.getState().currentGroupLimit}},a.createElement(Is,{history:this.props.history,location:this.props.location,quoteAsset:e[0],baseAsset:e[1]}))}}let ws,Ts,Ps,xs,Ns,Os=(0,m.EmitterInstance)();class Is extends a.Component{static propTypes={currentAccount:M.A.ChainAccount.isRequired,quoteAsset:M.A.ChainAsset.isRequired,baseAsset:M.A.ChainAsset.isRequired,coreAsset:M.A.ChainAsset.isRequired};static defaultProps={currentAccount:"1.2.3",coreAsset:"1.3.0"};constructor(e){super(),this.state={sub:null},this._subToMarket=this._subToMarket.bind(this)}UNSAFE_componentWillMount(){null!==this.props.quoteAsset&&null!==this.props.baseAsset&&(this.props.quoteAsset.toJS&&this.props.baseAsset.toJS&&this._subToMarket(this.props),Os.on("cancel-order",Ts=P.A.cancelLimitOrderSuccess),Os.on("close-call",ws=P.A.closeCallOrderSuccess),Os.on("call-order-update",Ps=e=>{let{asset_id:t}=e.call_price.base,{asset_id:s}=e.call_price.quote,a=this.props.baseAsset.get("id"),r=this.props.quoteAsset.get("id");t!==a&&t!==r||s!==a&&s!==r||P.A.callOrderUpdate(e)}),Os.on("bitasset-update",xs=P.A.feedUpdate),Os.on("settle-order-update",Ns=e=>{let{isMarketAsset:t,marketAsset:s}=market_utils.isMarketAsset(this.props.quoteAsset,this.props.baseAsset);t&&s.id===e.balance.asset_id&&P.A.settleOrderUpdate(s.id)}))}UNSAFE_componentWillReceiveProps(e){if(null!==e.quoteAsset&&null!==e.baseAsset){if(e.baseAsset&&e.baseAsset.getIn(["bitasset","is_prediction_market"])&&this.props.history.push(`/market/${e.baseAsset.get("symbol")}_${e.quoteAsset.get("symbol")}`),e.quoteAsset&&e.baseAsset&&!this.state.sub)return this._subToMarket(e);if(e.quoteAsset.get("symbol")!==this.props.quoteAsset.get("symbol")||e.baseAsset.get("symbol")!==this.props.baseAsset.get("symbol")){let t=this.state.sub.split("_");P.A.unSubscribeMarket(t[0],t[1]).then((()=>{this._subToMarket(e)}))}}}componentWillUnmount(){let{quoteAsset:e,baseAsset:t}=this.props;null!==e&&null!==t&&(P.A.unSubscribeMarket(e.get("id"),t.get("id")),Os&&(Os.off("cancel-order",Ts),Os.off("close-call",ws),Os.off("call-order-update",Ps),Os.off("bitasset-update",xs),Os.off("settle-order-update",Ns)))}_subToMarket(e,t,s){let{quoteAsset:a,baseAsset:r,bucketSize:i,currentGroupOrderLimit:o}=e;t&&(i=t),s&&(o=s),a.get("id")&&r.get("id")&&(P.A.subscribeMarket.defer(r,a,i,o),this.setState({sub:`${a.get("id")}_${r.get("id")}`}))}render(){return null===this.props.quoteAsset||null===this.props.baseAsset?a.createElement(vs.A,{subtitle:"market_not_found_subtitle"}):a.createElement(As,Es({},this.props,{sub:this.state.sub,subToMarket:this._subToMarket}))}}Is=(0,D.A)(Is,{show_loader:!0});const Ls=ks},25277:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>H});var a=s(96540),r=s(46128),i=s(10658),o=s.n(i),n=s(72090),l=s(1951),c=s(79260),d=s(68289),h=s(77910),p=s.n(h),m=s(80849),u=s.n(m),g=s(21561),b=s(48287).Buffer;let y=1;class _ extends a.Component{constructor(e){super(e),this.state={invoice:null,invoiceData:null,recipient_name:null,recipient_name_account:null,currency:"BTS",defaultAssets:["BTS","CNY","USD","XBTSX.USDT","HONEST.USD","GDEX.USDT","HONEST.CNY","URTHR","SKULD","VERTHANDI","HERTZ"]}}componentDidMount(){this.setState({recipient_name:this.props.currentAccount.get("name")})}_printInvoice(e){this.props.validateFormat(e)&&(0,d.Bc)(JSON.stringify(e),9,((t,s)=>{const a=p().encode(b.from(t));this.setState({invoiceData:a}),console.log("Invoice data",e,a)}))}UNSAFE_componentWillReceiveProps(e,t){null==this.state.recipient_name&&this.props.currentAccount&&this.setState({recipient_name:this.props.currentAccount.get("name")})}fromChanged(e){this.setState({recipient_name:e,recipient_name_account:null})}onFromAccountChanged(e){this.setState({recipient_name_account:e})}hasErrors=()=>{let e=!1;const t=this.props.form.getFieldsValue(["line_items","memo","keys"]);return e=Object.keys(t).some((e=>"line_items"!==e?!t[e]:t.keys?t.keys.some((s=>!t[e][s].label||!t[e][s].price||!t[e][s].quantity)):void 0)),e||!this.state.recipient_name};remove=e=>{const{form:t}=this.props,s=t.getFieldValue("keys");if(1===s.length)return;const a=s.filter((t=>t!==e));t.setFieldsValue({keys:a})};add=()=>{const{form:e}=this.props,t=e.getFieldValue("keys").concat(y++);e.setFieldsValue({keys:t})};handleSubmit(e){const{currency:t}=this.state;e.preventDefault(),this.props.form.validateFields(((e,s)=>{if(!e){let{line_items:e,memo:a,note:r,to_label:i}=s;e=e.filter((e=>!!e)),this._printInvoice({currency:t,line_items:e,memo:a,note:r,to:this.state.recipient_name,to_label:i})}}))}onChangeCurrency(e){const t=n.ChainStore.getAsset(e);this.setState({currency:t.get("symbol")})}render(){const{getFieldValue:e,getFieldDecorator:t}=this.props.form,{currency:s,defaultAssets:i}=this.state;t("keys",{initialValue:[0]});let n=e("keys");const d=a.createElement(a.Fragment,null,a.createElement(r.Row,{style:{marginTop:"0.5rem",marginBottom:"0.5rem"}},a.createElement(r.Col,{span:12},a.createElement(u(),{component:"span",content:"invoice.request.items"})),a.createElement(r.Col,{span:5},a.createElement(u(),{component:"span",content:"invoice.request.quantity"})),a.createElement(r.Col,{span:5},a.createElement(u(),{component:"span",content:"invoice.request.price"})),a.createElement(r.Col,{span:2},a.createElement(u(),{component:"span",content:"invoice.request.action"}))),n.map(((e,s)=>a.createElement(r.Form.Item,{key:e,style:{marginBottom:"0px"}},a.createElement(r.Input.Group,{compact:!0},a.createElement(r.Row,null,a.createElement(r.Col,{span:12},t(`line_items[${e}]label`)(a.createElement(r.Input,null))),a.createElement(r.Col,{span:5},t(`line_items[${e}]quantity`)(a.createElement(r.Input,{type:"number"}))),a.createElement(r.Col,{span:5},t(`line_items[${e}]price`)(a.createElement(r.Input,{type:"number"}))),a.createElement(r.Col,{span:2},e==n[n.length-1]?a.createElement(r.Button,{type:"primary",icon:"plus-circle-o",onClick:()=>this.add(e)}):a.createElement(r.Button,{type:"primary",icon:"minus-circle-o",onClick:()=>this.remove(e)})))))))),h=this.hasErrors();return a.createElement("div",{className:"merchant-protocol--request"},a.createElement(l.A,{className:"invoice-request-input",label:"invoice.request.recipient_account",accountName:this.state.recipient_name,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),account:this.state.recipient_name,typeahead:!0,size:32}),a.createElement(r.Form,{onSubmit:this.handleSubmit.bind(this),required:!0},a.createElement(r.Form.Item,{className:"invoice-request-input",label:a.createElement("span",null,o().translate("invoice.request.identifier"),a.createElement(r.Tooltip,{placement:"topLeft",title:o().translate("invoice.request.identifier_tooltip")}," ",a.createElement(r.Icon,{type:"question-circle",theme:"filled"})))},t("memo")(a.createElement(r.Input,null))),a.createElement(r.Form.Item,{className:"invoice-request-input",label:a.createElement("span",null,o().translate("invoice.request.payment_asset"),a.createElement(r.Tooltip,{placement:"topLeft",title:o().translate("invoice.request.payment_asset_tooltip")}," ",a.createElement(r.Icon,{type:"question-circle",theme:"filled"})))},a.createElement(c.A,{value:s,assets:i,onChange:this.onChangeCurrency.bind(this)})),a.createElement(r.Form.Item,{className:"invoice-request-input",label:a.createElement("span",null,o().translate("invoice.request.recipient_name"),a.createElement(r.Tooltip,{placement:"topLeft",title:o().translate("invoice.request.recipient_name_tooltip")}," ",a.createElement(r.Icon,{type:"question-circle",theme:"filled"})))},t("to_label")(a.createElement(r.Input,null))),a.createElement(r.Form.Item,{className:"invoice-request-input",label:a.createElement("span",null,o().translate("invoice.request.note"),a.createElement(r.Tooltip,{placement:"topLeft",title:o().translate("invoice.request.note_tooltip")}," ",a.createElement(r.Icon,{type:"question-circle",theme:"filled"})))},t("note")(a.createElement(r.Input.TextArea,{rows:3}))),d,a.createElement(r.Form.Item,null,a.createElement(r.Button,{type:"primary",htmlType:"submit",disabled:h},a.createElement(u(),{content:"invoice.request.create_invoice_string"})))),this.state.invoiceData&&a.createElement(a.Fragment,null,a.createElement("div",{style:{marginTop:"2rem"}},a.createElement(r.Input.TextArea,{disabled:!0,rows:4,value:this.state.invoiceData})),a.createElement("div",{style:{float:"right"}},a.createElement(g.A,{useDiv:!1,text:this.state.invoiceData}))))}}const f=_=r.Form.create({name:"invoice_request"})(_);var C=s(96366),S=s(99429),A=s(89247),v=s(81461),E=s(18483),k=s(55463),w=(s(13246),s(77157)),T=s(6882);const P=({data:e,parsePrice:t})=>{const s=o().translate("invoice.print_receipt");return e.blockNum&&T.A.getHeader.defer(e.blockNum),a.createElement(r.Tooltip,{placement:"left",title:o().translate("tooltip.print_receipt")},a.createElement(r.Button,{type:"primary",icon:"download",onClick:()=>(({data:e,parsePrice:t})=>{const{line_items:s,to:a,asset:r,from:i,total_amount:n,memo:l,currency:c,blockNum:d,to_name:h,note:p}=e,m=10;let u=0,g=[],b="",y="";i&&(i.get("history").forEach((e=>{e.get("block_num")!==d||(b=e.get("id"))})),y=i.get("name"));const _=w.A.getState().blockHeaders.get(d),f=_?_.timestamp.toLocaleDateString("en-US").replace(/\//g,"."):(new Date).toLocaleDateString("en-US").replace(/\//g,"."),C=new k.default({orientation:"portrait",compressPdf:!0});C.setFontStyle("bold"),C.setFontSize(16),C.text(o().translate("invoice.pay_to",{locale:"en"}).toUpperCase(),15,u+=25),C.setFontStyle("normal"),C.text(h,15,u+=m),C.text(a,15,u+=m),C.autoTable({body:[["",o().translate("invoice.memo",{locale:"en"}),l],[{content:o().translate("invoice.paid_by",{locale:"en"}).toUpperCase(),styles:{fontStyle:"bold"}},o().translate("invoice.date",{locale:"en"}),f],[y,o().translate("invoice.transaction",{locale:"en"}),b],[{content:o().translate("invoice.note",{locale:"en"}).toUpperCase(),styles:{fontStyle:"bold"}},"",""],[p,"",""]],bodyStyles:{valign:"top"},styles:{cellWidth:"wrap",rowPageBreak:"auto",halign:"justify"},columnStyles:{0:{halign:"left",cellWidth:90},1:{fontStyle:"bold"},2:{cellWidth:40}},startY:u+=m,theme:"plain"}),C.line(5,u=C.autoTable.previous.finalY+m,205,u),C.setFontSize(20),C.text(o().translate("invoice.receipt_total",{locale:"en"}).toUpperCase(),15,u+=m),C.text(`${n} ${c}`,150,u),C.line(5,u+=5,205,u),C.setFontStyle("normal"),C.setFontSize(16);for(let e of s){const s=t(e.price),a=`${s} ${r}`,i=`${e.quantity*s} ${r}`;g=[...g,{descrption:e.label,unit:a,amount:e.quantity,total:i}]}C.autoTable({columns:[{header:{content:"DESCRIPTION",styles:{halign:"left"}},dataKey:"descrption"},{header:"AMOUNT",dataKey:"amount"},{header:"UNIT",dataKey:"unit"},{header:"TOTAL",dataKey:"total"}],body:g,startY:u+m,bodyStyles:{valign:"top"},styles:{cellWidth:"auto",rowPageBreak:"auto",halign:"right"},columnStyles:{descrption:{halign:"left"}},theme:"plain"}),C.save("bitshares-receipt-"+a+".pdf")})({data:e,parsePrice:t})},s))};var x=s(87040),N=s(37556),O=s(35917),I=s(15286),L=s.n(I),B=s(5556),F=s.n(B),R=s(8378);function M({labelContent:e,handleQrScanSuccess:t,onInputChange:s,inputValue:i,submitBtnText:o,dataFoundText:n}){return a.createElement("div",{style:{marginBottom:"1em"}},a.createElement("label",{className:"left-label"},e),a.createElement("div",null,a.createElement("div",{className:"inline-label"},a.createElement(r.Input.TextArea,{style:{marginBottom:0},rows:3,onChange:s,value:i}),a.createElement("span",null,a.createElement(R.A,{label:"Scan",onSuccess:t,submitBtnText:o,dataFoundText:n})))))}M.propTypes={labelContent:F().oneOfType([F().string,F().element]),handleQrScanSuccess:F().func.isRequired,onInputChange:F().func.isRequired,inputValue:F().string,submitBtnText:F().oneOfType([F().string,F().element]),dataFoundText:F().oneOfType([F().string,F().element])};var D=s(48287).Buffer;class q extends a.Component{constructor(e){super(e),this.state={invoice:null,pay_from_name:null,pay_from_account:null,pay_to_account:null,error:null,blockNum:null,invoiceQr:!1,rawDataInputValue:"",isRawDataInputVisible:!1},this.onBroadcastAndConfirm=this.onBroadcastAndConfirm.bind(this),this.getTotal=this.getTotal.bind(this)}_printExampleInvoice(){(0,d.Bc)(JSON.stringify({to:"sschiessl",to_label:"Stefan S.",currency:"BTS",memo:"Invoice #1234",line_items:[{label:"Something to Buy",quantity:1,price:"0.1"},{label:"10 things to Buy",quantity:10,price:"0.02"}],note:"Something the merchant wants to say to the user"}),9,((e,t)=>{p(),console.log(p().encode(D.from(e)))}))}async componentDidMount(){let e=p().decode(this.props.match.params.data);E.A.unlisten(this.onBroadcastAndConfirm),E.A.listen(this.onBroadcastAndConfirm);try{const t=await this.decompressRawData(e);await this.parseInvoiceData(t)}catch(e){this.setState({isRawDataInputVisible:!0})}}UNSAFE_componentWillReceiveProps(e,t){if(null==this.state.pay_from_name&&this.props.currentAccount){let e=this._findPayment();this.setState({pay_from_name:this.props.currentAccount.get("name"),paymentOperation:e})}}decompressRawData=e=>new Promise(((t,s)=>{(0,d.mF)(e,((e,a)=>{a?s(a):t(e)}))}));async parseInvoiceData(e){try{e=x.A.sanitize(e,{whiteList:[],stripIgnoreTag:!0});let t=JSON.parse(e);if(this.props.validateFormat(t)){let e=await(0,n.FetchChainObjects)(n.ChainStore.getAsset,[t.currency]),s=await(0,n.FetchChain)("getAccount",t.to,void 0,{[t.to]:!1});this.setState({invoice:t,asset:e[0],pay_to_account:s,pay_from_name:this.props.currentAccount.get("name"),error:null,isRawDataInputVisible:!1},this.getTotal)}else this.setState({error:o().translate("invoice.invalid_format")})}catch(e){this.setState({error:e.message})}}handleRawInvoiceDataChange=e=>{const t=e.target.value.replace(/\s/g,"");this.setState({rawDataInputValue:t},(async()=>{try{const e=p().decode(t),s=await this.decompressRawData(e);this.parseInvoiceData(s)}catch(e){console.log(e),this.setState({error:e.message})}}))};handleQrScanSuccess=async({address:e})=>{try{const t=p().decode(e),s=await this.decompressRawData(t);this.parseInvoiceData(s)}catch(e){console.log(e),this.setState({error:e.message})}};parsePrice(e){let t=e.match(/([\d\,\.\s]+)/);return!t||t.length,parseFloat(t[1].replace(/[\,\s]/g,""))}_findPayment(){if((0,N.K)(this.props.currentAccount)&&this.state.total_amount&&this.state.pay_to_account){const e=this.state.pay_to_account.get("id"),t=this.state.asset.get("id"),s=this.state.total_amount*Math.pow(10,this.state.asset.get("precision"));let a=null;return this.props.currentAccount.get("history").toJS().forEach((r=>{const i=r.op;if(0==i[0]){i[1].from;const o=i[1].to,n=i[1].amount.amount,l=i[1].amount.asset_id;this.state.invoice,console.log(e,o,t,l,s,n),e==o&&t==l&&s==n&&(a=r)}})),a}}getTotal(){const e=this.state.invoice.line_items;if(!e||0===e.length)return 0;let t=e.reduce(((e,t)=>{let s=this.parsePrice(t.price);return s?e+t.quantity*s:e}),0),s=this._findPayment();this.setState({total_amount:parseFloat(t.toFixed(this.state.asset.get("precision"))),paymentOperation:s})}onBroadcastAndConfirm(e){e.included&&e.broadcasted_transaction&&(E.A.unlisten(this.onBroadcastAndConfirm),E.A.reset(),this.setState({blockNum:e.trx_block_num}))}onPayClick(e){e.preventDefault();let{asset:t,total_amount:s}=this.state,a=x.A.get_asset_precision(t.get("precision")),r=n.ChainStore.getAccount(this.state.invoice.to);r?S.A.transfer(this.state.pay_from_account.get("id"),r.get("id"),parseInt(s*a,10),t.get("id"),this.state.invoice.memo).then((()=>{E.A.unlisten(this.onBroadcastAndConfirm),E.A.listen(this.onBroadcastAndConfirm)})).catch((e=>{console.log("error: ",e)})):v.A.error(`Account ${this.state.invoice.to} not found`)}fromChanged(e){this.setState({pay_from_name:e,pay_from_account:null})}onFromAccountChanged(e){this.setState({pay_from_account:e})}onToAccountChanged(e){this.setState({pay_to_account:e})}render(){const{data:e}=this.props.match.params;if(this.state.isRawDataInputVisible)return a.createElement("div",null,a.createElement(M,{labelContent:a.createElement(u(),{component:"span",content:"invoice.raw_invoice_data"}),submitBtnText:o().translate("invoice.use_invoice_data"),dataFoundText:o().translate("invoice.invoice_data_found")+":",onInputChange:this.handleRawInvoiceDataChange,inputValue:this.state.rawDataInputValue,handleQrScanSuccess:this.handleQrScanSuccess}),a.createElement("br",null),a.createElement("h4",{className:"has-error text-center"},this.state.error));if(this.state.error)return a.createElement("div",null,a.createElement("br",null),a.createElement("h4",{className:"has-error text-center"},this.state.error));if(!this.state.invoice)return null;if(!this.state.asset)return a.createElement("div",null,a.createElement(u(),{className:"has-error text-center",component:"h4",content:"transfer.errors.asset_unsupported",currency:this.state.invoice.currency}));let{invoice:t,total_amount:s}=this.state;const i=t.currency;let n=null;t.to_label&&(t.to_name=t.to_label);const c={...t,total_amount:s?s.toString():0,asset:i,from:this.state.pay_from_account,blockNum:this.state.blockNum};if(this.state.pay_from_account){const e=this.state.pay_from_account.get("balances").get(this.state.asset.get("id"));n=a.createElement("span",null,a.createElement(u(),{component:"span",content:"transfer.available"}),a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"}},a.createElement(A.A,{balance:e})))}let d=t.line_items.map(((e,t)=>{let s=this.parsePrice(e.price),o=e.quantity*s;return a.createElement(r.Row,{key:"invoice_item_"+t},a.createElement(r.Col,{span:10},a.createElement("div",{className:"item-name"},e.label),a.createElement("div",{className:"item-description"})),a.createElement(r.Col,{span:3},e.quantity," x"),a.createElement(r.Col,{span:5},a.createElement(C.A,{amount:e.price,asset:i,exact_amount:!0})),a.createElement(r.Col,{span:5},a.createElement(C.A,{amount:o,asset:i,exact_amount:!0})))}));const h="pay"!==e?e:this.state.rawDataInputValue;let p=null;return this.state.invoiceQr?p=h:this.state.pay_from_name&&t.to!==this.state.pay_from_name&&(p=`bitshares:operation/transfer?to=${t.to}&from=${this.state.pay_from_name}&asset=${i}&amount=${s}`+(t.memo?`&memo=${t.memo}`:"")),a.createElement("div",{className:"merchant-protocol--pay"},a.createElement("div",{style:{float:"right"}},a.createElement(P,{data:c,parsePrice:this.parsePrice})),a.createElement(u(),{component:"h3",content:"invoice.payment_request"}),a.createElement("br",null),a.createElement(r.Row,null,a.createElement(r.Col,{span:10,style:{width:"30rem"}},a.createElement("h4",null,t.memo),a.createElement(l.A,{label:"invoice.paid_by",accountName:this.state.pay_from_name,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),account:this.state.pay_from_name,typeahead:!0,size:32}),a.createElement(l.A,{label:"invoice.pay_to",accountName:t.to,disabled:!0,onAccountChanged:this.onToAccountChanged.bind(this),account:this.state.pay_to_account,size:32})),a.createElement(r.Col,{span:6,offset:4},a.createElement("div",{className:"inline-block"},a.createElement(u(),{component:"h4",content:"invoice.pay.barcode"}),a.createElement(r.Button,{type:"secondary",style:{width:"180px",marginBottom:"20px"},onClick:()=>{this.setState({invoiceQr:!this.state.invoiceQr})}},a.createElement(u(),{component:"span",content:this.state.invoiceQr?"invoice.pay.invoice_qr_code":"invoice.pay.payment_qr_code"}))),a.createElement(L(),{size:180,value:p||"",bgColor:p?void 0:"#000000"}))),t.to_name&&a.createElement("div",null,a.createElement(u(),{content:"invoice.request.recipient_name"}),a.createElement("p",null,t.to_name)),t.note&&a.createElement("div",null,a.createElement(u(),{content:"invoice.note"}),a.createElement("p",null,t.note)),a.createElement(r.Row,null,a.createElement(r.Col,{span:10},a.createElement(u(),{component:"span",content:"invoice.items"})),a.createElement(r.Col,{span:3},a.createElement(u(),{component:"span",content:"invoice.amount"})),a.createElement(r.Col,{span:5},a.createElement(u(),{component:"span",content:"invoice.unit"})),a.createElement(r.Col,{span:5},a.createElement(u(),{component:"span",content:"invoice.total"}))),a.createElement("div",{className:"divider"}),d,a.createElement("div",{className:"divider"}),a.createElement(r.Row,null,a.createElement(r.Col,{span:18},a.createElement(u(),{component:"span",content:"invoice.total"})),a.createElement(r.Col,{span:5},a.createElement(C.A,{amount:s,asset:i,exact_amount:!0}))),this.state.paymentOperation?a.createElement("div",null,a.createElement("h3",null,o().translate("invoice.payment_proof")," ",a.createElement(r.Tooltip,{title:o().translate("invoice.tooltip_payment_proof"),mouseEnterDelay:.5},a.createElement(r.Icon,{type:"question-circle"}))),a.createElement("table",{className:"table"},a.createElement("tbody",null,a.createElement(O.A,{includeOperationId:!0,key:this.state.paymentOperation.id,operationId:this.state.paymentOperation.id,op:this.state.paymentOperation.op,result:this.state.paymentOperation.result,block:this.state.paymentOperation.block_num,current:this.props.currentAccount.get("id")})))):a.createElement(r.Button,{type:"primary",style:{marginTop:"30px"},disabled:!this.state.pay_from_account,onClick:this.onPayClick.bind(this)},a.createElement(u(),{content:"invoice.pay_button",asset:a.createElement(C.A,{amount:s,asset:i,exact_amount:!0}),name:t.to})))}}const V=q;var W=s(15304);function U(){return U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},U.apply(this,arguments)}class z extends a.Component{constructor(e){super(e),this.state={tabs:[{name:"Request",link:"/invoice/request",translate:"invoice.request.title",content:a.createElement(f,U({},e,{validateFormat:this._validateFormat.bind(this)}))},{name:"Pay",link:"/invoice/pay",translate:"invoice.pay.title",content:a.createElement(V,U({},e,{validateFormat:this._validateFormat.bind(this)}))}]}}_validateFormat(e){return!(0,W.t)(e,{type:"object",properties:{to:{type:"string"},to_label:{type:"string"},currency:{type:"string"},memo:{type:"string"},line_items:{type:"array",items:{type:"object",properties:{label:{type:"string"},quantity:{type:"float",minimum:1},price:{type:"float"}}}},note:{type:"string"},required:["to","currency","line_items"]}}).errors.length}componentDidMount(){this.state.tabs.some((e=>e.link===this.props.match.url))||this.props.history.push("/invoice/pay")}onTabChange(e){this.props.history.push(e)}render(){return a.createElement("div",{className:"merchant-protocol center"},a.createElement(r.Card,null,a.createElement(r.Tabs,{activeKey:this.props.location.pathname,animated:!1,onChange:this.onTabChange.bind(this)},this.state.tabs.map((e=>a.createElement(r.Tabs.TabPane,{key:e.link,tab:o().translate(e.translate)},a.createElement("div",{className:"padding"},e.content)))))))}}const H=z=(0,N.V)(z)},37556:(e,t,s)=>{"use strict";s.d(t,{K:()=>d,V:()=>h});var a=s(96540),r=s(12569),i=s(83599),o=s(72342),n=s(9476),l=s(55840),c=s(40702);const d=function(e){return!!e&&!!e.get("id")},h=function(e){let t=class extends a.Component{static propTypes={currentAccount:r.A.ChainAccount};static defaultProps={autosubscribe:!0};constructor(e){super(e)}render(){return d(this.props.currentAccount)?a.createElement(e,this.props):a.createElement(c.A,null)}};return t=(0,o.A)(t),t=(0,i.Ay)(t,100,{leading:!1}),(0,n.N)(t,{listenTo:()=>[l.A],getProps(){let e=l.A.getState().currentAccount||l.A.getState().passwordAccount||"please-login";return{currentAccount:new Map([["name",e]])}}})}},27584:(e,t,s)=>{"use strict";s.d(t,{A:()=>h});var a=s(96540),r=s(5556),i=s.n(r),o=s(46128),n=s(10658),l=s.n(n);function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},c.apply(this,arguments)}const d=a.createRef();function h({onChange:e,value:t,placeholder:s,maxLength:r,style:i,className:n,name:l,autoComplete:h,onClear:p,type:m,...u}){return null==p&&(p=()=>{e({target:{value:""}}),d.current.focus()}),a.createElement(o.Input,c({ref:d,autoComplete:h,style:i,type:m,className:n+" search-input",placeholder:s,maxLength:r,name:l,value:t,onChange:e,addonAfter:a.createElement(o.Icon,{type:"search"}),suffix:p?a.createElement(o.Icon,{onClick:p,type:"close",className:t?"cursor-pointer":"hide"}):a.createElement("span",null)},u))}h.propTypes={onChange:i().func.isRequired,value:i().string,placeholder:i().string,style:i().object,className:i().string,type:i().string,name:i().string,autoComplete:i().string,maxLength:i().number,onClear:i().func},h.defaultProps={placeholder:l().translate("exchange.filter"),style:{width:"200px"},className:"",type:"text",name:"focus",autoComplete:"off",maxLength:16,onClear:void 0}},37385:e=>{e.exports={midnightTheme:{bidColor:"#50D2C2",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#E3745B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#6BA583",negativeColor:"#DB0000",strokeColor:"#FFFF00",primaryText:"#e0e0e0",volumeColor:"#848484",tooltipBackgroundColor:"rgba(0, 0, 0, 0.4)",tooltipColor:"#fff",tooltipFillColor:"#fff",axisLabelsColor:"#fff",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#FFFFFF",bgColor:"#191a1f",textColor:"#e0e0e0"},darkTheme:{bidColor:"#6BA583",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#E3745B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#258A14",negativeColor:"#DB0000",strokeColor:"#FFFF00",primaryText:"#e0e0e0",volumeColor:"#848484",tooltipBackgroundColor:"rgba(0, 0, 0, 0.4)",tooltipColor:"#fff",tooltipFillColor:"#fff",axisLabelsColor:"#fff",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#FFFFFF",bgColor:"#2a2a2a",textColor:"#ffffff"},lightTheme:{bidColor:"#258A14",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#EA340B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#528c0a",negativeColor:"rgba(225, 66, 74, 1)",strokeColor:"#000000",primaryText:"#242424",volumeColor:"#848484",tooltipBackgroundColor:"rgba(255,255,255, 0.9)",tooltipColor:"#000",tooltipFillColor:"#000",axisLabelsColor:"#000",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#848484",bgColor:"#fff",textColor:"#3d3d3d"}}},44483:(e,t,s)=>{"use strict";s.d(t,{DB:()=>o,YY:()=>i,nM:()=>l});var a=s(41321),r=s(72090);function i(e,t=!1,s,a){if(!e&&""!==e)return;let r=e.toUpperCase();r.startsWith("BIT")&&r.length>=6&&(r=e.substr(3,r.length-1)),s(r,10,t),a({lookupQuote:r})}function o({searchAssets:e,marketPickerAsset:t,baseAsset:s,quoteAsset:r},{inputValue:i,lookupQuote:o},c,d){c({activeSearch:!0});let h=0,p=[],m=s.get("symbol"),u=r.get("symbol");e.size&&i&&i.length>2&&e.filter((e=>{try{if(e.options.description){let t=JSON.parse(e.options.description);if("visible"in t&&!t.visible)return!1}}catch(e){}return-1!==e.symbol.indexOf(o)})).forEach((e=>{if(h>100)return;h++;let a=l(e.issuer),r=s.get("symbol"),i=e.symbol+"_"+r,o=u==t;(o&&e.symbol!=m||!o&&e.symbol!=u)&&p.push([i,{quote:e.symbol,base:r,issuerId:e.issuer,issuer:a}])}));const g=function(e,t){return t.startsWith("BIT")&&t.length>=6&&(t=t.substr(3,t.length-1)),e.sort((([,e],[,s])=>{const r=n(e),i=n(s);if(r.asset!==i.asset){if(r.asset===t)return-1;if(i.asset===t)return 1;if(r.asset>i.asset)return-1;if(r.asset<i.asset)return 1}if(r.isCommittee^i.isCommittee){if(r.isCommittee)return-1;if(i.isCommittee)return 1}const o=(0,a.DC)(e.quote),l=(0,a.DC)(s.quote);return o&&!l?-1:l&&!o||r.gateway>i.gateway?1:r.gateway<i.gateway?-1:0}))}(p,i);d(g)}function n(e){const t={},s=e.quote;if(-1!==s.indexOf(".")){const[e,a]=s.split(".");t.gateway=e,t.asset=a}else t.asset=s;return"1.2.0"===e.issuerId&&(t.isCommittee=!0),t}function l(e){let t=r.ChainStore.getObject(e,!1,!1);return t?t.get("name"):void 0}},77910:(e,t,s)=>{e.exports=s(16763)},24400:(e,t,s)=>{"use strict";var a,r,i,o,n,l,c,d,h,p,m,u,g,b,y,_,f,C,S,A,v,E,k,w,T,P,x,N,O,I,L,B,F,R,M,D,q,V,W,U,z,H,j,$,G,K,Q,J,Y,Z,X,ee,te,se,ae,re,ie,oe,ne,le,ce,de,he,pe,me,ue,ge,be,ye,_e,fe,Ce,Se,Ae,ve,Ee,ke,we,Te,Pe,xe,Ne,Oe;function Ie(e,t){const s={...e};for(const a in t)"object"!=typeof e[a]||null===e[a]||Array.isArray(e[a])?void 0!==t[a]&&(s[a]=t[a]):s[a]=Ie(e[a],t[a]);return s}s.r(t),s.d(t,{ActionId:()=>a,ChartStyle:()=>he,ClearMarksMode:()=>d,ConnectionStatus:()=>B,FilledAreaType:()=>T,HHistDirection:()=>ke,LineStudyPlotStyle:()=>h,LineStyle:()=>Oe,MarkLocation:()=>Pe,MarketStatus:()=>l,MenuItemType:()=>c,NotificationType:()=>J,OhlcStudyPlotStyle:()=>b,OrderOrPositionMessageType:()=>Z,OrderStatus:()=>W,OrderStatusFilter:()=>U,OrderTicketFocusControl:()=>K,OrderType:()=>R,OverrideLineStyle:()=>le,OverridePriceAxisLastValueMode:()=>ne,ParentType:()=>j,PlDisplay:()=>ue,PriceScaleMode:()=>Se,SeriesType:()=>Ae,Side:()=>D,StandardFormatterName:()=>oe,StudyInputType:()=>_,StudyPlotDisplayTarget:()=>u,StudyPlotType:()=>p,StudyTargetPriceScale:()=>k,TimeFrameType:()=>o,TimeHoursFormat:()=>pe,TradedGroupHorizontalAlignment:()=>ge,VisibilityType:()=>Ce,version:()=>Re,widget:()=>Me}),function(e){e.UnknownAction="UnknownAction",e.Spinner="Spinner",e.Loading="Loading",e.AlertAdd="Alert.Add",e.AlertEdit="Alert.Edit",e.AlertsClone="Alerts.Clone",e.AlertsRemove="Alerts.Remove",e.AlertsRemoveAll="Alerts.RemoveAll",e.AlertsRemoveFiltered="Alerts.RemoveFiltered",e.AlertsRemoveAllInactive="Alerts.RemoveAllInactive",e.AlertsRemoveAllWatchlistInactive="Alerts.RemoveAllWatchlistInactive",e.AlertsRemoveFires="Alerts.RemoveFires",e.AlertsRestart="Alerts.Restart",e.AlertsRestartAllInactive="Alerts.RestartAllInactive",e.AlertsRestartFilteredInactive="Alerts.RestartFilteredInactive",e.AlertsStop="Alerts.Stop",e.AlertsStopAll="Alerts.StopAll",e.AlertsStopFilteredActive="Alerts.StopFilteredActive",e.AlertsExportFiresToCSV="Alerts.ExportFiresToCSV",e.AlertsLogClear="AlertsLog.Clear",e.ChartAddIndicatorToAllCharts="Chart.AddIndicatorToAllCharts",e.ChartAddSymbolToWatchList="Chart.AddSymbolToWatchList",e.ChartAlertLabelToggleExtendLines="Chart.AlertLabel.ToggleExtendLines",e.ChartApplyIndicatorsToAllCharts="Chart.ApplyIndicatorsToAllCharts",e.ChartIndicatorApplyChildIndicator="Chart.Indicator.ApplyChildIndicator",e.ChartIndicatorApplyFinancials="Chart.Indicator.ApplyFinancials",e.ChartIndicatorAbout="Chart.Indicator.About",e.ChartIndicatorPineLogs="Chart.Indicator.PineLogs",e.ChartIndicatorPineSource="Chart.Indicator.PineSource",e.ChartIndicatorAddFavorites="Chart.Indicator.AddFavorites",e.ChartChangeTimeZone="Chart.ChangeTimeZone",e.ChartClipboardCopyPrice="Chart.Clipboard.CopyPrice",e.ChartClipboardCopyLineTools="Chart.Clipboard.CopyLineTools",e.ChartClipboardCopySource="Chart.Clipboard.CopySource",e.ChartClipboardPasteSource="Chart.Clipboard.PasteSource",e.ChartCrosshairLockVerticalCursor="Chart.Crosshair.LockVerticalCursor",e.ChartCrosshairPlusButtonDrawHorizontalLine="Chart.Crosshair.PlusButton.DrawHorizontalLine",e.ChartCustomActionId="Chart.CustomActionId",e.ChartDialogsShowChangeInterval="Chart.Dialogs.ShowChangeInterval",e.ChartDialogsShowChangeSymbol="Chart.Dialogs.ShowChangeSymbol",e.ChartDialogsShowCompareOrAddSymbol="Chart.Dialogs.ShowCompareOrAddSymbol",e.ChartDialogsShowGeneralSettings="Chart.Dialogs.ShowGeneralSettings",e.ChartDialogsShowGeneralSettingsLegendTab="Chart.Dialogs.ShowGeneralSettings.LegendTab",e.ChartDialogsShowGeneralSettingsSymbolTab="Chart.Dialogs.ShowGeneralSettings.SymbolTab",e.ChartDialogsShowGeneralScalesTab="Chart.Dialogs.ShowGeneralSettings.ScalesTab",e.ChartDialogsShowGeneralSettingsEventsTab="Chart.Dialogs.ShowGeneralSettings.EventsTab",e.ChartDialogsShowGeneralSettingsAlertsTab="Chart.Dialogs.ShowGeneralSettings.AlertsTab",e.ChartDialogsShowGoToDate="Chart.Dialogs.ShowGoToDate",e.ChartDialogsShowInsertIndicators="Chart.Dialogs.ShowInsertIndicators",e.ChartDialogsShowInsertFinancials="Chart.Dialogs.ShowInsertFinancials",e.ChartDialogsShowInsertSeasonals="Chart.Dialogs.ShowInsertSeasonals",e.ChartDialogsShowInsertTechnicals="Chart.Dialogs.ShowInsertTechnicals",e.ChartDialogsShowInsertForecast="Chart.Dialogs.ShowInsertForecast",e.ChartDialogsShowInsertOptions="Chart.Dialogs.ShowInsertOptions",e.ChartDetailsMetricsActionId="Chart.Dialogs.DetailsMetrics",e.ChartDialogsShowInsertEconomyIndicators="Chart.Dialogs.ShowInsertEconomyIndicators",e.ChartDialogsShowSymbolInfo="Chart.Dialogs.ShowSymbolInfo",e.ChartDrawingToolbarToggleVisibility="Chart.DrawingToolbar.ToggleVisibility",e.ChartExternalActionId="Chart.ExternalActionId",e.ChartFavoriteDrawingToolsToolbarHide="Chart.FavoriteDrawingToolsToolbar.Hide",e.ChartIndicatorShowSettingsDialog="Chart.Indicator.ShowSettingsDialog",e.ChartLegendToggleLastDayChangeValuesVisibility="Chart.Legend.ToggleLastDayChangeValuesVisibility",e.ChartLinkingGroupSync="Chart.LinkingGroupSync",e.ChartLinkingGroupSyncChangeGroup="Chart.LinkingGroupSync.ChangeGroup",e.ChartLegendToggleBarChangeValuesVisibility="Chart.Legend.ToggleBarChangeValuesVisibility",e.ChartLegendTogglePriceSourceVisibility="Chart.Legend.TogglePriceSourceVisibility",e.ChartLegendToggleIndicatorArgumentsVisibility="Chart.Legend.ToggleIndicatorArgumentsVisibility",e.ChartLegendToggleIndicatorTitlesVisibility="Chart.Legend.ToggleIndicatorTitlesVisibility",e.ChartLegendToggleIndicatorValuesVisibility="Chart.Legend.ToggleIndicatorValuesVisibility",e.ChartLegendToggleOhlcValuesVisibility="Chart.Legend.ToggleOhlcValuesVisibility",e.ChartLegendToggleOpenMarketStatusVisibility="Chart.Legend.ToggleOpenMarketStatusVisibility",e.ChartLegendToggleSymbolVisibility="Chart.Legend.ToggleSymbolVisibility",e.ChartLegendToggleVolumeVisibility="Chart.Legend.ToggleVolumeVisibility",e.ChartLines="Chart.Lines",e.ChartLinesToggleBidAskLinesVisibility="Chart.Lines.ToggleBidAskLinesVisibility",e.ChartLinesToggleHighLowLinesVisibility="Chart.Lines.ToggleHighLowLinesVisibility",e.ChartLinesToggleAverageLineVisibility="Chart.Lines.ToggleAverageLineVisibility",e.ChartLinesTogglePrePostMarketPriceLineVisibility="Chart.Lines.TogglePrePostMarketPriceLineVisibility",e.ChartLinesToggleSeriesPrevCloseLineVisibility="Chart.Lines.ToggleSeriesPrevCloseLineVisibility",e.ChartLinesToggleSeriesPriceLineVisibility="Chart.Lines.ToggleSeriesPriceLineVisibility",e.ChartLineToolBarsPatternToggleFlipped="Chart.LineTool.BarsPattern.ToggleFlipped",e.ChartLineToolBarsPatternToggleMirrored="Chart.LineTool.BarsPattern.ToggleMirrored",e.ChartLineToolRiskRewardReverse="Chart.LineTool.RiskReward.Reverse",e.ChartLineToolClone="Chart.LineTool.Clone",e.ChartLineToolCreateLimitOrderFromState="Chart.LineTool.CreateLimitOrderFromState",e.ChartLineToolElliotChangeDegreeProperty="Chart.LineTool.Elliot.ChangeDegreeProperty",e.ChartLineToolNoSync="Chart.LineTool.NoSync",e.ChartLineToolPitchforkChangeTypeToInside="Chart.LineTool.Pitchfork.ChangeTypeToInside",e.ChartLineToolPitchforkChangeTypeToModifiedSchiff="Chart.LineTool.Pitchfork.ChangeTypeToModifiedSchiff",e.ChartLineToolPitchforkChangeTypeToOriginal="Chart.LineTool.Pitchfork.ChangeTypeToOriginal",e.ChartLineToolPitchforkChangeTypeToSchiff="Chart.LineTool.Pitchfork.ChangeTypeToSchiff",e.ChartLineToolSyncInLayout="Chart.LineTool.SyncInLayout",e.ChartLineToolSyncGlobally="Chart.LineTool.SyncGlobally",e.ChartLineToolTemplates="Chart.LineTool.Templates",e.ChartLineToolTemplatesApply="Chart.LineTool.Templates.Apply",e.ChartLineToolTemplatesApplyDefaults="Chart.LineTool.Templates.ApplyDefaults",e.ChartLineToolTemplatesSaveAs="Chart.LineTool.Templates.SaveAs",e.ChartLineToolToolbarChangeFontSizeProperty="Chart.LineTool.Toolbar.ChangeFontSizeProperty",e.ChartLineToolToolbarChangeLineStyleToDashed="Chart.LineTool.Toolbar.ChangeLineStyleToDashed",e.ChartLineToolToolbarChangeLineStyleToDotted="Chart.LineTool.Toolbar.ChangeLineStyleToDotted",e.ChartLineToolToolbarChangeLineStyleToSolid="Chart.LineTool.Toolbar.ChangeLineStyleToSolid",e.ChartMarksToggleVisibility="Chart.Marks.ToggleVisibility",e.ChartMoveChartInLayout="Chart.MoveChartInLayout",e.ChartMoveChartInLayoutBack="Chart.MoveChartInLayout.Back",e.ChartMoveChartInLayoutForward="Chart.MoveChartInLayout.Forward",e.ChartTpoResetAllMergesAndSplits="Chart.TPO.ResetAllMergesAndSplits",e.ChartTpoSplitBlock="Chart.TPO.SplitBlock",e.ChartTpoMergeBlock="Chart.TPO.MergeBlock",e.ChartObjectTreeShow="Chart.ObjectTree.Show",e.ChartDataWindowShow="Chart.DataWindow.Show",e.ChartPaneControlsDeletePane="Chart.PaneControls.DeletePane",e.ChartPaneControlsMaximizePane="Chart.PaneControls.MaximizePane",e.ChartPaneControlsMinimizePane="Chart.PaneControls.MinimizePane",e.ChartPaneControlsMovePaneDown="Chart.PaneControls.MovePaneDown",e.ChartPaneControlsMovePaneUp="Chart.PaneControls.MovePaneUp",e.ChartPaneControlsCollapsePane="Chart.PaneControls.CollapsePane",e.ChartPaneControlsRestorePane="Chart.PaneControls.RestorePane",e.ChartPriceScaleLabels="Chart.PriceScale.Labels",e.ChartPriceScaleLabelsToggleBidAskLabelsVisibility="Chart.PriceScale.Labels.ToggleBidAskLabelsVisibility",e.ChartPriceScaleLabelsToggleHighLowPriceLabelsVisibility="Chart.PriceScale.Labels.ToggleHighLowPriceLabelsVisibility",e.ChartPriceScaleLabelsToggleAveragePriceLabelVisibility="Chart.PriceScale.Labels.ToggleAveragePriceLabelVisibility",e.ChartPriceScaleLabelsToggleIndicatorsNameLabelsVisibility="Chart.PriceScale.Labels.ToggleIndicatorsNameLabelsVisibility",e.ChartPriceScaleLabelsToggleIndicatorsValueLabelsVisibility="Chart.PriceScale.Labels.ToggleIndicatorsValueLabelsVisibility",e.ChartPriceScaleLabelsTogglePrePostMarketLabelsVisibility="Chart.PriceScale.Labels.TogglePrePostMarketLabelsVisibility",e.ChartPriceScaleLabelsToggleNoOverlappingLabelsVisibility="Chart.PriceScale.Labels.ToggleNoOverlappingLabelsVisibility",e.ChartPriceScaleLabelsToggleSeriesLastValueVisibility="Chart.PriceScale.Labels.ToggleSeriesLastValueVisibility",e.ChartPriceScaleLabelsToggleSymbolNameLabelsVisibility="Chart.PriceScale.Labels.ToggleSymbolNameLabelsVisibility",e.ChartPriceScaleLabelsToggleSymbolPrevCloseValueVisibility="Chart.PriceScale.Labels.ToggleSymbolPrevCloseValueVisibility",e.ChartPriceScaleMergeAllScales="Chart.PriceScale.MergeAllScales",e.ChartPriceScaleMergeAllScalesToLeft="Chart.PriceScale.MergeAllScalesToLeft",e.ChartPriceScaleMergeAllScalesToRight="Chart.PriceScale.MergeAllScalesToRight",e.ChartPriceScaleMoveToLeft="Chart.PriceScale.MoveToLeft",e.ChartPriceScaleMoveToRight="Chart.PriceScale.MoveToRight",e.ChartPriceScaleReset="Chart.PriceScale.Reset",e.ChartPriceScaleToggleAddOrderPlusButtonVisibility="Chart.PriceScale.ToggleAddOrderPlusButtonVisibility",e.ChartPriceScaleToggleAutoScale="Chart.PriceScale.ToggleAutoScale",e.ChartPriceScaleToggleAutoScaleSeriesOnly="Chart.PriceScale.ToggleAutoScaleSeriesOnly",e.ChartPriceScaleToggleCountdownToBarCloseVisibility="Chart.PriceScale.ToggleCountdownToBarCloseVisibility",e.ChartPriceScaleToggleIndexedTo100="Chart.PriceScale.ToggleIndexedTo100",e.ChartPriceScaleToggleInvertScale="Chart.PriceScale.ToggleInvertScale",e.ChartPriceScaleToggleLogarithmic="Chart.PriceScale.ToggleLogarithmic",e.ChartPriceScaleTogglePercentage="Chart.PriceScale.TogglePercentage",e.ChartPriceScaleToggleRegular="Chart.PriceScale.ToggleRegular",e.ChartRedo="Chart.Redo",e.ChartRemoveAllIndicators="Chart.RemoveAllIndicators",e.ChartRemoveAllIndicatorsAndLineTools="Chart.RemoveAllIndicatorsAndLineTools",e.ChartRemoveAllLineTools="Chart.RemoveAllLineTools",e.ChartScalesReset="Chart.Scales.Reset",e.ChartScalesToggleLockPriceToBarRatio="Chart.Scales.ToggleLockPriceToBarRatio",e.ChartScrollToLineTool="Chart.ScrollToLineTool",e.ChartSelectedObjectHide="Chart.SelectedObject.Hide",e.ChartSelectedObjectRemove="Chart.SelectedObject.Remove",e.ChartSelectedObjectShow="Chart.SelectedObject.Show",e.ChartSelectedObjectShowSettingsDialog="Chart.SelectedObject.ShowSettingsDialog",e.ChartSelectedObjectInsertRowTable="Chart.SelectedObject.InsertRowTable",e.ChartSelectedObjectInsertColumnTable="Chart.SelectedObject.InsertColumnTable",e.ChartSelectedObjectRemoveRowTable="Chart.SelectedObject.RemoveRowTable",e.ChartSelectedObjectRemoveColumnTable="Chart.SelectedObject.RemoveColumnTable",e.ChartSelectedObjectToggleLocked="Chart.SelectedObject.ToggleLocked",e.ChartSelectedObjectToggleAnchored="Chart.SelectedObject.ToggleAnchored",e.ChartSeriesPriceScaleToggleAutoScale="Chart.Series.PriceScale.ToggleAutoScale",e.ChartSeriesPriceScaleToggleIndexedTo100="Chart.Series.PriceScale.ToggleIndexedTo100",e.ChartSeriesPriceScaleToggleInvertPriceScale="Chart.Series.PriceScale.ToggleInvertPriceScale",e.ChartSeriesPriceScaleToggleLogarithmic="Chart.Series.PriceScale.ToggleLogarithmic",e.ChartSeriesPriceScaleTogglePercentage="Chart.Series.PriceScale.TogglePercentage",e.ChartSeriesPriceScaleToggleRegular="Chart.Series.PriceScale.ToggleRegular",e.ChartSessionBreaksToggleVisibility="Chart.SessionBreaks.ToggleVisibility",e.ChartSetSession="Chart.SetSession",e.ChartSourceChangePriceScale="Chart.Source.ChangePriceScale",e.ChartSourceMergeDown="Chart.Source.MergeDown",e.ChartSourceMergeUp="Chart.Source.MergeUp",e.ChartSourceMoveToNoScale="Chart.Source.MoveToNoScale",e.ChartSourceMoveToOtherScale="Chart.Source.MoveToOtherScale",e.ChartSourceMoveToPane="Chart.Source.MoveToPane",e.ChartSourceUnmergeDown="Chart.Source.UnmergeDown",e.ChartSourceUnmergeUp="Chart.Source.UnmergeUp",e.ChartSourceVisualOrder="Chart.Source.VisualOrder",e.ChartSourceVisualOrderBringForward="Chart.Source.VisualOrder.BringForward",e.ChartSourceVisualOrderBringToFront="Chart.Source.VisualOrder.BringToFront",e.ChartSourceVisualOrderSendBackward="Chart.Source.VisualOrder.SendBackward",e.ChartSourceVisualOrderSendToBack="Chart.Source.VisualOrder.SendToBack",e.ChartSourceResetInputPoints="Chart.Source.ResetInputPoints",e.ChartThemeApply="Chart.Theme.Apply",e.ChartThemeApplyCustom="Chart.Theme.Apply.Custom",e.ChartThemeSaveAs="Chart.Theme.SaveAs",e.ChartTimeScaleReset="Chart.TimeScale.Reset",e.ChartUndo="Chart.Undo",e.ChartShowAllIdeas="Chart.ShowAllIdeas",e.ChartShowIdeasOfFollowedUsers="Chart.ShowIdeasOfFollowedUsers",e.ChartShowMyIdeasOnly="Chart.ShowMyIdeasOnly",e.ChartToggleVisibilityAllLineTools="Chart.ToggleVisibility.AllLineTools",e.ChartToggleVisibilityContinuousContractSwitch="Chart.ToggleVisibility.ContinuousContractSwitch",e.ChartToggleVisibilityContractExpiration="Chart.ToggleVisibility.ContractExpiration",e.ChartToggleVisibilityDividends="Chart.ToggleVisibility.Dividends",e.ChartToggleVisibilityEarnings="Chart.ToggleVisibility.Earnings",e.ChartToggleVisibilityEconomicEvents="Chart.ToggleVisibility.EconomicEvents",e.ChartToggleVisibilitySplits="Chart.ToggleVisibility.Splits",e.ChartToggleVisibilityLatestNewsAndMinds="Chart.ToggleVisibility.LatestNewsAndMinds",e.ChartToggleVisibilityKeyFactsToday="Chart.ToggleVisibility.KeyFactsToday",e.ChartSourceIntervalsVisibility="Chart.Source.IntervalsVisibility",e.ChartSourceIntervalsVisibilityCurrentAndAbove="Chart.Source.IntervalsVisibility.CurrentAndAbove",e.ChartSourceIntervalsVisibilityCurrentAndBelow="Chart.Source.IntervalsVisibility.CurrentAndBelow",e.ChartSourceIntervalsVisibilityOnlyCurrent="Chart.Source.IntervalsVisibility.Current",e.ChartSourceIntervalsVisibilityAll="Chart.Source.IntervalsVisibility.All",e.NoteCreate="Note.Create",e.NoteEdit="Note.Edit",e.NoteRemove="Note.Remove",e.ObjectsTreeCreateGroup="ObjectsTree.CreateGroup",e.ObjectsTreeRemoveItem="ObjectsTree.RemoveItem",e.ObjectsTreeRenameItem="ObjectsTree.RenameItem",e.ObjectsTreeToggleItemLocked="ObjectsTree.ToggleItemLocked",e.ObjectsTreeToggleItemVisibility="ObjectsTree.ToggleItemVisibility",e.PineEditorConsoleCopyMessage="PineEditor.Console.CopyMessage",e.PineEditorConsoleToggleVisibility="PineEditor.Console.ToggleVisibility",e.PineEditorConsoleClear="PineEditor.Console.Clear",e.ScreenerColumnRemove="Screener.Column.Remove",e.ScreenerFilterChange="Screener.Filter.Change",e.ScreenerFilterReset="Screener.Filter.Reset",e.ScreenerToggleVisibilityCurrency="Screener.ToggleVisibility.Currency",e.ScreenerToggleVisibilityDescription="Screener.ToggleVisibility.Description",e.ScreenerToggleVisibilityRating="Screener.ToggleVisibility.Rating",e.ScreenerToggleVisibilitySymbolType="Screener.ToggleVisibility.SymbolType",e.TradingCancelOrder="Trading.CancelOrder",e.TradingClosePosition="Trading.ClosePosition",e.TradingCustomActionId="Trading.CustomActionId",e.TradingDOMPlaceLimitOrder="Trading.DOMPlaceLimitOrder",e.TradingDOMPlaceMarketOrder="Trading.DOMPlaceMarketOrder",e.TradingDOMPlaceStopLimitOrder="Trading.DOMPlaceStopLimitOrder",e.TradingDOMPlaceStopOrder="Trading.DOMPlaceStopOrder",e.TradingEditOrder="Trading.EditOrder",e.TradingModifyPosition="Trading.ModifyPosition",e.TradingReversePosition="Trading.ReversePosition",e.TradingSellBuyButtonsToggleVisibility="Trading.SellBuyButtonsToggleVisibility",e.TradingTradeFromChart="Trading.TradeFromChart",e.TradingNoOverlapMode="Trading.NoOverlapMode",e.TradingShowSelectBrokerPanel="Trading.ShowSelectBrokerPanel",e.TradingOrderTitle="Trading.OrderTitle",e.TradingPositionTitle="Trading.PositionTitle",e.WatchlistActions="Watchlist.Actions",e.WatchlistAddSelectedSymbolsToCompare="Watchlist.AddSelectedSymbolsToCompare ",e.WatchlistAddSymbolToCompare="Watchlist.AddSymbolToCompare",e.WatchlistAddSymbolToSection="Watchlist.AddSymbolToSection",e.WatchlistChangeFlaggedGroupColor="Watchlist.ChangeFlaggedGroupColor",e.WatchlistAddSymbol="Watchlist.AddSymbol",e.WatchlistCreate="Watchlist.Create",e.WatchlistAddSelectedSymbols="Watchlist.AddSelectedSymbols",e.WatchlistAddSelectedSymbolsLists="Watchlist.AddSelectedSymbols.Lists",e.WatchlistGetDisplayedTickerDescription="Watchlist.GetDisplayedTickerDescription",e.WatchlistCreateSection="Watchlist.CreateSection",e.WatchlistFlagSelectedSymbols="Watchlist.FlagSelectedSymbols",e.WatchlistFlagSymbol="Watchlist.FlagSymbol",e.WatchlistOpenSymbolChart="Watchlist.OpenSymbolChart",e.WatchlistOpenSymbolOverview="Watchlist.OpenSymbolOverview",e.WatchlistRemoveSection="Watchlist.RemoveSection",e.WatchlistRemoveSymbol="Watchlist.RemoveSymbol",e.WatchlistRenameSection="Watchlist.RenameSection",e.WatchlistUnflagAllSymbols="Watchlist.UnflagAllSymbols",e.WatchlistUnflagSelectedSymbols="Watchlist.UnflagSelectedSymbols",e.WatchlistUnflagSymbol="Watchlist.UnflagSymbol"}(a||(a={})),function(e){e.extractErrorReason=function(e){return e.params[1]}}(r||(r={})),function(e){e.Default="default",e.FullSingleSession="full_single_session"}(i||(i={})),function(e){e.PeriodBack="period-back",e.TimeRange="time-range"}(o||(o={})),function(e){e.PeriodBack="period-back",e.TimeRange="time-range"}(n||(n={})),function(e){e.Open="market",e.Pre="pre_market",e.Post="post_market",e.Close="out_of_session",e.Holiday="holiday"}(l||(l={})),function(e){e.Separator="separator",e.Action="action"}(c||(c={})),function(e){e[e.All=0]="All",e[e.BarMarks=1]="BarMarks",e[e.TimeScaleMarks=2]="TimeScaleMarks"}(d||(d={})),function(e){e[e.Line=0]="Line",e[e.Histogram=1]="Histogram",e[e.Cross=3]="Cross",e[e.Area=4]="Area",e[e.Columns=5]="Columns",e[e.Circles=6]="Circles",e[e.LineWithBreaks=7]="LineWithBreaks",e[e.AreaWithBreaks=8]="AreaWithBreaks",e[e.StepLine=9]="StepLine",e[e.StepLineWithDiamonds=10]="StepLineWithDiamonds",e[e.StepLineWithBreaks=11]="StepLineWithBreaks"}(h||(h={})),function(e){e.Line="line",e.Colorer="colorer",e.BarColorer="bar_colorer",e.BgColorer="bg_colorer",e.TextColorer="text_colorer",e.OhlcColorer="ohlc_colorer",e.CandleWickColorer="wick_colorer",e.CandleBorderColorer="border_colorer",e.UpColorer="up_colorer",e.DownColorer="down_colorer",e.Shapes="shapes",e.Chars="chars",e.Arrows="arrows",e.Data="data",e.DataOffset="dataoffset",e.OhlcOpen="ohlc_open",e.OhlcHigh="ohlc_high",e.OhlcLow="ohlc_low",e.OhlcClose="ohlc_close"}(p||(p={})),function(e){e.AlertCondition="alertcondition"}(m||(m={})),function(e){e[e.None=0]="None",e[e.Pane=1]="Pane",e[e.DataWindow=2]="DataWindow",e[e.PriceScale=4]="PriceScale",e[e.StatusLine=8]="StatusLine",e[e.All=15]="All"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Pane=1]="Pane",e[e.DataWindow=2]="DataWindow",e[e.PriceScale=4]="PriceScale",e[e.StatusLine=8]="StatusLine",e[e.All=15]="All"}(g||(g={})),function(e){e.OhlcBars="ohlc_bars",e.OhlcCandles="ohlc_candles"}(b||(b={})),function(e){e.Auto="auto",e.Tiny="tiny",e.Small="small",e.Normal="normal",e.Large="large",e.Huge="huge"}(y||(y={})),function(e){e.Integer="integer",e.Float="float",e.Price="price",e.Bool="bool",e.Text="text",e.Symbol="symbol",e.Session="session",e.Source="source",e.Resolution="resolution",e.Time="time",e.BarTime="bar_time",e.Color="color",e.Textarea="text_area"}(_||(_={})),function(e){e[e.None=0]="None",e[e.DataWindow=2]="DataWindow",e[e.StatusLine=8]="StatusLine",e[e.All=15]="All"}(f||(f={})),function(e){e.InitialCapital="initial_capital",e.Currency="currency",e.DefaultQTYValue="default_qty_value",e.DefaultQTYType="default_qty_type",e.Pyramiding="pyramiding",e.ComissionValue="commission_value",e.ComissionType="commission_type",e.BacktestFillLimitsAssumtion="backtest_fill_limits_assumption",e.Slippage="slippage",e.CalcOnOrderFills="calc_on_order_fills",e.CalcOnEveryTick="calc_on_every_tick",e.MarginLong="margin_long",e.MarginShort="margin_short",e.UseBarMagnifier="use_bar_magnifier",e.ProcessOrdersOnClose="process_orders_on_close",e.FillOrdersOnStandardOHLC="fill_orders_on_standard_ohlc"}(C||(C={})),function(e){e.Fixed="fixed",e.CashPerOrder="cash_per_order",e.PercentOfEquity="percent_of_equity"}(S||(S={})),function(e){e.Percent="percent",e.CashPerContract="cash_per_contract",e.CashPerOrder="cash_per_order"}(A||(A={})),function(e){e.FirstBar="first_visible_bar_time",e.LastBar="last_visible_bar_time",e.Realtime="subscribeRealtime"}(v||(v={})),function(e){e.FgColor="__chart_fgcolor",e.BgColor="__chart_bgcolor"}(E||(E={})),function(e){e[e.Right=0]="Right",e[e.Left=1]="Left",e[e.NoScale=2]="NoScale"}(k||(k={})),function(e){e[e.Right=0]="Right",e[e.Left=1]="Left",e[e.None=2]="None"}(w||(w={})),function(e){e.TypePlots="plot_plot",e.TypeHlines="hline_hline"}(T||(T={})),function(e){e[e.StopLoss=0]="StopLoss",e[e.TrailingStop=1]="TrailingStop",e[e.GuaranteedStop=2]="GuaranteedStop"}(P||(P={})),function(e){e.Stocks="stocks",e.Futures="futures",e.Forex="forex",e.Crypto="crypto",e.Others="others"}(x||(x={})),function(e){e.Symbol="symbol"}(N||(N={})),function(e){e[e.PopUp=0]="PopUp",e[e.Notification=1]="Notification"}(O||(O={})),function(e){e.Quantity="qty",e.OrderSide="side",e.Price="price",e.Duration="duration",e.Brackets="brackets",e.StopLossType="slType"}(I||(I={})),function(e){e[e.CONNECTED=1]="CONNECTED",e[e.CONNECTING=2]="CONNECTING",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.ERROR=4]="ERROR"}(L||(L={})),function(e){e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected",e[e.Error=4]="Error"}(B||(B={})),function(e){e[e.LIMIT=1]="LIMIT",e[e.MARKET=2]="MARKET",e[e.STOP=3]="STOP",e[e.STOPLIMIT=4]="STOPLIMIT"}(F||(F={})),function(e){e[e.Limit=1]="Limit",e[e.Market=2]="Market",e[e.Stop=3]="Stop",e[e.StopLimit=4]="StopLimit"}(R||(R={})),function(e){e[e.BUY=1]="BUY",e[e.SELL=-1]="SELL"}(M||(M={})),function(e){e[e.Buy=1]="Buy",e[e.Sell=-1]="Sell"}(D||(D={})),function(e){e[e.CANCELED=1]="CANCELED",e[e.FILLED=2]="FILLED",e[e.INACTIVE=3]="INACTIVE",e[e.PLACING=4]="PLACING",e[e.REJECTED=5]="REJECTED",e[e.WORKING=6]="WORKING"}(q||(q={})),function(e){e[e.ALL=0]="ALL",e[e.CANCELED=1]="CANCELED",e[e.FILLED=2]="FILLED",e[e.INACTIVE=3]="INACTIVE",e[e.REJECTED=5]="REJECTED",e[e.WORKING=6]="WORKING"}(V||(V={})),function(e){e[e.Canceled=1]="Canceled",e[e.Filled=2]="Filled",e[e.Inactive=3]="Inactive",e[e.Placing=4]="Placing",e[e.Rejected=5]="Rejected",e[e.Working=6]="Working"}(W||(W={})),function(e){e[e.All=0]="All",e[e.Canceled=1]="Canceled",e[e.Filled=2]="Filled",e[e.Inactive=3]="Inactive",e[e.Rejected=5]="Rejected",e[e.Working=6]="Working"}(U||(U={})),function(e){e[e.Order=1]="Order",e[e.Position=2]="Position"}(z||(z={})),function(e){e[e.ORDER=1]="ORDER",e[e.POSITION=2]="POSITION"}(H||(H={})),function(e){e[e.Order=1]="Order",e[e.Position=2]="Position",e[e.IndividualPosition=3]="IndividualPosition"}(j||(j={})),function(e){e[e.StopLoss=0]="StopLoss",e[e.TakeProfit=1]="TakeProfit",e[e.TrailingStop=2]="TrailingStop",e[e.GuaranteedStop=3]="GuaranteedStop"}($||($={})),function(e){e[e.LIMITPRICE=1]="LIMITPRICE",e[e.STOPPRICE=2]="STOPPRICE",e[e.TAKEPROFIT=3]="TAKEPROFIT",e[e.STOPLOSS=4]="STOPLOSS"}(G||(G={})),function(e){e[e.LimitPrice=1]="LimitPrice",e[e.StopPrice=2]="StopPrice",e[e.TakeProfit=3]="TakeProfit",e[e.StopLoss=4]="StopLoss",e[e.Quantity=5]="Quantity"}(K||(K={})),function(e){e[e.ERROR=0]="ERROR",e[e.SUCCESS=1]="SUCCESS"}(Q||(Q={})),function(e){e[e.Error=0]="Error",e[e.Success=1]="Success"}(J||(J={})),function(e){e[e.Demo=1]="Demo",e[e.Real=0]="Real"}(Y||(Y={})),function(e){e.Information="information",e.Warning="warning",e.Error="error"}(Z||(Z={})),function(e){e.Demo="demo",e.Live="live"}(X||(X={})),function(e){e[e.LogOut=0]="LogOut",e[e.FailedRestoring=1]="FailedRestoring",e[e.Offline=2]="Offline",e[e.APIError=3]="APIError",e[e.TwoFactorRequired=4]="TwoFactorRequired",e[e.CancelAuthorization=5]="CancelAuthorization",e[e.TimeOutForAuthorization=6]="TimeOutForAuthorization",e[e.OauthError=7]="OauthError",e[e.BrokenConnection=8]="BrokenConnection",e[e.Reconnect=9]="Reconnect",e[e.FailedSignIn=10]="FailedSignIn"}(ee||(ee={})),function(e){e[e.None=0]="None",e[e.Pips=1]="Pips",e[e.Ticks=2]="Ticks"}(te||(te={})),function(e){e.Halted="HALTED",e.NotShortable="NOT-SHORTABLE",e.HardToBorrow="HARD-TO-BORROW"}(se||(se={})),function(e){e[e.Limit=1]="Limit",e[e.Stop=2]="Stop"}(ae||(ae={})),function(e){e.Disallowed="disallowed",e.Allowed="allowed",e.AllowedWithWarning="allowed_with_warning"}(re||(re={})),function(e){e.PlaceOrder="place_order",e.ModifyOrder="modify_order",e.CancelOrder="cancel_order",e.ModifyPosition="modify_position",e.ClosePosition="close_position",e.ModifyIndividualPosition="modify_individual_position",e.CloseIndividualPosition="close_individual_position",e.CloseNetPosition="close_net_position"}(ie||(ie={})),function(e){e.Date="date",e.DateOrDateTime="dateOrDateTime",e.Default="default",e.Fixed="fixed",e.FixedInCurrency="fixedInCurrency",e.VariablePrecision="variablePrecision",e.FormatQuantity="formatQuantity",e.FormatPrice="formatPrice",e.FormatPriceForexSup="formatPriceForexSup",e.FormatPriceInCurrency="formatPriceInCurrency",e.IntegerSeparated="integerSeparated",e.LocalDate="localDate",e.LocalDateOrDateTime="localDateOrDateTime",e.Percentage="percentage",e.Pips="pips",e.Profit="profit",e.ProfitInInstrumentCurrency="profitInInstrumentCurrency",e.Side="side",e.PositionSide="positionSide",e.Status="status",e.Symbol="symbol",e.Text="text",e.Type="type",e.MarginPercent="marginPercent",e.Empty="empty"}(oe||(oe={})),function(e){e[e.LastPriceAndPercentageValue=0]="LastPriceAndPercentageValue",e[e.LastValueAccordingToScale=1]="LastValueAccordingToScale"}(ne||(ne={})),function(e){e[e.Solid=0]="Solid",e[e.Dotted=1]="Dotted",e[e.Dashed=2]="Dashed"}(le||(le={})),function(e){e[e.Offline=0]="Offline",e[e.Resolving=1]="Resolving",e[e.Loading=2]="Loading",e[e.Ready=3]="Ready",e[e.InvalidSymbol=4]="InvalidSymbol",e[e.Snapshot=5]="Snapshot",e[e.EOD=6]="EOD",e[e.Pulse=7]="Pulse",e[e.Delayed=8]="Delayed",e[e.DelayedSteaming=9]="DelayedSteaming",e[e.NoBars=10]="NoBars",e[e.Replay=11]="Replay",e[e.Error=12]="Error",e[e.CalculationError=13]="CalculationError",e[e.UnsupportedResolution=14]="UnsupportedResolution"}(ce||(ce={})),function(e){e[e.Markers=0]="Markers",e[e.Stepline=1]="Stepline",e[e.Simple=2]="Simple"}(de||(de={})),function(e){e[e.Bar=0]="Bar",e[e.Candle=1]="Candle",e[e.Line=2]="Line",e[e.Area=3]="Area",e[e.Renko=4]="Renko",e[e.Kagi=5]="Kagi",e[e.PnF=6]="PnF",e[e.LineBreak=7]="LineBreak",e[e.HeikinAshi=8]="HeikinAshi",e[e.HollowCandle=9]="HollowCandle",e[e.Baseline=10]="Baseline",e[e.Range=11]="Range",e[e.HiLo=12]="HiLo",e[e.Column=13]="Column",e[e.LineWithMarkers=14]="LineWithMarkers",e[e.Stepline=15]="Stepline",e[e.HLCArea=16]="HLCArea",e[e.VolFootprint=17]="VolFootprint",e[e.TPO=18]="TPO",e[e.VolCandle=19]="VolCandle",e[e.SVP=20]="SVP",e[e.HLCBars=21]="HLCBars"}(he||(he={})),function(e){e.TwentyFourHours="24-hours",e.TwelveHours="12-hours"}(pe||(pe={})),function(e){e[e.Initial=2]="Initial",e[e.SeriesZOrderIsAlwaysZero=3]="SeriesZOrderIsAlwaysZero",e[e.Current=3]="Current"}(me||(me={})),function(e){e[e.Money=0]="Money",e[e.Pips=1]="Pips",e[e.Percentage=2]="Percentage"}(ue||(ue={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(ge||(ge={})),ue.Money,ue.Money,ge.Right,function(e){e[e.Background=0]="Background",e[e.Foreground=1]="Foreground",e[e.Topmost=2]="Topmost"}(be||(be={})),function(e){e[e.Unavailable=0]="Unavailable",e[e.AvailableReadonlyAlwaysDisabled=1]="AvailableReadonlyAlwaysDisabled",e[e.AvailableReadonlyAlwaysEnabled=2]="AvailableReadonlyAlwaysEnabled",e[e.Available=3]="Available"}(ye||(ye={})),function(e){e[e.ViewportChangeUserAction=0]="ViewportChangeUserAction",e[e.DataUpdate=1]="DataUpdate",e[e.SeriesRestart=2]="SeriesRestart",e[e.SeriesCompleted=3]="SeriesCompleted",e[e.StudyCreation=4]="StudyCreation"}(_e||(_e={})),function(e){e[e.Chart=0]="Chart"}(fe||(fe={})),function(e){e.AlwaysOn="alwaysOn",e.VisibleOnMouseOver="visibleOnMouseOver",e.AlwaysOff="alwaysOff"}(Ce||(Ce={})),function(e){e[e.Normal=0]="Normal",e[e.Log=1]="Log",e[e.Percentage=2]="Percentage",e[e.IndexedTo100=3]="IndexedTo100"}(Se||(Se={})),function(e){e[e.Bars=0]="Bars",e[e.Candles=1]="Candles",e[e.Line=2]="Line",e[e.Area=3]="Area",e[e.HeikenAshi=8]="HeikenAshi",e[e.HollowCandles=9]="HollowCandles",e[e.Baseline=10]="Baseline",e[e.HiLo=12]="HiLo",e[e.Column=13]="Column",e[e.LineWithMarkers=14]="LineWithMarkers",e[e.Stepline=15]="Stepline",e[e.HLCArea=16]="HLCArea",e[e.VolCandle=19]="VolCandle",e[e.HLCBars=21]="HLCBars",e[e.Renko=4]="Renko",e[e.Kagi=5]="Kagi",e[e.PointAndFigure=6]="PointAndFigure",e[e.LineBreak=7]="LineBreak"}(Ae||(Ae={})),function(e){e.Value="_seriesId"}(ve||(ve={})),function(e){e[e.InvalidSymbol=0]="InvalidSymbol",e[e.ReplayUnsupported=1]="ReplayUnsupported",e[e.UnsupportedDepth=2]="UnsupportedDepth",e[e.UnsupportedIntradyReplay=3]="UnsupportedIntradyReplay"}(Ee||(Ee={})),function(e){e.LeftToRight="left_to_right",e.RightToLeft="right_to_left"}(ke||(ke={})),function(e){e.Relative="relative",e.Absolute="absolute"}(we||(we={})),function(e){e.UpDown="Up/Down",e.Total="Total",e.Delta="Delta"}(Te||(Te={})),function(e){e.AboveBar="AboveBar",e.BelowBar="BelowBar",e.Top="Top",e.Bottom="Bottom",e.Right="Right",e.Left="Left",e.Absolute="Absolute",e.AbsoluteUp="AbsoluteUp",e.AbsoluteDown="AbsoluteDown"}(Pe||(Pe={})),function(e){e.Left="left",e.Center="center",e.Right="right"}(xe||(xe={})),function(e){e.Top="top",e.Middle="middle",e.Bottom="bottom"}(Ne||(Ne={})),function(e){e[e.Solid=0]="Solid",e[e.Dotted=1]="Dotted",e[e.Dashed=2]="Dashed"}(Oe||(Oe={}));const Le={width:800,height:500,interval:"1D",timezone:"Etc/UTC",container:"",library_path:"",locale:"en",widgetbar:{details:!1,watchlist:!1,news:!1,datawindow:!1,watchlist_settings:{default_symbols:[]}},overrides:{"mainSeriesProperties.showCountdown":!1},studies_overrides:{},trading_customization:{position:{},order:{}},brokerConfig:{configFlags:{}},fullscreen:!1,autosize:!1,disabled_features:[],enabled_features:[],debug:!1,logo:{},time_frames:[{text:"5y",resolution:"1W"},{text:"1y",resolution:"1W"},{text:"6m",resolution:"120"},{text:"3m",resolution:"60"},{text:"1m",resolution:"30"},{text:"5d",resolution:"5"},{text:"1d",resolution:"1"}],client_id:"0",user_id:"0",charts_storage_api_version:"1.0",favorites:{intervals:[],chartTypes:[],indicators:[],drawingTools:[]}},Be=JSON.parse('[{"iso":"ar","dir":"rtl","language":"ar"},{"iso":"pt","dir":"ltr","language":"pt"},{"iso":"ca","dir":"ltr","language":"ca_ES"},{"iso":"cs","dir":"ltr","language":"cs"},{"iso":"de","dir":"ltr","language":"de"},{"iso":"en","dir":"ltr","language":"en"},{"iso":"es","dir":"ltr","language":"es"},{"iso":"fr","dir":"ltr","language":"fr"},{"iso":"he","dir":"rtl","language":"he_IL"},{"iso":"hu","dir":"ltr","language":"hu_HU"},{"iso":"id","dir":"ltr","language":"id_ID"},{"iso":"en","dir":"ltr","language":"en"},{"iso":"it","dir":"ltr","language":"it"},{"iso":"ja","dir":"ltr","language":"ja"},{"iso":"ko","dir":"ltr","language":"ko"},{"iso":"ms","dir":"ltr","language":"ms_MY"},{"iso":"pl","dir":"ltr","language":"pl"},{"iso":"ru","dir":"ltr","language":"ru"},{"iso":"sv","dir":"ltr","language":"sv"},{"iso":"th","dir":"ltr","language":"th"},{"iso":"tr","dir":"ltr","language":"tr"},{"iso":"vi","dir":"ltr","language":"vi"},{"iso":"zh-Hans","dir":"ltr","language":"zh"},{"iso":"zh-Hant","dir":"ltr","language":"zh_TW"},{"iso":"el","dir":"ltr","language":"el"},{"iso":"nl","dir":"ltr","language":"nl_NL"},{"iso":"ro","dir":"ltr","language":"ro"}]');let Fe=!1;function Re(){return"CL v29.4.0 (internal id 29ac1aba6675f14818f3a5a9da75fa91c79107d0 @ 2025-06-25T14:02:27.771Z)"}const Me=class{constructor(e){if(this._id=`tradingview_${(1048576*(1+Math.random())|0).toString(16).substring(1)}`,this._ready=!1,this._readyHandlers=[],this._onWindowResize=this._autoResizeChart.bind(this),!e.datafeed)throw new Error("Datafeed is not defined");e.overrides?.["mainSeriesProperties.priceAxisProperties.lockScale"]&&(console.warn("mainSeriesProperties.priceAxisProperties.lockScale can not be set to true within the widget constructor"),delete e.overrides["mainSeriesProperties.priceAxisProperties.lockScale"]),this._options=Ie(Le,e),"dark"===(this._options.theme??"light").toLowerCase()&&void 0===this._options.loading_screen&&(this._options.loading_screen={backgroundColor:"#131722"}),(this._options.debug||this._options.debug_broker)&&(Fe||(Fe=!0,console.log("Using CL v29.4.0 (internal id 29ac1aba6675f14818f3a5a9da75fa91c79107d0 @ 2025-06-25T14:02:27.771Z)"))),this._innerWindowLoaded=new Promise((e=>{this._innerWindowResolver=e})),this._create()}setDebugMode(e){this._innerAPI().setDebugMode(e)}onChartReady(e){this._ready?e.call(this):this._readyHandlers.push(e)}headerReady(){return this._innerWindowLoaded.then((()=>this._innerWindow().headerReady()))}onGrayedObjectClicked(e){this._doWhenInnerApiLoaded((t=>{t.onGrayedObjectClicked(e)}))}onShortcut(e,t){this._doWhenInnerWindowLoaded((s=>{s.createShortcutAction(e,t)}))}subscribe(e,t){this._doWhenInnerApiLoaded((s=>{s.subscribe(e,t)}))}unsubscribe(e,t){this._doWhenInnerApiLoaded((s=>{s.unsubscribe(e,t)}))}chart(e){return this._innerAPI().chart(e)}getLanguage(){return this._options.locale}setSymbol(e,t,s){this._innerAPI().changeSymbol(e,t,s)}remove(){window.removeEventListener("resize",this._onWindowResize),this._readyHandlers.splice(0,this._readyHandlers.length),delete window[this._id],this._iFrame.parentNode&&this._iFrame.parentNode.removeChild(this._iFrame)}closePopupsAndDialogs(){this._doWhenInnerApiLoaded((e=>{e.closePopupsAndDialogs()}))}selectLineTool(e,t){return this._innerAPI().selectLineTool(e,t)}selectedLineTool(){return this._innerAPI().selectedLineTool()}save(e,t){this._innerAPI().saveChart(e,t)}async load(e,t){return this._innerAPI().loadChart({json:e,extendedData:t})}getSavedCharts(e){this._innerAPI().getSavedCharts(e)}loadChartFromServer(e){return this._innerAPI().loadChartFromServer(e)}saveChartToServer(e,t,s){this._innerAPI().saveChartToServer(e,t,s)}removeChartFromServer(e,t){this._innerAPI().removeChartFromServer(e,t)}onContextMenu(e){this._doWhenInnerApiLoaded((t=>{t.onContextMenu(e)}))}createButton(e){return this._innerWindow().createButton(e)}removeButton(e){this._innerWindow().removeButton(e)}createDropdown(e){return this._innerWindow().createDropdown(e)}showNoticeDialog(e){this._doWhenInnerApiLoaded((t=>{t.showNoticeDialog(e)}))}showConfirmDialog(e){this._doWhenInnerApiLoaded((t=>{t.showConfirmDialog(e)}))}showLoadChartDialog(){this._innerAPI().showLoadChartDialog()}showSaveAsChartDialog(){this._innerAPI().showSaveAsChartDialog()}symbolInterval(){return this._innerAPI().getSymbolInterval()}mainSeriesPriceFormatter(){return this._innerAPI().mainSeriesPriceFormatter()}getIntervals(){return this._innerAPI().getIntervals()}getStudiesList(){return this._innerAPI().getStudiesList()}getStudyInputs(e){return this._innerAPI().getStudyInputs(e)}getStudyStyles(e){return this._innerAPI().getStudyStyles(e)}addCustomCSSFile(e){this._innerWindow().addCustomCSSFile(e)}applyOverrides(e){this._options=Ie(this._options,{overrides:e}),this._doWhenInnerWindowLoaded((t=>{t.applyOverrides(e)}))}applyStudiesOverrides(e){this._doWhenInnerWindowLoaded((t=>{t.applyStudiesOverrides(e)}))}watchList(){return this._innerAPI().watchlist()}news(){return this._innerAPI().news()}widgetbar(){return this._innerAPI().widgetbar()}activeChart(){return this._innerAPI().activeChart()}activeChartIndex(){return this._innerAPI().activeChartIndex()}setActiveChart(e){return this._innerAPI().setActiveChart(e)}chartsCount(){return this._innerAPI().chartsCount()}layout(){return this._innerAPI().layout()}setLayout(e){this._innerAPI().setLayout(e)}layoutName(){return this._innerAPI().layoutName()}resetLayoutSizes(e){this._innerAPI().resetLayoutSizes(e)}changeTheme(e,t){return this._innerWindow().changeTheme(e,t)}getTheme(){return this._innerWindow().getTheme()}takeScreenshot(){this._doWhenInnerApiLoaded((e=>{e.takeScreenshot()}))}lockAllDrawingTools(){return this._innerAPI().lockAllDrawingTools()}hideAllDrawingTools(){return this._innerAPI().hideAllDrawingTools()}drawOnAllChartsEnabled(){return this._innerAPI().drawOnAllChartsEnabled()}drawOnAllCharts(e){this._innerAPI().drawOnAllCharts(e)}magnetEnabled(){return this._innerAPI().magnetEnabled()}magnetMode(){return this._innerAPI().magnetMode()}undoRedoState(){return this._innerAPI().undoRedoState()}setIntervalLinkingEnabled(e){this._innerAPI().setIntervalLinkingEnabled(e)}setDateRangeLinkingEnabled(e){this._innerAPI().setDateRangeLinkingEnabled(e)}setTimeFrame(e){this._innerAPI().setTimeFrame(e)}symbolSync(){return this._innerAPI().symbolSync()}intervalSync(){return this._innerAPI().intervalSync()}crosshairSync(){return this._innerAPI().crosshairSync()}timeSync(){return this._innerAPI().timeSync()}dateRangeSync(){return this._innerAPI().dateRangeSync()}setFeatureEnabled(e,t){this._innerAPI().setFeatureEnabled(e,t)}getAllFeatures(){return this._innerWindow().getAllFeatures()}clearUndoHistory(){return this._innerAPI().clearUndoHistory()}undo(){return this._innerAPI().undo()}redo(){return this._innerAPI().redo()}startFullscreen(){this._innerAPI().startFullscreen()}exitFullscreen(){this._innerAPI().exitFullscreen()}takeClientScreenshot(e){return this._innerAPI().takeClientScreenshot(e)}navigationButtonsVisibility(){return this._innerWindow().getNavigationButtonsVisibility()}paneButtonsVisibility(){return this._innerWindow().getPaneButtonsVisibility()}dateFormat(){return this._innerWindow().getDateFormat()}timeHoursFormat(){return this._innerWindow().getTimeHoursFormat()}currencyAndUnitVisibility(){return this._innerWindow().getCurrencyAndUnitVisibility()}supportedChartTypes(){return this._innerAPI().supportedChartTypes()}watermark(){return this._innerAPI().watermark()}customSymbolStatus(){return this._innerWindow().customSymbolStatus()}setCSSCustomProperty(e,t){if(!1===e.startsWith("--"))throw new Error("customPropertyName should begin with a double hyphen");this._innerWindow().document.body.style.setProperty(e,t)}getCSSCustomPropertyValue(e){if(!1===e.startsWith("--"))throw new Error("customPropertyName should begin with a double hyphen");const t=this._innerWindow().document.body;return t.style.getPropertyValue(e)||getComputedStyle(t).getPropertyValue(e)}unloadUnusedCharts(){this._innerAPI().unloadUnusedCharts()}async customThemes(){return this._innerWindow().customThemes()}resetCache(){this._innerAPI().resetCache()}linking(){return this._innerAPI().linking}_innerAPI(){return this._innerWindow().tradingViewApi}_innerWindow(){return this._iFrame.contentWindow}_doWhenInnerWindowLoaded(e){this._ready?e(this._innerWindow()):this._innerWindowLoaded.then((()=>{e(this._innerWindow())}))}_doWhenInnerApiLoaded(e){this._doWhenInnerWindowLoaded((t=>{t.doWhenApiIsReady((()=>e(this._innerAPI())))}))}_autoResizeChart(){this._options.fullscreen&&(this._iFrame.style.height=window.innerHeight+"px",De&&setTimeout((()=>{this._iFrame.style.height=window.innerHeight+"px"}),30))}async _create(){const e=this._options.enabled_features?.includes("iframe_loading_same_origin")??!1,t=e||(this._options.enabled_features?.includes("iframe_loading_compatibility_mode")??!1),s=e&&(this._options.enabled_features?.includes("iframe_loading_root_path")??!1),[a,r]=this._render(!t,e,s),i=this._options.container,o="string"==typeof i?document.getElementById(i):i;if(null===o)throw new Error(`There is no such element - #${this._options.container}`);o.innerHTML=a,this._iFrame=o.querySelector(`#${this._id}`);const n=this._iFrame;e&&await this._innerWindowEvent("sameOriginLoad"),t&&(n.contentWindow?(n.contentWindow.document.open(),n.contentWindow.document.write(r),n.contentWindow.document.close()):console.warn("Unable to locate contentWindow for the created iframe. Please try disabling the `iframe_loading_compatibility_mode` featureset.")),this._innerWindow().addEventListener("innerWindowLoad",(e=>{e.detail.received=!0,function(e){if(void 0===e)throw new Error("_innerWindowResolver is undefined");return e}(this._innerWindowResolver)()}),{once:!0}),(this._options.autosize||this._options.fullscreen)&&(n.style.width="100%",this._options.fullscreen||(n.style.height="100%")),window.addEventListener("resize",this._onWindowResize),this._onWindowResize(),this._innerWindowLoaded.then((()=>{try{this._innerWindow().widgetReady((()=>{this._ready=!0;for(const e of this._readyHandlers)try{e.call(this)}catch(e){console.error(e)}this._innerWindow().initializationFinished()}))}catch(e){if(e instanceof Error&&/widgetReady is not a function/.test(e.message))throw new Error(`There was an error when loading the library. Usually this error means the library failed to load its static files. Check that the library files are available at ${window.location.host}/${this._options.library_path||""} or correct the library_path option.`)}}))}_innerWindowEvent(e){return new Promise((t=>{this._innerWindow().addEventListener(e,t,{once:!0})}))}_render(e,t,s){const a=window;if(a[this._id]={datafeed:this._options.datafeed,customFormatters:this._options.custom_formatters,brokerFactory:this._options.broker_factory,overrides:this._options.overrides,studiesOverrides:this._options.studies_overrides,tradingCustomization:this._options.trading_customization,disabledFeatures:this._options.disabled_features,enabledFeatures:this._options.enabled_features,brokerConfig:this._options.broker_config||this._options.brokerConfig,restConfig:this._options.restConfig,favorites:this._options.favorites,logo:this._options.logo,numeric_formatting:this._options.numeric_formatting,rss_news_feed:this._options.rss_news_feed,rss_news_title:this._options.rss_news_title,newsProvider:this._options.news_provider,loadLastChart:this._options.load_last_chart,saveLoadAdapter:this._options.save_load_adapter,loading_screen:this._options.loading_screen,settingsAdapter:this._options.settings_adapter,getCustomIndicators:this._options.custom_indicators_getter,additionalSymbolInfoFields:this._options.additional_symbol_info_fields,headerWidgetButtonsMode:this._options.header_widget_buttons_mode,customTranslateFunction:this._options.custom_translate_function,symbolSearchComplete:this._options.symbol_search_complete,contextMenu:this._options.context_menu,settingsOverrides:this._options.settings_overrides,timeframe:this._options.timeframe,customTimezones:this._options.custom_timezones,customChartDescriptionFunction:this._options.custom_chart_description_function,customThemes:this._options.custom_themes,imageStorageAdapter:this._options.image_storage_adapter},this._options.saved_data)a[this._id].chartContent={json:this._options.saved_data},this._options.saved_data_meta_info&&(a[this._id].chartContentExtendedData=this._options.saved_data_meta_info);else if(!this._options.load_last_chart&&!this._options.symbol)throw new Error("Symbol is not defined: either 'symbol' or 'load_last_chart' option must be set");if(this._options.library_path&&!this._options.library_path.endsWith("/")&&console.warn("library_path option should contain a trailing forward slash"),this._options.locale){const e=encodeURIComponent(this._options.locale);Be.findIndex((t=>t.language===e))>=0||(console.warn("locale isn't supported. Using default of `en`."),this._options.locale="en")}const r=function(e,t){const s=new URL(`${e||""}`,location.href).href,a=JSON.parse('["bundles/runtime.23405bb06c49e3d455da.js","bundles/__LANG__.2464.fc7f44a5c8b3791719aa.js","bundles/1996.25e6f30e7a095ec239f4.css","bundles/207.dd2de59fb0b299b4eed5.js","bundles/library.6ef314468a2a940f40f4.js"]'),r=encodeURIComponent(t),i=Be.find((e=>e.language===r))??{iso:"en",dir:"ltr"},o=`lang="${i.iso}" dir="${i.dir}"`,n=`\n${function(e,t,s){if(void 0===e)return"";const a=[],r=[];for(const i of e)i.endsWith(".js")?a.push(`<script defer crossorigin="anonymous" src="${i.replace("__LANG__",s)}"><\/script>`):i.endsWith(".css")&&r.push(`<link type="text/css" href="${t?i.replace(/\.css$/i,".rtl.css"):i}" rel="stylesheet"/>`);return[...a,...r].join("\n")}(a,"rtl"===i.dir,r)}\n`;return`<!DOCTYPE html><html ${(l={bundles:n,localeLanguage:r,htmlAttrs:o,libraryPath:s}).htmlAttrs}><head><base href="${l.libraryPath}"><meta charset="utf-8"><script>window===window.parent&&(location.href="about:blank")<\/script> ${l.bundles} </head><body class="chart-page unselectable on-widget"><div class="loading-indicator" id="loading-indicator"></div><script>var JSServer={},__initialEnabledFeaturesets=["charting_library"]<\/script><script>(function() {\n\t\twindow.urlParams = (function () {\n\t\t\tvar match,\n\t\t\t\tpl\t = /\\+/g,  // Regex for replacing addition symbol with a space\n\t\t\t\tsearch = /([^&=]+)=?([^&]*)/g,\n\t\t\t\tdecode = function (s) { return decodeURIComponent(s.replace(pl, ' ')).replace(/<\\/?[^>]+(>|$)/g, ''); },\n\t\t\t\tquery = function() {\n\t\t\t\t\t// We don't use hash on the url because: safari 13 throws an error if you attempt this\n\t\t\t\t\t// on a blob, and safari 14 will strip hash from blob urls.\n\t\t\t\t\tif (frameElement && frameElement.dataset.widgetOptions) {\n\t\t\t\t\t\treturn frameElement.dataset.widgetOptions;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow "Unexpected use of this page";\n\t\t\t\t\t}\n\t\t\t\t}(),\n\t\t\t\tresult = {};\n\n\t\t\twhile (match = search.exec(query)) {\n\t\t\t\tresult[decode(match[1])] = decode(match[2]);\n\t\t\t}\n\n\t\t\tvar additionalSettingsObject = window.parent[result.uid];\n\n\t\t\tvar customObjectNames = ['datafeed', 'customFormatters', 'brokerFactory', 'save_load_adapter', 'customTranslateFunction', 'contextMenu'];\n\n\t\t\tfor (var p in additionalSettingsObject) {\n\t\t\t\tif (customObjectNames.indexOf(p) === -1) {\n\t\t\t\t\tresult[p] = JSON.stringify(additionalSettingsObject[p]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t})();\n\n\t\twindow.locale = urlParams.locale;\n\t\twindow.language = urlParams.locale; // a very big attention needed here\n\t\twindow.customTranslateFunction = window.parent[urlParams.uid].customTranslateFunction;\n\t\twindow.customChartDescriptionFunction = window.parent[urlParams.uid].customChartDescriptionFunction;\n\n\t\twindow.addCustomCSSFile = function(href) {\n\t\t\tvar link = document.createElement('link');\n\t\t\tlink.setAttribute('type', 'text/css');\n\t\t\tlink.setAttribute('rel', 'stylesheet');\n\t\t\tlink.setAttribute('href', href);\n\t\t\tlink.setAttribute('cross-origin', 'anonymous');\n\n\t\t\twindow.loadedCustomCss = new Promise((resolve) => {\n\t\t\t\tlink.onload = resolve;\n\t\t\t\tlink.onerror = resolve;\n\t\t\t});\n\t\t\tdocument.body.appendChild(link);\n\t\t};\n\n\t\twindow.loadedCustomCss = Promise.resolve();\n\t\tif (!!urlParams.customCSS) {\n\t\t\twindow.addCustomCSSFile(urlParams.customCSS);\n\t\t}\n\n\t\tvar loadingScreenParams = {};\n\n\t\tif (typeof urlParams.loading_screen === 'string') {\n\t\t\ttry {\n\t\t\t\tloadingScreenParams = JSON.parse(urlParams.loading_screen);\n\t\t\t} catch(e) {}\n\t\t}\n\n\t\tvar loadingIndicatorElement = document.getElementById('loading-indicator');\n\n\t\tif (loadingScreenParams.backgroundColor) {\n\t\t\tloadingIndicatorElement.style = 'background-color: ' + loadingScreenParams.backgroundColor;\n\t\t}\n\n\t\t!function(){"use strict";var t,e=new WeakMap;!function(t){t[t.Element=1]="Element",t[t.Document=9]="Document"}(t||(t={}));var n={mini:"xsmall",xxsmall:"xxsmall",xsmall:"xsmall",small:"small",medium:"medium",large:"large"};var s,i,o,r,l=(void 0===r&&(r=""),s='<div class="tv-spinner '.concat(r,'" role="progressbar"></div>'),i=function(t){var n,s;return n=document.documentElement,e&&(s=e.get(n)),s||((s=n.ownerDocument.createRange()).selectNodeContents(n),e&&e.set(n,s)),s.createContextualFragment(t)}(s),null!==(o=i.firstElementChild)&&i.removeChild(o),o),a=function(){function t(t){this._shown=!1,this._el=l.cloneNode(!0),this.setSize(n[t||"large"])}return t.prototype.spin=function(t){return this._el.classList.add("tv-spinner--shown"),void 0===this._container&&(this._container=t,void 0!==t&&t.appendChild(this._el)),this._shown=!0,this},t.prototype.stop=function(t){return t&&void 0!==this._container&&this._container.removeChild(this._el),this._el&&this._el.classList.remove("tv-spinner--shown"),this._shown=!1,this},t.prototype.setStyle=function(t){var e=this;return Object.keys(t).forEach((function(n){var s=t[n];void 0!==s&&e._el.style.setProperty(n,s)})),this},t.prototype.style=function(){return this._el.style},t.prototype.setSize=function(t){var e=void 0!==t?"tv-spinner--size_".concat(t):"";return this._el.className="tv-spinner ".concat(e," ").concat(this._shown?"tv-spinner--shown":""),this},t.prototype.getEl=function(){return this._el},t.prototype.destroy=function(){this.stop(),delete this._el,delete this._container},t}();window.Spinner=a}();\n\n\n\t\tvar spinnerColor = (loadingScreenParams.foregroundColor) ? loadingScreenParams.foregroundColor : undefined;\n\n\t\tvar loadingSpinner = new Spinner('large').setStyle({\n\t\t\t'--tv-spinner-color': spinnerColor,\n\t\t\tzIndex: String(2e9),\n\t\t});\n\t\tloadingSpinner.getEl().classList.add('spinner');\n\t\tloadingSpinner.spin(loadingIndicatorElement);\n\t})();<\/script></body></html>`;var l}(this._options.library_path||"",this._options.locale);let i=new URL("about:blank");if(e){const e=new Blob([r],{type:"text/html"}),t=URL.createObjectURL(e);i=new URL(t)}else if(t){const e=this._options.library_path??"/",t=s?location.origin:location.href;i=new URL(e+"sameorigin.html",t)}const o="symbol="+encodeURIComponent(this._options.symbol||"")+"&interval="+encodeURIComponent(this._options.interval)+(this._options.toolbar_bg?"&toolbarbg="+encodeURIComponent(this._options.toolbar_bg.replace("#","")):"")+(this._options.studies_access?"&studiesAccess="+encodeURIComponent(JSON.stringify(this._options.studies_access)):"")+"&widgetbar="+encodeURIComponent(JSON.stringify(this._options.widgetbar))+(this._options.drawings_access?"&drawingsAccess="+encodeURIComponent(JSON.stringify(this._options.drawings_access)):"")+"&timeFrames="+encodeURIComponent(JSON.stringify(this._options.time_frames))+"&locale="+encodeURIComponent(this._options.locale)+"&uid="+encodeURIComponent(this._id)+"&clientId="+encodeURIComponent(String(this._options.client_id))+"&userId="+encodeURIComponent(String(this._options.user_id))+(this._options.charts_storage_url?"&chartsStorageUrl="+encodeURIComponent(this._options.charts_storage_url):"")+(this._options.charts_storage_api_version?"&chartsStorageVer="+encodeURIComponent(this._options.charts_storage_api_version):"")+(this._options.custom_css_url?"&customCSS="+encodeURIComponent(this._options.custom_css_url):"")+(this._options.custom_font_family?"&customFontFamily="+encodeURIComponent(this._options.custom_font_family):"")+(this._options.auto_save_delay?"&autoSaveDelay="+encodeURIComponent(String(this._options.auto_save_delay)):"")+"&debug="+encodeURIComponent(String(this._options.debug))+(this._options.debug_broker?"&debugBroker="+encodeURIComponent(String(this._options.debug_broker)):"")+(this._options.snapshot_url?"&snapshotUrl="+encodeURIComponent(this._options.snapshot_url):"")+(this._options.timezone?"&timezone="+encodeURIComponent(this._options.timezone):"")+(this._options.study_count_limit?"&studyCountLimit="+encodeURIComponent(String(this._options.study_count_limit)):"")+(this._options.symbol_search_request_delay?"&ssreqdelay="+encodeURIComponent(String(this._options.symbol_search_request_delay)):"")+(this._options.compare_symbols?"&compareSymbols="+encodeURIComponent(JSON.stringify(this._options.compare_symbols)):"")+(this._options.theme?"&theme="+encodeURIComponent(String(this._options.theme)):"")+(this._options.header_widget_buttons_mode?"&header_widget_buttons_mode="+encodeURIComponent(String(this._options.header_widget_buttons_mode)):"")+(this._options.time_scale?"&time_scale="+encodeURIComponent(JSON.stringify(this._options.time_scale)):"");return[`<iframe\n\t\tversion="CL v29.4.0 (internal id 29ac1aba6675f14818f3a5a9da75fa91c79107d0 @ 2025-06-25T14:02:27.771Z)" id="${this._id}" name="${this._id}" src="${i.href}" data-widget-options="${o}"\n\t\t${this._options.autosize||this._options.fullscreen?"":`width="${this._options.width}" height="${this._options.height}"`} title="Financial Chart" frameborder="0" allowTransparency="true" scrolling="no" allowfullscreen style="display:block;">\n\t</iframe>`,r]}};"undefined"!=typeof window&&(window.TradingView=window.TradingView||{},window.TradingView.version=Re);const De=!("undefined"==typeof window||!window.navigator||!window.navigator.userAgent)&&window.navigator.userAgent.includes("CriOS")}}]);